<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GitLab + GitLab CI + Harbor + Kubernetes</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/Vue/img/avatar.png">
    <meta name="description" content="æš‚ä¸”ä¸ºç©º">
    <meta name="keywords" content="å‰ç«¯åšå®¢,ä¸ªäººæŠ€æœ¯åšå®¢,å‰ç«¯,å‰ç«¯å¼€å‘,å‰ç«¯æ¡†æ¶,webå‰ç«¯,å‰ç«¯é¢è¯•é¢˜,æŠ€æœ¯æ–‡æ¡£,å­¦ä¹ ,é¢è¯•,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/Vue/assets/css/0.styles.0779c551.css" as="style"><link rel="preload" href="/Vue/assets/js/app.2f1a3b6e.js" as="script"><link rel="preload" href="/Vue/assets/js/2.3b495877.js" as="script"><link rel="preload" href="/Vue/assets/js/3.0279f92a.js" as="script"><link rel="preload" href="/Vue/assets/js/70.26a7c3b0.js" as="script"><link rel="preload" href="/Vue/assets/js/4.cb69b0f7.js" as="script"><link rel="prefetch" href="/Vue/assets/js/10.c275bb5d.js"><link rel="prefetch" href="/Vue/assets/js/100.3bb1b0e4.js"><link rel="prefetch" href="/Vue/assets/js/101.a01d59f4.js"><link rel="prefetch" href="/Vue/assets/js/102.f419e012.js"><link rel="prefetch" href="/Vue/assets/js/103.bd5f9634.js"><link rel="prefetch" href="/Vue/assets/js/104.ed16bff2.js"><link rel="prefetch" href="/Vue/assets/js/105.8d8a884a.js"><link rel="prefetch" href="/Vue/assets/js/106.aa743e85.js"><link rel="prefetch" href="/Vue/assets/js/107.cf714f94.js"><link rel="prefetch" href="/Vue/assets/js/108.e6ec757c.js"><link rel="prefetch" href="/Vue/assets/js/109.24cd0706.js"><link rel="prefetch" href="/Vue/assets/js/11.af7952aa.js"><link rel="prefetch" href="/Vue/assets/js/110.b601f694.js"><link rel="prefetch" href="/Vue/assets/js/111.bddaa63e.js"><link rel="prefetch" href="/Vue/assets/js/112.9737407e.js"><link rel="prefetch" href="/Vue/assets/js/113.182a72b9.js"><link rel="prefetch" href="/Vue/assets/js/114.88e3528a.js"><link rel="prefetch" href="/Vue/assets/js/115.e6fb1e07.js"><link rel="prefetch" href="/Vue/assets/js/116.05edf9a6.js"><link rel="prefetch" href="/Vue/assets/js/117.3488639c.js"><link rel="prefetch" href="/Vue/assets/js/118.cb030e7c.js"><link rel="prefetch" href="/Vue/assets/js/119.36ed2122.js"><link rel="prefetch" href="/Vue/assets/js/12.a3654490.js"><link rel="prefetch" href="/Vue/assets/js/120.78f37852.js"><link rel="prefetch" href="/Vue/assets/js/121.33f9f917.js"><link rel="prefetch" href="/Vue/assets/js/122.db28c031.js"><link rel="prefetch" href="/Vue/assets/js/123.fae41aaa.js"><link rel="prefetch" href="/Vue/assets/js/124.6014ee0f.js"><link rel="prefetch" href="/Vue/assets/js/125.048d7ee9.js"><link rel="prefetch" href="/Vue/assets/js/126.79671cb1.js"><link rel="prefetch" href="/Vue/assets/js/127.b607fed5.js"><link rel="prefetch" href="/Vue/assets/js/128.6a5a1980.js"><link rel="prefetch" href="/Vue/assets/js/129.6bc2af6c.js"><link rel="prefetch" href="/Vue/assets/js/13.91a93260.js"><link rel="prefetch" href="/Vue/assets/js/130.31dc0318.js"><link rel="prefetch" href="/Vue/assets/js/131.1f4ef5a2.js"><link rel="prefetch" href="/Vue/assets/js/132.aad55f7b.js"><link rel="prefetch" href="/Vue/assets/js/133.850511a4.js"><link rel="prefetch" href="/Vue/assets/js/134.0f6b070c.js"><link rel="prefetch" href="/Vue/assets/js/135.ee7fea35.js"><link rel="prefetch" href="/Vue/assets/js/136.a46039e3.js"><link rel="prefetch" href="/Vue/assets/js/137.1c7ebf24.js"><link rel="prefetch" href="/Vue/assets/js/138.6a80ffa9.js"><link rel="prefetch" href="/Vue/assets/js/139.f958f7b4.js"><link rel="prefetch" href="/Vue/assets/js/14.58c9ae82.js"><link rel="prefetch" href="/Vue/assets/js/140.d1e73936.js"><link rel="prefetch" href="/Vue/assets/js/141.a9897e5f.js"><link rel="prefetch" href="/Vue/assets/js/142.2b20335e.js"><link rel="prefetch" href="/Vue/assets/js/143.4e6e434c.js"><link rel="prefetch" href="/Vue/assets/js/144.5910990e.js"><link rel="prefetch" href="/Vue/assets/js/145.5c556359.js"><link rel="prefetch" href="/Vue/assets/js/146.86e27014.js"><link rel="prefetch" href="/Vue/assets/js/147.6c4a48cf.js"><link rel="prefetch" href="/Vue/assets/js/148.86e97474.js"><link rel="prefetch" href="/Vue/assets/js/149.c2f69712.js"><link rel="prefetch" href="/Vue/assets/js/15.2ff73105.js"><link rel="prefetch" href="/Vue/assets/js/150.33cf046e.js"><link rel="prefetch" href="/Vue/assets/js/151.5e66e299.js"><link rel="prefetch" href="/Vue/assets/js/152.e56f28bb.js"><link rel="prefetch" href="/Vue/assets/js/153.ad838120.js"><link rel="prefetch" href="/Vue/assets/js/154.9cabe557.js"><link rel="prefetch" href="/Vue/assets/js/155.7fc9c59f.js"><link rel="prefetch" href="/Vue/assets/js/156.99beb2dc.js"><link rel="prefetch" href="/Vue/assets/js/157.2f6f138c.js"><link rel="prefetch" href="/Vue/assets/js/158.c2ebfe13.js"><link rel="prefetch" href="/Vue/assets/js/159.ecad0f76.js"><link rel="prefetch" href="/Vue/assets/js/16.afec3afd.js"><link rel="prefetch" href="/Vue/assets/js/160.a0c44de2.js"><link rel="prefetch" href="/Vue/assets/js/161.a02953aa.js"><link rel="prefetch" href="/Vue/assets/js/162.da6c21cd.js"><link rel="prefetch" href="/Vue/assets/js/163.ccd82bba.js"><link rel="prefetch" href="/Vue/assets/js/164.a5b2d27c.js"><link rel="prefetch" href="/Vue/assets/js/165.6306c9da.js"><link rel="prefetch" href="/Vue/assets/js/166.d30a40d2.js"><link rel="prefetch" href="/Vue/assets/js/167.576fbdd9.js"><link rel="prefetch" href="/Vue/assets/js/168.5132f3f2.js"><link rel="prefetch" href="/Vue/assets/js/169.4f7b6bda.js"><link rel="prefetch" href="/Vue/assets/js/17.cb0083c7.js"><link rel="prefetch" href="/Vue/assets/js/170.73f50e6b.js"><link rel="prefetch" href="/Vue/assets/js/171.0691ff72.js"><link rel="prefetch" href="/Vue/assets/js/172.5b3bffba.js"><link rel="prefetch" href="/Vue/assets/js/173.a821c842.js"><link rel="prefetch" href="/Vue/assets/js/174.c7954299.js"><link rel="prefetch" href="/Vue/assets/js/175.431864a2.js"><link rel="prefetch" href="/Vue/assets/js/176.d22b5dfb.js"><link rel="prefetch" href="/Vue/assets/js/177.b278b962.js"><link rel="prefetch" href="/Vue/assets/js/178.07cf1514.js"><link rel="prefetch" href="/Vue/assets/js/179.c3273c2d.js"><link rel="prefetch" href="/Vue/assets/js/18.a09885e4.js"><link rel="prefetch" href="/Vue/assets/js/180.77ca26cf.js"><link rel="prefetch" href="/Vue/assets/js/181.788e42a1.js"><link rel="prefetch" href="/Vue/assets/js/182.8e7519e7.js"><link rel="prefetch" href="/Vue/assets/js/183.e54e78ae.js"><link rel="prefetch" href="/Vue/assets/js/184.22debe4b.js"><link rel="prefetch" href="/Vue/assets/js/185.e76ccf85.js"><link rel="prefetch" href="/Vue/assets/js/186.df4cb6e8.js"><link rel="prefetch" href="/Vue/assets/js/187.41fb453e.js"><link rel="prefetch" href="/Vue/assets/js/188.5bca0a92.js"><link rel="prefetch" href="/Vue/assets/js/189.3133bb55.js"><link rel="prefetch" href="/Vue/assets/js/19.13e3db6d.js"><link rel="prefetch" href="/Vue/assets/js/190.0b203720.js"><link rel="prefetch" href="/Vue/assets/js/191.ae34cdeb.js"><link rel="prefetch" href="/Vue/assets/js/192.c6b8de66.js"><link rel="prefetch" href="/Vue/assets/js/193.5350de54.js"><link rel="prefetch" href="/Vue/assets/js/194.9dc316f3.js"><link rel="prefetch" href="/Vue/assets/js/195.371cebb0.js"><link rel="prefetch" href="/Vue/assets/js/196.1164784c.js"><link rel="prefetch" href="/Vue/assets/js/197.824319f1.js"><link rel="prefetch" href="/Vue/assets/js/198.60a7beb3.js"><link rel="prefetch" href="/Vue/assets/js/199.5bcefde2.js"><link rel="prefetch" href="/Vue/assets/js/20.73bf2d20.js"><link rel="prefetch" href="/Vue/assets/js/200.b47e15ba.js"><link rel="prefetch" href="/Vue/assets/js/201.956ec86b.js"><link rel="prefetch" href="/Vue/assets/js/202.8a272715.js"><link rel="prefetch" href="/Vue/assets/js/203.0f429f03.js"><link rel="prefetch" href="/Vue/assets/js/204.278ee080.js"><link rel="prefetch" href="/Vue/assets/js/205.83c0fe12.js"><link rel="prefetch" href="/Vue/assets/js/206.ffdc349c.js"><link rel="prefetch" href="/Vue/assets/js/207.f165bca5.js"><link rel="prefetch" href="/Vue/assets/js/208.6991b2ef.js"><link rel="prefetch" href="/Vue/assets/js/209.c0418849.js"><link rel="prefetch" href="/Vue/assets/js/21.0a96b638.js"><link rel="prefetch" href="/Vue/assets/js/210.4257550c.js"><link rel="prefetch" href="/Vue/assets/js/211.097d1f31.js"><link rel="prefetch" href="/Vue/assets/js/212.ea96e672.js"><link rel="prefetch" href="/Vue/assets/js/213.2b921d6b.js"><link rel="prefetch" href="/Vue/assets/js/214.226476f0.js"><link rel="prefetch" href="/Vue/assets/js/215.3a320e63.js"><link rel="prefetch" href="/Vue/assets/js/216.1388e227.js"><link rel="prefetch" href="/Vue/assets/js/217.050bf527.js"><link rel="prefetch" href="/Vue/assets/js/218.95ee0100.js"><link rel="prefetch" href="/Vue/assets/js/219.acef3d57.js"><link rel="prefetch" href="/Vue/assets/js/22.97c5162c.js"><link rel="prefetch" href="/Vue/assets/js/220.1b2dda0a.js"><link rel="prefetch" href="/Vue/assets/js/221.4505e1c5.js"><link rel="prefetch" href="/Vue/assets/js/222.340ecf8b.js"><link rel="prefetch" href="/Vue/assets/js/223.2acba7c0.js"><link rel="prefetch" href="/Vue/assets/js/224.563b0345.js"><link rel="prefetch" href="/Vue/assets/js/225.f573a8b0.js"><link rel="prefetch" href="/Vue/assets/js/226.bd1a73fe.js"><link rel="prefetch" href="/Vue/assets/js/227.23a589e3.js"><link rel="prefetch" href="/Vue/assets/js/228.6f344c78.js"><link rel="prefetch" href="/Vue/assets/js/229.0c1a78af.js"><link rel="prefetch" href="/Vue/assets/js/23.e42d5b5a.js"><link rel="prefetch" href="/Vue/assets/js/230.e412a305.js"><link rel="prefetch" href="/Vue/assets/js/231.108982c3.js"><link rel="prefetch" href="/Vue/assets/js/232.07986abe.js"><link rel="prefetch" href="/Vue/assets/js/233.61b390cc.js"><link rel="prefetch" href="/Vue/assets/js/234.e1e030d7.js"><link rel="prefetch" href="/Vue/assets/js/235.be0057c0.js"><link rel="prefetch" href="/Vue/assets/js/236.e2722a7c.js"><link rel="prefetch" href="/Vue/assets/js/237.18291d84.js"><link rel="prefetch" href="/Vue/assets/js/238.ec2188b5.js"><link rel="prefetch" href="/Vue/assets/js/239.1629749f.js"><link rel="prefetch" href="/Vue/assets/js/24.7a7fd1e0.js"><link rel="prefetch" href="/Vue/assets/js/240.f1cf9e57.js"><link rel="prefetch" href="/Vue/assets/js/241.55e170d7.js"><link rel="prefetch" href="/Vue/assets/js/242.b7b6b401.js"><link rel="prefetch" href="/Vue/assets/js/243.bb7906d0.js"><link rel="prefetch" href="/Vue/assets/js/244.5ed9a466.js"><link rel="prefetch" href="/Vue/assets/js/245.464ebcaa.js"><link rel="prefetch" href="/Vue/assets/js/246.b49672d3.js"><link rel="prefetch" href="/Vue/assets/js/247.9a55ab30.js"><link rel="prefetch" href="/Vue/assets/js/248.815ea9fd.js"><link rel="prefetch" href="/Vue/assets/js/249.e8dfafa3.js"><link rel="prefetch" href="/Vue/assets/js/25.f17c8641.js"><link rel="prefetch" href="/Vue/assets/js/250.9762a60e.js"><link rel="prefetch" href="/Vue/assets/js/251.92a204a2.js"><link rel="prefetch" href="/Vue/assets/js/252.ec8bcce5.js"><link rel="prefetch" href="/Vue/assets/js/253.180604ac.js"><link rel="prefetch" href="/Vue/assets/js/254.73c69216.js"><link rel="prefetch" href="/Vue/assets/js/255.ee3e1d58.js"><link rel="prefetch" href="/Vue/assets/js/256.8f2376e7.js"><link rel="prefetch" href="/Vue/assets/js/257.6b40ed57.js"><link rel="prefetch" href="/Vue/assets/js/258.cbda5405.js"><link rel="prefetch" href="/Vue/assets/js/259.4afaab82.js"><link rel="prefetch" href="/Vue/assets/js/26.d01eec21.js"><link rel="prefetch" href="/Vue/assets/js/260.223291dd.js"><link rel="prefetch" href="/Vue/assets/js/261.66b7cee0.js"><link rel="prefetch" href="/Vue/assets/js/262.7646537d.js"><link rel="prefetch" href="/Vue/assets/js/263.2102a21b.js"><link rel="prefetch" href="/Vue/assets/js/264.01f69d37.js"><link rel="prefetch" href="/Vue/assets/js/265.3ac8cba8.js"><link rel="prefetch" href="/Vue/assets/js/266.a6a4a04d.js"><link rel="prefetch" href="/Vue/assets/js/267.be57cedf.js"><link rel="prefetch" href="/Vue/assets/js/268.27ea675e.js"><link rel="prefetch" href="/Vue/assets/js/269.8fa76d0c.js"><link rel="prefetch" href="/Vue/assets/js/27.82945f33.js"><link rel="prefetch" href="/Vue/assets/js/270.2c92fb60.js"><link rel="prefetch" href="/Vue/assets/js/271.905fd143.js"><link rel="prefetch" href="/Vue/assets/js/272.eebdf848.js"><link rel="prefetch" href="/Vue/assets/js/273.f02e16f4.js"><link rel="prefetch" href="/Vue/assets/js/274.1bb4b532.js"><link rel="prefetch" href="/Vue/assets/js/275.dd5ea9d3.js"><link rel="prefetch" href="/Vue/assets/js/276.74d6f8ab.js"><link rel="prefetch" href="/Vue/assets/js/277.b5b213b1.js"><link rel="prefetch" href="/Vue/assets/js/278.5e706d6b.js"><link rel="prefetch" href="/Vue/assets/js/279.1489f169.js"><link rel="prefetch" href="/Vue/assets/js/28.4c76df2a.js"><link rel="prefetch" href="/Vue/assets/js/280.19a374ee.js"><link rel="prefetch" href="/Vue/assets/js/281.d65b3987.js"><link rel="prefetch" href="/Vue/assets/js/282.5a6e3624.js"><link rel="prefetch" href="/Vue/assets/js/283.e7c54b99.js"><link rel="prefetch" href="/Vue/assets/js/284.5d480289.js"><link rel="prefetch" href="/Vue/assets/js/285.44c27c32.js"><link rel="prefetch" href="/Vue/assets/js/286.1b8d0289.js"><link rel="prefetch" href="/Vue/assets/js/287.96b027f9.js"><link rel="prefetch" href="/Vue/assets/js/288.130579e7.js"><link rel="prefetch" href="/Vue/assets/js/289.f4187c09.js"><link rel="prefetch" href="/Vue/assets/js/29.6e068a06.js"><link rel="prefetch" href="/Vue/assets/js/290.4c49c46b.js"><link rel="prefetch" href="/Vue/assets/js/291.193647db.js"><link rel="prefetch" href="/Vue/assets/js/292.7268e373.js"><link rel="prefetch" href="/Vue/assets/js/293.bcfefa9e.js"><link rel="prefetch" href="/Vue/assets/js/294.54f6a432.js"><link rel="prefetch" href="/Vue/assets/js/295.5020e3e7.js"><link rel="prefetch" href="/Vue/assets/js/296.d7f32e58.js"><link rel="prefetch" href="/Vue/assets/js/297.5dbbaabe.js"><link rel="prefetch" href="/Vue/assets/js/298.e6bf1a42.js"><link rel="prefetch" href="/Vue/assets/js/299.a18d8ba7.js"><link rel="prefetch" href="/Vue/assets/js/30.b168baee.js"><link rel="prefetch" href="/Vue/assets/js/300.ba217ef5.js"><link rel="prefetch" href="/Vue/assets/js/301.f96a76f5.js"><link rel="prefetch" href="/Vue/assets/js/302.37e0b19e.js"><link rel="prefetch" href="/Vue/assets/js/303.031b4c8e.js"><link rel="prefetch" href="/Vue/assets/js/304.d96cbd8b.js"><link rel="prefetch" href="/Vue/assets/js/305.0dcf6344.js"><link rel="prefetch" href="/Vue/assets/js/306.4f2540d0.js"><link rel="prefetch" href="/Vue/assets/js/31.dad269c9.js"><link rel="prefetch" href="/Vue/assets/js/32.63b50b54.js"><link rel="prefetch" href="/Vue/assets/js/33.04949d86.js"><link rel="prefetch" href="/Vue/assets/js/34.56a89946.js"><link rel="prefetch" href="/Vue/assets/js/35.3390f24b.js"><link rel="prefetch" href="/Vue/assets/js/36.14595b6f.js"><link rel="prefetch" href="/Vue/assets/js/37.8fcd4835.js"><link rel="prefetch" href="/Vue/assets/js/38.1825c8e2.js"><link rel="prefetch" href="/Vue/assets/js/39.b4ada2b6.js"><link rel="prefetch" href="/Vue/assets/js/40.c296d94a.js"><link rel="prefetch" href="/Vue/assets/js/41.283d95eb.js"><link rel="prefetch" href="/Vue/assets/js/42.0c1e2947.js"><link rel="prefetch" href="/Vue/assets/js/43.c6d0bcee.js"><link rel="prefetch" href="/Vue/assets/js/44.3287d646.js"><link rel="prefetch" href="/Vue/assets/js/45.1953ece5.js"><link rel="prefetch" href="/Vue/assets/js/46.a3b47dce.js"><link rel="prefetch" href="/Vue/assets/js/47.cf352360.js"><link rel="prefetch" href="/Vue/assets/js/48.d0f63d8e.js"><link rel="prefetch" href="/Vue/assets/js/49.4badb8d1.js"><link rel="prefetch" href="/Vue/assets/js/5.cacfa1e9.js"><link rel="prefetch" href="/Vue/assets/js/50.746e8eac.js"><link rel="prefetch" href="/Vue/assets/js/51.d56d5dbd.js"><link rel="prefetch" href="/Vue/assets/js/52.904cb343.js"><link rel="prefetch" href="/Vue/assets/js/53.e38427ab.js"><link rel="prefetch" href="/Vue/assets/js/54.b6de4473.js"><link rel="prefetch" href="/Vue/assets/js/55.f44277d0.js"><link rel="prefetch" href="/Vue/assets/js/56.9e836496.js"><link rel="prefetch" href="/Vue/assets/js/57.a7060cfa.js"><link rel="prefetch" href="/Vue/assets/js/58.5456c39a.js"><link rel="prefetch" href="/Vue/assets/js/59.3a2b2cea.js"><link rel="prefetch" href="/Vue/assets/js/6.f3d12b31.js"><link rel="prefetch" href="/Vue/assets/js/60.eb928d20.js"><link rel="prefetch" href="/Vue/assets/js/61.c1088d2f.js"><link rel="prefetch" href="/Vue/assets/js/62.218b1f1d.js"><link rel="prefetch" href="/Vue/assets/js/63.56adb0a3.js"><link rel="prefetch" href="/Vue/assets/js/64.842a8d1d.js"><link rel="prefetch" href="/Vue/assets/js/65.98d7a270.js"><link rel="prefetch" href="/Vue/assets/js/66.790ad0f2.js"><link rel="prefetch" href="/Vue/assets/js/67.f6effd5a.js"><link rel="prefetch" href="/Vue/assets/js/68.ca8c791c.js"><link rel="prefetch" href="/Vue/assets/js/69.da7fff1e.js"><link rel="prefetch" href="/Vue/assets/js/7.3e38d37d.js"><link rel="prefetch" href="/Vue/assets/js/71.1dd70f74.js"><link rel="prefetch" href="/Vue/assets/js/72.39679f64.js"><link rel="prefetch" href="/Vue/assets/js/73.40083b3a.js"><link rel="prefetch" href="/Vue/assets/js/74.b1ae5f8c.js"><link rel="prefetch" href="/Vue/assets/js/75.b45e9fa4.js"><link rel="prefetch" href="/Vue/assets/js/76.481e860c.js"><link rel="prefetch" href="/Vue/assets/js/77.526130d4.js"><link rel="prefetch" href="/Vue/assets/js/78.37c9e1a0.js"><link rel="prefetch" href="/Vue/assets/js/79.7d94e648.js"><link rel="prefetch" href="/Vue/assets/js/8.d3983478.js"><link rel="prefetch" href="/Vue/assets/js/80.785428df.js"><link rel="prefetch" href="/Vue/assets/js/81.107f320e.js"><link rel="prefetch" href="/Vue/assets/js/82.7520706d.js"><link rel="prefetch" href="/Vue/assets/js/83.e41657b3.js"><link rel="prefetch" href="/Vue/assets/js/84.140eb152.js"><link rel="prefetch" href="/Vue/assets/js/85.e8ca4166.js"><link rel="prefetch" href="/Vue/assets/js/86.cb2900cf.js"><link rel="prefetch" href="/Vue/assets/js/87.ff517a5f.js"><link rel="prefetch" href="/Vue/assets/js/88.adce3afb.js"><link rel="prefetch" href="/Vue/assets/js/89.bd97fe2f.js"><link rel="prefetch" href="/Vue/assets/js/9.06b0b5b8.js"><link rel="prefetch" href="/Vue/assets/js/90.19e9e85c.js"><link rel="prefetch" href="/Vue/assets/js/91.4331efbd.js"><link rel="prefetch" href="/Vue/assets/js/92.5001ecee.js"><link rel="prefetch" href="/Vue/assets/js/93.15ec5fef.js"><link rel="prefetch" href="/Vue/assets/js/94.f8c699ca.js"><link rel="prefetch" href="/Vue/assets/js/95.ff89b1f4.js"><link rel="prefetch" href="/Vue/assets/js/96.9b0780fa.js"><link rel="prefetch" href="/Vue/assets/js/97.e2092ef8.js"><link rel="prefetch" href="/Vue/assets/js/98.9e9ca302.js"><link rel="prefetch" href="/Vue/assets/js/99.badd2c8a.js">
    <link rel="stylesheet" href="/Vue/assets/css/0.styles.0779c551.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Vue/" class="home-link router-link-active"><img src="/Vue/img/logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Vue/" class="nav-link">ğŸ±é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ³å®¹å™¨" class="dropdown-title"><a href="/Vue/note/Kubernetes/" class="link-title">ğŸ³å®¹å™¨</a> <span class="title" style="display:none;">ğŸ³å®¹å™¨</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å®¹å™¨æ–‡ç« </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/pages/b23923/" class="nav-link">Containerd</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/note/Docker/" class="nav-link">ğŸ“’Dockerå®¹å™¨</a></li><li class="dropdown-subitem"><a href="/Vue/note/Containerd/" class="nav-link">ğŸ“’Containerdå®¹å™¨</a></li><li class="dropdown-subitem"><a href="/Vue/note/Kubernetes/" class="nav-link">ğŸ“’Kubernetes</a></li><li class="dropdown-subitem"><a href="/Vue/note/git/" class="nav-link">ğŸ“’Git</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ“’äº‘åŸç”Ÿ" class="dropdown-title"><a href="/Vue/devops/" class="link-title">ğŸ“’äº‘åŸç”Ÿ</a> <span class="title" style="display:none;">ğŸ“’äº‘åŸç”Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/CICD/" class="nav-link">Devops</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/Operator/" class="nav-link">Operator</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸŒæŠ€æœ¯" class="dropdown-title"><a href="/Vue/note/Traing/" class="link-title">ğŸŒæŠ€æœ¯</a> <span class="title" style="display:none;">ğŸŒæŠ€æœ¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/Traing/" class="nav-link">æŠ€èƒ½å¤§èµ›</a></li><li class="dropdown-item"><!----> <a href="/Vue/pages/4c778760be26d8b3/" class="nav-link">GitHubæŠ€å·§</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ–ï¸è€ƒè¯" class="dropdown-title"><a href="/Vue/note/kaozhen/" class="link-title">ğŸ–ï¸è€ƒè¯</a> <span class="title" style="display:none;">ğŸ–ï¸è€ƒè¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/kaozhen/" class="nav-link">1+Xäº‘è®¡ç®—é«˜çº§</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/kaozhen/" class="nav-link">CKA</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/Kubernetes/" class="nav-link">CKS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ‰æ›´å¤š" class="dropdown-title"><a href="/Vue/more/" class="link-title">ğŸ‰æ›´å¤š</a> <span class="title" style="display:none;">ğŸ‰æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/pages/f2a556/" class="nav-link">å­¦ä¹ </a></li><li class="dropdown-item"><!----> <a href="/Vue/pages/aea6571b7a8bae86/" class="nav-link">é¢è¯•</a></li></ul></div></div><div class="nav-item"><a href="/Vue/about/" class="nav-link">ğŸ”å…³äº</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ—¿æ”¶è—" class="dropdown-title"><a href="/Vue/pages/beb6c0bd8a66cea6/" class="link-title">ğŸ—¿æ”¶è—</a> <span class="title" style="display:none;">ğŸ—¿æ”¶è—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/pages/beb6c0bd8a66cea6/" class="nav-link">ç½‘ç«™</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/Vue/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/Vue/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/Vue/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/isicman/Vue" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/Vue/" class="nav-link">ğŸ±é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ³å®¹å™¨" class="dropdown-title"><a href="/Vue/note/Kubernetes/" class="link-title">ğŸ³å®¹å™¨</a> <span class="title" style="display:none;">ğŸ³å®¹å™¨</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å®¹å™¨æ–‡ç« </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/pages/b23923/" class="nav-link">Containerd</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/note/Docker/" class="nav-link">ğŸ“’Dockerå®¹å™¨</a></li><li class="dropdown-subitem"><a href="/Vue/note/Containerd/" class="nav-link">ğŸ“’Containerdå®¹å™¨</a></li><li class="dropdown-subitem"><a href="/Vue/note/Kubernetes/" class="nav-link">ğŸ“’Kubernetes</a></li><li class="dropdown-subitem"><a href="/Vue/note/git/" class="nav-link">ğŸ“’Git</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ“’äº‘åŸç”Ÿ" class="dropdown-title"><a href="/Vue/devops/" class="link-title">ğŸ“’äº‘åŸç”Ÿ</a> <span class="title" style="display:none;">ğŸ“’äº‘åŸç”Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/CICD/" class="nav-link">Devops</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/Operator/" class="nav-link">Operator</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸŒæŠ€æœ¯" class="dropdown-title"><a href="/Vue/note/Traing/" class="link-title">ğŸŒæŠ€æœ¯</a> <span class="title" style="display:none;">ğŸŒæŠ€æœ¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/Traing/" class="nav-link">æŠ€èƒ½å¤§èµ›</a></li><li class="dropdown-item"><!----> <a href="/Vue/pages/4c778760be26d8b3/" class="nav-link">GitHubæŠ€å·§</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ–ï¸è€ƒè¯" class="dropdown-title"><a href="/Vue/note/kaozhen/" class="link-title">ğŸ–ï¸è€ƒè¯</a> <span class="title" style="display:none;">ğŸ–ï¸è€ƒè¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/kaozhen/" class="nav-link">1+Xäº‘è®¡ç®—é«˜çº§</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/kaozhen/" class="nav-link">CKA</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/Kubernetes/" class="nav-link">CKS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ‰æ›´å¤š" class="dropdown-title"><a href="/Vue/more/" class="link-title">ğŸ‰æ›´å¤š</a> <span class="title" style="display:none;">ğŸ‰æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/pages/f2a556/" class="nav-link">å­¦ä¹ </a></li><li class="dropdown-item"><!----> <a href="/Vue/pages/aea6571b7a8bae86/" class="nav-link">é¢è¯•</a></li></ul></div></div><div class="nav-item"><a href="/Vue/about/" class="nav-link">ğŸ”å…³äº</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ—¿æ”¶è—" class="dropdown-title"><a href="/Vue/pages/beb6c0bd8a66cea6/" class="link-title">ğŸ—¿æ”¶è—</a> <span class="title" style="display:none;">ğŸ—¿æ”¶è—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/pages/beb6c0bd8a66cea6/" class="nav-link">ç½‘ç«™</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/Vue/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/Vue/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/Vue/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/isicman/Vue" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/Vue/pages/f6f110/" class="sidebar-link">Gitlab-CIä½¿ç”¨åŠ.gitlab-ci.ymlé…ç½®</a></li><li><a href="/Vue/pages/1ec44e/" class="sidebar-link">Gitlab-Runner + k8s å®ç°è‡ªåŠ¨éƒ¨ç½²</a></li><li><a href="/Vue/pages/77c267/" aria-current="page" class="active sidebar-link">GitLab + GitLab CI + Harbor + Kubernetes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/Vue/pages/77c267/#é¡¹ç›®è¦æ±‚" class="sidebar-link">é¡¹ç›®è¦æ±‚</a></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/77c267/#ç¯å¢ƒå‡†å¤‡" class="sidebar-link">ç¯å¢ƒå‡†å¤‡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_1-èŠ‚ç‚¹è§„åˆ’" class="sidebar-link">1.èŠ‚ç‚¹è§„åˆ’</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_2-æŸ¥çœ‹é›†ç¾¤çŠ¶æ€" class="sidebar-link">2.æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/77c267/#éƒ¨ç½²gitlab" class="sidebar-link">éƒ¨ç½²GitLab</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_1-gitlabæ¦‚è¿°" class="sidebar-link">1.GitLabæ¦‚è¿°</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_2-gitlabéƒ¨ç½²æ–¹å¼" class="sidebar-link">2.GitLabéƒ¨ç½²æ–¹å¼</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_3-dockeréƒ¨ç½²gitlab" class="sidebar-link">3.Dockeréƒ¨ç½²GitLab</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_4-åˆ›å»ºé¡¹ç›®" class="sidebar-link">4.åˆ›å»ºé¡¹ç›®</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/77c267/#éƒ¨ç½²gitlab-runner" class="sidebar-link">éƒ¨ç½²GitLab-Runner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_1-gitlab-ciä»‹ç»" class="sidebar-link">1.GitLab-CIä»‹ç»</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_2-gitlab-runneréƒ¨ç½²æ–¹å¼" class="sidebar-link">2.GitLab-Runneréƒ¨ç½²æ–¹å¼</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_3-dockeréƒ¨ç½²runner" class="sidebar-link">3.Dockeréƒ¨ç½²Runner</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_4-helméƒ¨ç½²runner" class="sidebar-link">4.Helméƒ¨ç½²Runner</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/77c267/#éƒ¨ç½²harbor" class="sidebar-link">éƒ¨ç½²Harbor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_1-harborä»‹ç»" class="sidebar-link">1.Harborä»‹ç»</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_2-harboréƒ¨ç½²" class="sidebar-link">2.Harboréƒ¨ç½²</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_3-æ·»åŠ é•œåƒä»“åº“" class="sidebar-link">3.æ·»åŠ é•œåƒä»“åº“</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/77c267/#é…ç½®cicd" class="sidebar-link">é…ç½®CICD</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_1-é…ç½®-gitlab-ci-yml" class="sidebar-link">1.é…ç½®.gitlab-ci.yml</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_2-å¼€å§‹æ„å»º" class="sidebar-link">2.å¼€å§‹æ„å»º</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_3-æŸ¥çœ‹gitlab-ci" class="sidebar-link">3.æŸ¥çœ‹Gitlab-CI</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/77c267/#_4-è®¿é—®é¡¹ç›®" class="sidebar-link">4.è®¿é—®é¡¹ç›®</a></li></ul></li></ul></li><li><a href="/Vue/pages/7799fb/" class="sidebar-link">Gitea+K8s-Jenkins-master-slave(webhooké’©å­)</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-5add8e0a><div class="articleInfo" data-v-5add8e0a><ul class="breadcrumbs" data-v-5add8e0a><li data-v-5add8e0a><a href="/Vue/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-5add8e0a></a></li> <li data-v-5add8e0a><a href="/Vue/note/CICD/#ã€ŠCICDã€‹å­¦ä¹ ç¬”è®°" data-v-5add8e0a>ã€ŠCICDã€‹å­¦ä¹ ç¬”è®°</a></li></ul> <div class="info" data-v-5add8e0a><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-5add8e0a><a href="https://github.com/2756864799zhang" target="_blank" title="ä½œè€…" class="beLink" data-v-5add8e0a>Vuens</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-5add8e0a><a href="javascript:;" data-v-5add8e0a>2022-04-27</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">GitLab + GitLab CI + Harbor + Kubernetes<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="gitlab-gitlab-ci-harbor-kubernetes"><a href="#gitlab-gitlab-ci-harbor-kubernetes" class="header-anchor">#</a> GitLab + GitLab CI + Harbor + Kubernetes</h1> <h2 id="é¡¹ç›®è¦æ±‚"><a href="#é¡¹ç›®è¦æ±‚" class="header-anchor">#</a> é¡¹ç›®è¦æ±‚</h2> <p>è¯¥å…¬å¸å†³å®šé‡‡ç”¨<code>GitLab + GitLab CI + Harbor + Kubernetes</code>æ¶æ„æ¥æ„å»ºCICDç¯å¢ƒï¼Œä»¥ç¼©çŸ­æ–°åŠŸèƒ½å¼€å‘ä¸Šçº¿å‘¨æœŸï¼ŒåŠæ—¶æ»¡è¶³å®¢æˆ·çš„éœ€æ±‚ï¼Œå®ç°DevOpsçš„éƒ¨åˆ†æµç¨‹ï¼Œæ¥å‡è½»éƒ¨ç½²è¿ç»´çš„è´Ÿæ‹…ï¼Œå®ç°å¯è§†åŒ–å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€åº”ç”¨å‘å¸ƒå’Œç‰ˆæœ¬è¿­ä»£æ›´æ–°ï¼Œè¯·å®ŒæˆCICDç¯å¢ƒéƒ¨ç½²ã€‚CICDåº”ç”¨ç³»ç»Ÿæ¶æ„å¦‚ä¸‹ï¼š</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250851345.png" alt="image-20220425085103011"></p> <h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="header-anchor">#</a> ç¯å¢ƒå‡†å¤‡</h2> <p>è¿™é‡Œä½¿ç”¨é¡¹ç›®ä¸º2048æ¸¸æˆ</p> <p><strong>é¡¹ç›®åœ°å€ï¼š</strong>  https://gitee.com/isicman/demo-2048.git</p> <h3 id="_1-èŠ‚ç‚¹è§„åˆ’"><a href="#_1-èŠ‚ç‚¹è§„åˆ’" class="header-anchor">#</a> 1.èŠ‚ç‚¹è§„åˆ’</h3> <p>ä½¿ç”¨Dockeræˆ–è€…ä½¿ç”¨Kubernetesé›†ç¾¤ç¯å¢ƒï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯Kubernetesé›†ç¾¤ç¯å¢ƒã€‚</p> <table><thead><tr><th>IPåœ°å€</th> <th>ä¸»æœºåç§°</th> <th>ä¸»æœºèµ„æº</th> <th>èŠ‚ç‚¹åç§°</th></tr></thead> <tbody><tr><td>10.11.121.111</td> <td>k8s-master</td> <td>12G/6VCPU</td> <td>GitLab+GitLab-Runner</td></tr> <tr><td>10.11.121.112</td> <td>k8s-node1</td> <td>8G/6VCPU</td> <td>Harbor</td></tr> <tr><td>10.11.121.113</td> <td>k8s-node2</td> <td>8G/6VCPU</td> <td>node</td></tr></tbody></table> <h3 id="_2-æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"><a href="#_2-æŸ¥çœ‹é›†ç¾¤çŠ¶æ€" class="header-anchor">#</a> 2.æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</h3> <p>å¯ä»¥é€šè¿‡<code>kubectl cluster-info</code>å‘½ä»¤æŸ¥çœ‹å½“å‰çš„é›†ç¾¤ä¿¡æ¯ã€‚ é€šè¿‡ <code>kubectl get node</code>æŸ¥çœ‹å½“å‰èŠ‚ç‚¹æ•°é‡ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># kubectl cluster-info </span>
Kubernetes control plane is running at https://10.11.121.111:6443
KubeDNS is running at https://10.11.121.111:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use <span class="token string">'kubectl cluster-info dump'</span><span class="token builtin class-name">.</span>

<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get node </span>
NAME         STATUS   ROLES                  AGE   VERSION
k8s-master   Ready    control-plane,master   25h   v1.20.0
k8s-node1    Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>                 25h   v1.20.0
k8s-node2    Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>                 25h   v1.20.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="éƒ¨ç½²gitlab"><a href="#éƒ¨ç½²gitlab" class="header-anchor">#</a> éƒ¨ç½²GitLab</h2> <h3 id="_1-gitlabæ¦‚è¿°"><a href="#_1-gitlabæ¦‚è¿°" class="header-anchor">#</a> 1.GitLabæ¦‚è¿°</h3> <p>GitLab æ˜¯åˆ©ç”¨ Ruby on Rails ä¸€ä¸ªå¼€æºçš„ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿï¼Œå®ç°ä¸€ä¸ªè‡ªæ‰˜ç®¡çš„ Git é¡¹ç›®ä»“åº“ï¼Œå¯é€šè¿‡ Web ç•Œé¢è¿›è¡Œè®¿é—®å…¬å¼€çš„æˆ–è€…ç§äººé¡¹ç›®ã€‚å®ƒæ‹¥æœ‰ä¸ Github ç±»ä¼¼çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿæµè§ˆæºä»£ç ï¼Œç®¡ç†ç¼ºé™·å’Œæ³¨é‡Šã€‚å¯ä»¥ç®¡ç†å›¢é˜Ÿå¯¹ä»“åº“çš„è®¿é—®ï¼Œå®ƒéå¸¸æ˜“äºæµè§ˆæäº¤è¿‡çš„ç‰ˆæœ¬å¹¶æä¾›ä¸€ä¸ªæ–‡ä»¶å†å²åº“ã€‚å›¢é˜Ÿæˆå‘˜å¯ä»¥åˆ©ç”¨å†…ç½®çš„ç®€å•èŠå¤©ç¨‹åº (Wall) è¿›è¡Œäº¤æµã€‚å®ƒè¿˜æä¾›ä¸€ä¸ªä»£ç ç‰‡æ®µæ”¶é›†åŠŸèƒ½å¯ä»¥è½»æ¾å®ç°ä»£ç å¤ç”¨ï¼Œä¾¿äºæ—¥åæœ‰éœ€è¦çš„æ—¶å€™è¿›è¡ŒæŸ¥æ‰¾ã€‚</p> <h3 id="_2-gitlabéƒ¨ç½²æ–¹å¼"><a href="#_2-gitlabéƒ¨ç½²æ–¹å¼" class="header-anchor">#</a> 2.GitLabéƒ¨ç½²æ–¹å¼</h3> <p>GitLab å¯ä»¥å®‰è£…åœ¨å¤§å¤šæ•° GNU/Linux å‘è¡Œç‰ˆä¸­ï¼Œå¹¶ä¸å¤šä¸ªäº‘æä¾›å•†ä¸€èµ·å®‰è£…ã€‚è¦ä» GitLab è·å¾—æœ€ä½³ä½“éªŒï¼Œæ‚¨å¿…é¡»å¹³è¡¡æ€§èƒ½ã€å¯é æ€§ã€æ˜“äºç®¡ç†ï¼ˆå¤‡ä»½ã€å‡çº§å’Œæ•…éšœæ’é™¤ï¼‰ä»¥åŠæ‰˜ç®¡æˆæœ¬ã€‚</p> <p>ç›®å‰æ¯”è¾ƒå¸¸è§çš„éƒ¨ç½²æ–¹å¼æœ‰å¦‚ä¸‹ä¸‰ç§ï¼š</p> <ul><li>ç›´æ¥å®‰è£…åœ¨æ“ä½œç³»ç»Ÿä¸Šï¼Œä¾‹å¦‚ï¼š <code>Mac/Windows/Linux</code></li> <li>é€šè¿‡å®¹å™¨çš„æ–¹å¼å®‰è£…ï¼Œä¾‹å¦‚ï¼š <code>Dockerã€Kubernetes</code></li> <li>ä½¿ç”¨HelmåŒ…å®‰è£…ï¼š <code>ChartåŒ…çš„æ–¹å¼</code></li></ul> <h3 id="_3-dockeréƒ¨ç½²gitlab"><a href="#_3-dockeréƒ¨ç½²gitlab" class="header-anchor">#</a> 3.Dockeréƒ¨ç½²GitLab</h3> <p>1.ä½¿ç”¨Dockerå‘½ä»¤éƒ¨ç½²Gitlabï¼Œç”±äºGitlabçš„é•œåƒå¤§æ¦‚æœ‰å‡ ä¸ªGï¼Œæ‰€ä»¥éœ€è¦ç­‰å¾…å¾ˆä¹…çš„æ—¶é—´ï¼Œç›´åˆ°å®Œå…¨å¯åŠ¨ã€‚</p> <p>å‚æ•°è§£æï¼š</p> <p><code>hostname</code>  			  åŸŸå æˆ– ip</p> <p><code>publish ã€-p</code> 		ç«¯å£æ˜ å°„</p> <p><code>restart</code> 				é‡å¯æ–¹å¼</p> <p><code>volumeã€-v</code> 		   ç›®å½•æŒ‚è½½</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># docker run -d \</span>
  --hostname <span class="token number">10.11</span>.121.111 <span class="token punctuation">\</span>
  -p <span class="token number">443</span>:443 -p <span class="token number">80</span>:80 -p <span class="token number">222</span>:22 <span class="token punctuation">\</span>
  --name gitlab <span class="token punctuation">\</span>
  --restart always <span class="token punctuation">\</span>
  -v /srv/gitlab/config:/etc/gitlab <span class="token punctuation">\</span>
  -v /srv/gitlab/logs:/var/log/gitlab <span class="token punctuation">\</span>
  -v /srv/gitlab/data:/var/opt/gitlab <span class="token punctuation">\</span>
  gitlab/gitlab-ce:latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>2.æŸ¥çœ‹å½“å‰çš„Dockerè¿›ç¨‹ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># docker ps | grep  gitlab </span>
686f123b649c   gitlab/gitlab-ce:latest                             <span class="token string">&quot;/assets/wrapper&quot;</span>        <span class="token number">25</span> hours ago   Up <span class="token number">2</span> hours <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   <span class="token number">0.0</span>.0.0:80-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp, :::80-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp, <span class="token number">0.0</span>.0.0:443-<span class="token operator">&gt;</span><span class="token number">443</span>/tcp, :::443-<span class="token operator">&gt;</span><span class="token number">443</span>/tcp, <span class="token number">0.0</span>.0.0:222-<span class="token operator">&gt;</span><span class="token number">22</span>/tcp, :::222-<span class="token operator">&gt;</span><span class="token number">22</span>/tcp   gitlab
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>3.é€šè¿‡æµè§ˆå™¨è®¿é—®GitLabçš„é¡µé¢ï¼š http://10.11.121.111</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204242235534.png" alt="image-20220424223532525"></p> <p>4.è¿™é‡Œé»˜è®¤çš„ç”¨æˆ·æ˜¯ <code>root</code> ï¼Œé»˜è®¤çš„å¯†ç åªæœ‰24hæœ‰æ•ˆï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸€ä¸‹å¯†ç ã€‚</p> <p>å…ˆæŸ¥å‡ºç”¨æˆ·çš„idï¼Œä¾‹å¦‚ä¸‹é¢ç”¨æˆ·æ˜¯root id=1</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it gitlab /bin/bash</span>
<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span>:1,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Administrator&quot;</span>,<span class="token string">&quot;username&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;root&quot;</span>,<span class="token string">&quot;state&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;active&quot;</span>,<span class="token string">&quot;avatar_url&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;https://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=80<span class="token entity" title="\u0026">\u0026</span>d=identicon&quot;</span>,<span class="token string">&quot;web_url&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;http://192.168.0.173/root&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>

root@10:/<span class="token comment"># gitlab-rails console -e production</span>
--------------------------------------------------------------------------------
 Ruby:         ruby <span class="token number">2.7</span>.4p191 <span class="token punctuation">(</span><span class="token number">2021</span>-07-07 revision a21a3b7d23<span class="token punctuation">)</span> <span class="token punctuation">[</span>x86_64-linux<span class="token punctuation">]</span>
 GitLab:       <span class="token number">14.4</span>.1 <span class="token punctuation">(</span>1a23d731c9f<span class="token punctuation">)</span> FOSS
 GitLab Shell: <span class="token number">13.21</span>.1
 PostgreSQL:   <span class="token number">12.7</span>
--------------------------------------------------------------------------------
Loading production environment <span class="token punctuation">(</span>Rails <span class="token number">6.1</span>.4.1<span class="token punctuation">)</span>
irb<span class="token punctuation">(</span>main<span class="token punctuation">)</span>:001:<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token assign-left variable">u</span><span class="token operator">=</span>User.where<span class="token punctuation">(</span>id:1<span class="token punctuation">)</span>.first
<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">#&lt;User id:1 @root&gt;</span>
irb<span class="token punctuation">(</span>main<span class="token punctuation">)</span>:002:<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> u.password<span class="token operator">=</span><span class="token string">'00000000'</span>
<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&quot;00000000&quot;</span>
irb<span class="token punctuation">(</span>main<span class="token punctuation">)</span>:003:<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> u.password_confirmation<span class="token operator">=</span><span class="token string">'00000000'</span>
<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&quot;00000000&quot;</span>
irb<span class="token punctuation">(</span>main<span class="token punctuation">)</span>:004:<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> u.save<span class="token operator">!</span>
Enqueued ActionMailer::MailDeliveryJob <span class="token punctuation">(</span>Job ID: d7bc1e90-4941-4125-bf90-b018c92b5d73<span class="token punctuation">)</span> to Sidekiq<span class="token punctuation">(</span>mailers<span class="token punctuation">)</span> with arguments: <span class="token string">&quot;DeviseMailer&quot;</span>, <span class="token string">&quot;password_change&quot;</span>, <span class="token string">&quot;deliver_now&quot;</span>, <span class="token punctuation">{</span>:args<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token comment">#&lt;GlobalID:0x00007f0b99fbc3a8 @uri=#&lt;URI::GID gid://gitlab/User/1&gt;&gt;]}</span>
<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span>
irb<span class="token punctuation">(</span>main<span class="token punctuation">)</span>:005:<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token builtin class-name">exit</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_4-åˆ›å»ºé¡¹ç›®"><a href="#_4-åˆ›å»ºé¡¹ç›®" class="header-anchor">#</a> 4.åˆ›å»ºé¡¹ç›®</h3> <p>2.ç™»å½•Gitlabä¹‹åï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªé¡¹ç›®åç§°å«åš<code>demo</code>ã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204242237733.png" alt="image-20220424223745243"></p> <p>2.é€‰æ‹©<code>public</code>ï¼Œä¹Ÿæ˜¯ä¸Šå¸‚çš„æ„æ€ï¼Œä¸éœ€è¦åˆå§‹åŒ–å­˜å‚¨åº“ã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204242240317.png" alt="image-20220424224043845"></p> <p>3.é¦–å…ˆæˆ‘ä»¬æ‹‰å–giteeä¸Šçš„æºç åˆ°æœ¬åœ°ï¼Œå†æ¨é€åˆ°Gitlabæºç æ‰˜ç®¡demoä»“åº“çš„Masteråˆ†æ”¯ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># git clone https://gitee.com/isicman/demo-2048.git </span>
Cloning into <span class="token string">'demo-2048'</span><span class="token punctuation">..</span>.
Username <span class="token keyword">for</span> <span class="token string">'https://gitee.com'</span><span class="token builtin class-name">:</span> isicman
Password <span class="token keyword">for</span> <span class="token string">'https://isicman@gitee.com'</span><span class="token builtin class-name">:</span> 
remote: Enumerating objects: <span class="token number">71</span>, done.
remote: Counting objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">71</span>/71<span class="token punctuation">)</span>, done.
remote: Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">59</span>/59<span class="token punctuation">)</span>, done.
remote: Total <span class="token number">71</span> <span class="token punctuation">(</span>delta <span class="token number">21</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>, pack-reused <span class="token number">0</span>
Unpacking objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">71</span>/71<span class="token punctuation">)</span>, done.
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># cd demo-2048/</span>
<span class="token punctuation">[</span>root@k8s-master demo<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">8</span>
drwxr-xr-x <span class="token number">2</span> root root   <span class="token number">24</span> Apr <span class="token number">23</span> <span class="token number">13</span>:28 Dockerfiles
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1491</span> Apr <span class="token number">23</span> <span class="token number">13</span>:28 pom.xml
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">315</span> Apr <span class="token number">23</span> <span class="token number">13</span>:28 README.md
drwxr-xr-x <span class="token number">3</span> root root   <span class="token number">18</span> Apr <span class="token number">23</span> <span class="token number">13</span>:28 src
drwxr-xr-x <span class="token number">2</span> root root   <span class="token number">28</span> Apr <span class="token number">24</span> <span class="token number">13</span>:06 template

<span class="token punctuation">[</span>root@k8s-master demo-2048<span class="token punctuation">]</span><span class="token comment"># git config --global user.name &quot;Administrator&quot;</span>
<span class="token punctuation">[</span>root@k8s-master demo-2048<span class="token punctuation">]</span><span class="token comment"># git config --global user.email &quot;admin@example.com&quot;</span>
<span class="token punctuation">[</span>root@k8s-master demo-2048<span class="token punctuation">]</span><span class="token comment"># git init</span>
Reinitialized existing Git repository <span class="token keyword">in</span> /opt/demo-2048/.git/
<span class="token punctuation">[</span>root@k8s-master demo-2048<span class="token punctuation">]</span><span class="token comment"># git remote rename origin old-origin</span>
<span class="token punctuation">[</span>root@k8s-master demo-2048<span class="token punctuation">]</span><span class="token comment"># git remote add origin http://10.11.121.111/root/demo.git</span>
<span class="token punctuation">[</span>root@k8s-master demo-2048<span class="token punctuation">]</span><span class="token comment"># git add .</span>
<span class="token punctuation">[</span>root@k8s-master demo-2048<span class="token punctuation">]</span><span class="token comment"># git commit -m &quot;Initial commit&quot;</span>
<span class="token comment"># On branch master</span>
nothing to commit, working directory clean
<span class="token punctuation">[</span>root@k8s-master demo-2048<span class="token punctuation">]</span><span class="token comment"># git push -u origin --all</span>
Username <span class="token keyword">for</span> <span class="token string">'http://10.11.121.111'</span><span class="token builtin class-name">:</span> root
Password <span class="token keyword">for</span> <span class="token string">'http://root@10.11.121.111'</span><span class="token builtin class-name">:</span> 
Counting objects: <span class="token number">71</span>, done.
Delta compression using up to <span class="token number">8</span> threads.
Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">59</span>/59<span class="token punctuation">)</span>, done.
Writing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">71</span>/71<span class="token punctuation">)</span>, <span class="token number">82.04</span> KiB <span class="token operator">|</span> <span class="token number">0</span> bytes/s, done.
Total <span class="token number">71</span> <span class="token punctuation">(</span>delta <span class="token number">21</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
To http://10.11.121.111/root/demo2.git
 * <span class="token punctuation">[</span>new branch<span class="token punctuation">]</span>      master -<span class="token operator">&gt;</span> master
Branch master <span class="token builtin class-name">set</span> up to track remote branch master from origin.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>4.å†æ¬¡åˆ·æ–°ä»“åº“æŸ¥çœ‹ï¼Œæºç å·²ç»æ¨é€æˆåŠŸã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204242249037.png" alt="image-20220424224925906"></p> <p>5.éœ€è¦è®°ä½è¿™é‡Œçš„Runnerçš„<code>URLå’ŒToken</code>ï¼Œå› ä¸ºåé¢çš„GitLabâ€”Runnerè¿æ¥GitLabéœ€è¦ä½¿ç”¨åˆ°ã€‚</p> <p>æ­¤å¤„æˆ‘çš„URL: <code>http://10.11.121.111/</code></p> <p>æ­¤å¤„æˆ‘çš„Tokenï¼š<code>o4_NCTZvpnViRE7iGxoi</code></p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250847343.png" alt="image-20220424225358742"></p> <h2 id="éƒ¨ç½²gitlab-runner"><a href="#éƒ¨ç½²gitlab-runner" class="header-anchor">#</a> éƒ¨ç½²GitLab-Runner</h2> <h3 id="_1-gitlab-ciä»‹ç»"><a href="#_1-gitlab-ciä»‹ç»" class="header-anchor">#</a> 1.GitLab-CIä»‹ç»</h3> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250847312.webp" alt="img"></p> <p>GitLab Runneræ˜¯ä¸€ä¸ª<a href="https://so.csdn.net/so/search?q=%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">å¼€æºé¡¹ç›®<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œç”¨äºè¿è¡Œæ‚¨çš„ä½œä¸šå¹¶å°†ç»“æœå‘é€å›GitLabã€‚å®ƒä¸GitLab CIä¸€èµ·ä½¿ç”¨ï¼ŒGitLab CIæ˜¯GitLabéšé™„çš„å¼€æºæŒç»­é›†æˆæœåŠ¡ï¼Œç”¨äºåè°ƒä½œä¸šã€‚</p> <p>ä¸€èˆ¬æ¥è¯´ï¼Œgitlabä¸Šå·²ç”±è´Ÿè´£äººé…ç½®å¥½äº†<code>gitlab-runner</code>ï¼Œæˆ‘ä»¬åªéœ€è¦ç¼–å†™å¥½<code>.gitlab.yml</code>æ–‡ä»¶æäº¤ä»£ç å³å¯è§¦å‘runnerè¿›è¡Œå·¥ä½œã€‚ä½†å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œä½ å¯èƒ½æƒ³èƒ½ä¸èƒ½åœ¨æäº¤ä»£ç å‰åœ¨æœ¬åœ°å…ˆæ‰§è¡Œ<code>.gitlab.yml</code>æ–‡ä»¶çš„jobï¼Œæœ¬åœ°è°ƒè¯•æˆåŠŸæ£€æŸ¥æ²¡æœ‰é—®é¢˜åå†è¿›è¡Œæœ€ç»ˆä»£ç çš„æäº¤ï¼Œè§¦å‘æœåŠ¡ç«¯çš„CIæµç¨‹ã€‚ç­”æ¡ˆå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚<code>.gitlab.yml</code>æ–‡ä»¶ä¸­å®šä¹‰çš„jobå…¶å®æ˜¯æŸä¸ªæœåŠ¡å™¨ä¸­çš„<code>gitlab-runner</code>åœ¨è¿è¡Œï¼Œé‚£æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°å®‰è£…å¥½<code>gitlab-runner</code>æ‰‹åŠ¨çš„æ¥æ‰§è¡Œæœ¬åœ°<code>.gitlab.yml</code>ä¸­çš„<code>job</code>ã€‚</p> <h3 id="_2-gitlab-runneréƒ¨ç½²æ–¹å¼"><a href="#_2-gitlab-runneréƒ¨ç½²æ–¹å¼" class="header-anchor">#</a> 2.GitLab-Runneréƒ¨ç½²æ–¹å¼</h3> <p>ä½ å‡ ä¹å¯ä»¥åœ¨ä»»ä½•æœºå™¨ä¸Šå®‰è£…<code>gitlab-runner</code>ï¼Œå®‰è£…çš„æ–¹å¼è¿™é‡Œæ¨èå¦‚ä¸‹å‡ ç§ï¼š</p> <ul><li>Linuxä½¿ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼</li> <li>Dockerä¸­ä½¿ç”¨å®¹å™¨çš„æ–¹å¼å¯åŠ¨Gitlabâ€”Runner</li> <li>HelmåŒ…çš„æ–¹å¼å®‰è£…Gitlab-Runner</li></ul> <p><code>å¦‚ä¸‹æˆ‘åˆ†åˆ«ä½¿ç”¨äº†ä¸¤ç§ä¸åŒçš„æ–¹å¼éƒ¨ç½²Gitlab-Runnerï¼Œå¯ä»¥é€‰æ‹©å…¶ä¸­ä¸€ç§ã€‚</code></p> <h3 id="_3-dockeréƒ¨ç½²runner"><a href="#_3-dockeréƒ¨ç½²runner" class="header-anchor">#</a> 3.Dockeréƒ¨ç½²Runner</h3> <p><strong>1.å®‰è£…gitlab runner</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 ~<span class="token punctuation">]</span><span class="token comment"># docker run -d --name gitlab-runner --restart always \</span>
  -v /srv/gitlab-runner/config:/etc/gitlab-runner <span class="token punctuation">\</span>
  -v /var/run/docker.sock:/var/run/docker.sock <span class="token punctuation">\</span>
  gitlab/gitlab-runner:latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>2.æ³¨å†Œgitlab runner</strong></p> <p>å‚æ•°è§£æï¼š</p> <ol><li>gitlab-runner register æ˜¯å¯åŠ¨registerçš„å‘½ä»¤</li> <li>GitLabçš„Runneræ˜¾ç¤ºçš„URLåœ°å€ï¼š <code>--url</code></li> <li>GitLabçš„Runneræ˜¾ç¤ºçš„Tokenå€¼ï¼š  <code>--registration-token</code></li> <li>è®¾ç½®Runnerçš„æ ‡ç­¾ï¼š <code>--tag-list</code></li> <li>è®¾ç½®CICDæ„å»ºæ—¶å¯ä»¥ä¸å¯ç”¨Tagï¼š<code>--run-untagged</code></li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 ~<span class="token punctuation">]</span><span class="token comment"># docker run --rm -v /srv/gitlab-runner/config:/etc/gitlab-runner gitlab/gitlab-runner register \</span>
  --non-interactive <span class="token punctuation">\</span>
  --executor <span class="token string">&quot;docker&quot;</span> <span class="token punctuation">\</span>
  --docker-image alpine:latest <span class="token punctuation">\</span>
  --url <span class="token string">&quot;http://10.11.121.111/&quot;</span> <span class="token punctuation">\</span>
  --registration-token <span class="token string">&quot;o4_NCTZvpnViRE7iGxoi&quot;</span> <span class="token punctuation">\</span>
  --description <span class="token string">&quot;first-register-runner&quot;</span> <span class="token punctuation">\</span>
  --tag-list <span class="token string">&quot;k8s&quot;</span> <span class="token punctuation">\</span>
  --run-untagged<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> <span class="token punctuation">\</span>
  --locked<span class="token operator">=</span><span class="token string">&quot;false&quot;</span> <span class="token punctuation">\</span>
  --access-level<span class="token operator">=</span><span class="token string">&quot;not_protected&quot;</span> 
  
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># docker ps | grep gitlab-runner </span>
3e0a02917540   gitlab/gitlab-runner:latest                         <span class="token string">&quot;/usr/bin/dumb-init â€¦&quot;</span>   <span class="token number">26</span> hours ago   Up <span class="token number">3</span> hours                                                                                                                             gitlab-runner
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>2.æŸ¥çœ‹Gitlabè¿æ¥æƒ…å†µ</strong></p> <p>1.è¿›å…¥Gitlabçš„CICDé…ç½®ä¸­ï¼Œæ‰¾åˆ°Runneré…ç½®ï¼Œåˆ·æ–°æ­¤é¡µé¢ã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848483.png" alt="image-20220424231601423"></p> <p>2.æˆ–è€…åœ¨Menuçš„èœå•æ ä¸­ï¼Œæ‰¾åˆ° <code>Admin</code>, ç„¶åé€‰æ‹© <code>Runner</code>ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å½“å‰çš„Runnerè¿æ¥æƒ…å†µã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848560.png" alt="image-20220424231816380"></p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848031.png" alt="image-20220424232117034"></p> <h3 id="_4-helméƒ¨ç½²runner"><a href="#_4-helméƒ¨ç½²runner" class="header-anchor">#</a> 4.Helméƒ¨ç½²Runner</h3> <p><strong>ä»€ä¹ˆæ˜¯Helmï¼Ÿ</strong></p> <p>å°±åƒ Java ä½¿ç”¨ mavenï¼›node ä½¿ç”¨ npmï¼›python ä½¿ç”¨ pipï¼›Linux ä½¿ç”¨ yum æˆ– Apt ä¸€æ ·ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ ·çš„å·¥ä½œï¼ŒæŠ€æœ¯äººå‘˜éƒ½ä¼šå¸Œæœ›æœ‰ä¸€ç§èµ„æºç®¡ç†å™¨/åŒ…ç®¡ç†å™¨ï¼Œä»¥æ­¤æ¥æ–¹ä¾¿å¾—æŸ¥æ‰¾ã€ä¸‹è½½ã€å®‰è£…ã€ä½¿ç”¨å’Œåˆ†å‘è½¯ä»¶åŒ…ã€‚</p> <p>Helm ä½¿ç”¨çš„åŒ…æ ¼å¼ç§°ä¸º <code>chart</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªæè¿° Kubernetes ç›¸å…³èµ„æºå¯¹è±¡çš„æ–‡ä»¶é›†åˆã€‚å®ƒçš„æŠ€æœ¯ç‰¹ç‚¹ç±»ä¼¼ jinjaæ¨¡ç‰ˆï¼Œä»¥æ¸²æŸ“æ¨¡ç‰ˆçš„æ–¹å¼ï¼Œç”Ÿæˆè¿è¡Œä¸€ä¸ªæœåŠ¡å®ä¾‹æ‰€éœ€çš„ä¸€ç³»åˆ—èµ„æºå¯¹è±¡æ–‡ä»¶ï¼Œå¹¶ä»¥æ­¤è¿›è¡ŒæœåŠ¡çš„å‘å¸ƒã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ååˆ†ç®€å•çš„åˆ¶ä½œè‡ªå®šä¹‰çš„ chartã€‚</p> <p>æ‰€ä»¥ Helm å³å¯ä»¥è¯´æ˜¯ <code>K8Sçš„åŒ…ç®¡ç†å™¨</code>ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬å¯¹äº K8S çš„æ“ä½œä¸å†éœ€è¦ç»†åŒ–åˆ°èµ„æºå¯¹è±¡ï¼Œè€Œæ˜¯å¯ä»¥ä½œä¸ºä¸€ä¸ªå®ä¾‹è¿›è¡Œç®¡ç†ã€‚ä¸å†éœ€è¦å»å†™ <code>deployment</code> ã€<code>service</code> ã€<code>ingress</code> çš„ yamlï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥é€šè¿‡ <code>install</code> å‘½ä»¤å®ç°æœåŠ¡å®ä¾‹çš„å®‰è£…ã€‚</p> <p><strong>1.æ‹‰å–Gitlab-Runnerçš„ChartåŒ…</strong></p> <p>é¡¹ç›®åœ°å€ï¼š<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fcharts%2Fgitlab-runner" target="_blank" rel="noopener noreferrer">https://gitlab.com/gitlab-org/charts/gitlab-runner<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master gitlab-runner<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">12</span>
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">369</span> Feb <span class="token number">21</span> 03:39 Chart.yaml
drwxr-xr-x <span class="token number">2</span> root root  <span class="token number">236</span> Apr <span class="token number">24</span> 05:48 templates
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">6452</span> Apr <span class="token number">24</span> 05:47 values.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>2.é…ç½®Chartçš„æ¨¡æ¿</strong></p> <p>ä¿®æ”¹ChartåŒ…çš„values.yamlé…ç½®å¦‚ä¸‹ï¼š</p> <ul><li><code>gitlabUrl:</code> 	é…ç½®Gitlabçš„URL</li> <li><code>runnerRegistrationToken:</code>      é…ç½®Gitlabçš„Runnerçš„Token</li> <li><code>namespace:</code>     é…ç½®å‘½åç©ºé—´</li> <li><code>tags:</code>              é…ç½®æ ‡ç­¾</li> <li><code>cachePath:</code>     é…ç½®ç¼“å­˜è·¯å¾„</li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">image</span><span class="token punctuation">:</span> gitlab/gitlab<span class="token punctuation">-</span>runner<span class="token punctuation">:</span>alpine<span class="token punctuation">-</span>v11.7.0
<span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
<span class="token key atrule">init</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
  <span class="token key atrule">tag</span><span class="token punctuation">:</span> v1.0
<span class="token key atrule">gitlabUrl</span><span class="token punctuation">:</span> <span class="token string">&quot;http://10.11.121.111&quot;</span>
<span class="token key atrule">runnerRegistrationToken</span><span class="token punctuation">:</span> <span class="token string">&quot;o4_NCTZvpnViRE7iGxoi&quot;</span>
<span class="token key atrule">unregisterRunners</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">concurrent</span><span class="token punctuation">:</span> <span class="token number">10</span>
<span class="token key atrule">checkInterval</span><span class="token punctuation">:</span> <span class="token number">30</span>
<span class="token key atrule">rbac</span><span class="token punctuation">:</span>
  <span class="token key atrule">create</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">clusterWideAccess</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">metrics</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">:</span><span class="token number">16.04</span>
  <span class="token key atrule">tags</span><span class="token punctuation">:</span> <span class="token string">&quot;k8s&quot;</span>
  <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> demo
  <span class="token key atrule">cachePath</span><span class="token punctuation">:</span> <span class="token string">&quot;/opt/cache&quot;</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token key atrule">builds</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token key atrule">services</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token key atrule">helpers</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> 
  <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>3.Helméƒ¨ç½²Gitlab-Runner</strong></p> <p>ä½¿ç”¨<code>helm install</code>å‘½ä»¤åˆ›å»ºå®‰è£…Gitlabâ€”Runnerã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master gitlab-cicd<span class="token punctuation">]</span><span class="token comment"># helm install k8s-runner gitlab-runner/ -n demo</span>
<span class="token punctuation">[</span>root@k8s-master gitlab-cicd<span class="token punctuation">]</span><span class="token comment"># helm list -n demo </span>
NAME      	NAMESPACE	REVISION	UPDATED                                	STATUS  	CHART               	APP VERSION
k8s-runner	demo     	<span class="token number">1</span>       	<span class="token number">2022</span>-04-24 <span class="token number">13</span>:13:11.742949709 +0000 UTC	deployed	gitlab-runner-0.1.37	
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>4.æŸ¥çœ‹Gitlabè¿æ¥æƒ…å†µ</strong></p> <p>1.æŸ¥çœ‹å½“å‰çš„èµ„æºæ˜¯å¦åˆ›å»ºæˆåŠŸã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get -n demo all</span>
NAME                                            READY   STATUS    RESTARTS   AGE
pod/k8s-runner-gitlab-runner-544f469c44-9m7zw   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          155m

NAME                                       READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/k8s-runner-gitlab-runner   <span class="token number">1</span>/1     <span class="token number">1</span>            <span class="token number">1</span>           155m

NAME                                                  DESIRED   CURRENT   READY   AGE
replicaset.apps/k8s-runner-gitlab-runner-544f469c44   <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">1</span>       155m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>2.å›åˆ°Gitlabåˆ·æ–°CICDçš„Runnerçš„é…ç½®ï¼Œæ–°çš„Gitlab-Runnerè¿æ¥æˆåŠŸã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848984.png" alt="image-20220424235055148"></p> <p><strong>3.æµ‹è¯•GitLabçš„CICDæµæ°´çº¿</strong></p> <p>1.è¿›å…¥demoçš„é¡¹ç›®,ç‚¹å‡» <code>CI/CD</code>ï¼Œç„¶åæ‰¾åˆ°<code>Editor</code> ï¼Œç¼–å†™ä¸€ä¸ªæµæ°´çº¿è„šæœ¬ï¼Œè¿è¡Œjob1ï¼Œè¾“å‡ºHello Wordã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848184.png" alt="image-20220425000049979"></p> <p>å¦‚ä¸Šçš„.gitlab-ci.yamlæ–‡ä»¶å¦‚ä¸‹ï¼š</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">stages</span><span class="token punctuation">:</span> 
  <span class="token punctuation">-</span> .pre
  <span class="token punctuation">-</span> build
  <span class="token punctuation">-</span> test
  <span class="token punctuation">-</span> deploy 

<span class="token key atrule">job1</span><span class="token punctuation">:</span> 
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> .pre
  <span class="token key atrule">script</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> echo &quot;Hello Word&quot;

<span class="token key atrule">job2</span><span class="token punctuation">:</span> 
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> build
  <span class="token key atrule">script</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> echo &quot;This is build&quot;

<span class="token key atrule">job3</span><span class="token punctuation">:</span> 
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> test
  <span class="token key atrule">script</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> echo &quot;This is test&quot;

<span class="token key atrule">job4</span><span class="token punctuation">:</span> 
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> deploy
  <span class="token key atrule">script</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> echo &quot;This is deploy&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>2.ç‚¹å‡» <code>Commit changes</code> æäº¤æµæ°´çº¿è„šæœ¬ã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848169.png" alt="image-20220425000312131"></p> <p>3.æ„å»ºå®Œæˆä¹‹åï¼ŒæŸ¥çœ‹å½“å‰çš„éƒ¨ç½²æƒ…å†µï¼Œå¯ä»¥å‘ç°å››ä¸ªé˜¶æ®µçš„ä»»åŠ¡éƒ½æ­£å¸¸éƒ¨ç½²ï¼Œæ‰€ä»¥è¯´æ˜Gitlab-CIå·²ç»å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848335.png" alt="image-20220425000806089"></p> <p>4.ç‚¹å‡»Job1ï¼ŒæŸ¥çœ‹å½“å‰çš„Job1è¾“å‡ºçš„æ—¥å¿—ï¼Œæ˜¯å¦ä¸ºHello Wordã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848471.png" alt="image-20220425001000417"></p> <p>å¦‚ä¸Šå›¾å¯ä»¥çœ‹åˆ°Job1ä»»åŠ¡è¾“å‡ºçš„å†…å®¹æ­£å¸¸ã€‚</p> <h2 id="éƒ¨ç½²harbor"><a href="#éƒ¨ç½²harbor" class="header-anchor">#</a> éƒ¨ç½²Harbor</h2> <h3 id="_1-harborä»‹ç»"><a href="#_1-harborä»‹ç»" class="header-anchor">#</a> 1.Harborä»‹ç»</h3> <p>Harbor æºäº 2014 å¹´ VMwareä¸­å›½ç ”å‘ä¸­å¿ƒäº‘åŸç”Ÿå®éªŒå®¤çš„ä¸€ä¸ªå†…éƒ¨é¡¹ç›®ï¼Œæ—¨åœ¨ä¸ºå®¹å™¨çš„å¼€å‘äººå‘˜è§£å†³é•œåƒç®¡ç†çš„é—®é¢˜ã€‚éšç€ Kubernetes å’Œå®¹å™¨æŠ€æœ¯çš„æµè¡Œï¼Œè¯¥é¡¹ç›®äº 2016 å¹´å¼€æºï¼Œ2018 å¹´ 7 æœˆæèµ ç»™ CNCFï¼Œåœ¨åŒå¹´ 11 æœˆè¢«æ­£å¼æ¥å—ä¸ºå­µåŒ–é¡¹ç›®ï¼Œå¹¶åœ¨äº‘åŸç”ŸæŠ€æœ¯è·¯çº¿ä¸ç”Ÿæ€ä¸­æ¼”è¿›ã€‚</p> <p>2020å¹´5æœˆ Harbor 2.0 æ­£å¼å‘å¸ƒï¼Œå¢åŠ äº†å¯¹ OCI åˆ¶å“çš„æ”¯æŒï¼Œèƒ½å¤Ÿå­˜å‚¨å¤§é‡äº‘åŸç”Ÿåˆ¶å“ï¼Œä¾‹å¦‚å®¹å™¨é•œåƒã€Helm Chartã€CNABã€OPA å’Œ Singularity ç­‰ç­‰ã€‚å¼€å‘äººå‘˜å¯ä¾ç…§ OCI è§„èŒƒï¼Œé€šè¿‡ OCI ç´¢å¼•å’Œ OCI åˆ¶å“åŠŸèƒ½å¼€æ‹“æ›´å¹¿æ³›çš„åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬ç­–ç•¥ã€è¿œç¨‹å¤åˆ¶å’ŒåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ç­‰ã€‚</p> <h3 id="_2-harboréƒ¨ç½²"><a href="#_2-harboréƒ¨ç½²" class="header-anchor">#</a> 2.Harboréƒ¨ç½²</h3> <ul><li>é¦–é€‰å¿…é¡»å®‰è£…docker-composeçš„æ’ä»¶ï¼Œè¿™é‡Œæˆ‘å·²ç»å®‰è£…äº†docker-compose</li> <li>ç¦ç”¨httpsç­–ç•¥ï¼Œä½¿ç”¨httpç­–ç•¥</li> <li>å°†hostnameä¿®æ”¹ä¸º10.11.121.112</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 harbor<span class="token punctuation">]</span><span class="token comment"># docker-compose version </span>
Docker Compose version v2.2.1
<span class="token punctuation">[</span>root@k8s-node1 opt<span class="token punctuation">]</span><span class="token comment"># tar zxvf harbor-offline.tar.gz </span>
<span class="token punctuation">[</span>root@k8s-node1 opt<span class="token punctuation">]</span><span class="token comment"># cd harbor/</span>
<span class="token punctuation">[</span>root@k8s-node1 opt<span class="token punctuation">]</span><span class="token comment"># vim harbor.yaml </span>
hostname: <span class="token number">10.11</span>.121.112

<span class="token comment"># http related config</span>
http:
  <span class="token comment"># port for http, default is 80. If https enabled, this port will redirect to https port</span>
  port: <span class="token number">80</span>

<span class="token comment"># https related config</span>
<span class="token comment">#https:</span>
  <span class="token comment"># https port for harbor, default is 443</span>
<span class="token comment">#  port: 443</span>
  <span class="token comment"># The path of cert and key files for nginx</span>
<span class="token comment">#  certificate: /your/certificate/path</span>
<span class="token comment">#  private_key: /your/private/key/path</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>æ‰§è¡Œå‘½ä»¤å®‰è£…Harborï¼ŒæŸ¥çœ‹harborçš„è¿›ç¨‹ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 harbor<span class="token punctuation">]</span><span class="token comment"># ./install.sh </span>
<span class="token punctuation">[</span>Step <span class="token number">0</span><span class="token punctuation">]</span>: checking <span class="token keyword">if</span> <span class="token function">docker</span> is installed <span class="token punctuation">..</span>.
Note: <span class="token function">docker</span> version: <span class="token number">20.10</span>.14

<span class="token punctuation">[</span>Step <span class="token number">1</span><span class="token punctuation">]</span>: checking <span class="token function">docker-compose</span> is installed <span class="token punctuation">..</span>.
Note: <span class="token function">docker-compose</span> version: <span class="token number">2.2</span>.1

<span class="token punctuation">[</span>Step <span class="token number">2</span><span class="token punctuation">]</span>: loading Harbor images <span class="token punctuation">..</span>.
Â·Â·Â·
<span class="token punctuation">[</span>Step <span class="token number">5</span><span class="token punctuation">]</span>: starting Harbor <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Running <span class="token number">10</span>/10
 â ¿ Network harbor_harbor        Created                                                                                                 <span class="token number">0</span>.1s
 â ¿ Container harbor-log         Started                                                                                                 <span class="token number">1</span>.6s
 â ¿ Container harbor-db          Started                                                                                                 <span class="token number">2</span>.6s
 â ¿ Container registryctl        Started                                                                                                 <span class="token number">3</span>.2s
 â ¿ Container harbor-portal      Started                                                                                                 <span class="token number">2</span>.8s
 â ¿ Container registry           Started                                                                                                 <span class="token number">3</span>.2s
 â ¿ Container redis              Started                                                                                                 <span class="token number">3</span>.2s
 â ¿ Container harbor-core        Started                                                                                                 <span class="token number">4</span>.0s
 â ¿ Container nginx              Started                                                                                                 <span class="token number">5</span>.3s
 â ¿ Container harbor-jobservice  Started                                                                                                 <span class="token number">5</span>.3s
âœ” ----Harbor has been installed and started successfully.----


<span class="token punctuation">[</span>root@k8s-node1 harbor<span class="token punctuation">]</span><span class="token comment"># docker-compose  ps </span>
NAME                COMMAND                  SERVICE             STATUS              PORTS
harbor-core         <span class="token string">&quot;/harbor/entrypoint.â€¦&quot;</span>   core                running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   
harbor-db           <span class="token string">&quot;/docker-entrypoint.â€¦&quot;</span>   postgresql          running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   
harbor-jobservice   <span class="token string">&quot;/harbor/entrypoint.â€¦&quot;</span>   jobservice          running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   
harbor-log          <span class="token string">&quot;/bin/sh -c /usr/locâ€¦&quot;</span>   log                 running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   <span class="token number">127.0</span>.0.1:1514-<span class="token operator">&gt;</span><span class="token number">10514</span>/tcp
harbor-portal       <span class="token string">&quot;nginx -g 'daemon ofâ€¦&quot;</span>   portal              running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   
nginx               <span class="token string">&quot;nginx -g 'daemon ofâ€¦&quot;</span>   proxy               running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   <span class="token number">0.0</span>.0.0:80-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp, :::80-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp
redis               <span class="token string">&quot;redis-server /etc/râ€¦&quot;</span>   redis               running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   
registry            <span class="token string">&quot;/home/harbor/entrypâ€¦&quot;</span>   registry            running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span>   
registryctl         <span class="token string">&quot;/home/harbor/start.â€¦&quot;</span>   registryctl         running <span class="token punctuation">(</span>healthy<span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>è®¿é—®Harboråœ°å€ï¼š http://10.11.121.112</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848345.png" alt="image-20220425001823055"></p> <h3 id="_3-æ·»åŠ é•œåƒä»“åº“"><a href="#_3-æ·»åŠ é•œåƒä»“åº“" class="header-anchor">#</a> 3.æ·»åŠ é•œåƒä»“åº“</h3> <p>ç‚¹å‡» <code>æ–°å»ºé¡¹ç›®</code> ï¼Œåˆ›å»ºé¡¹ç›®åç§°ä¸º <code>demo</code>ï¼Œè®¿é—®çº§åˆ«è®¾ç½®ä¸º <code>å…¬å¼€</code>ã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848880.png" alt="image-20220425002022377"></p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848072.png" alt="image-20220425002121911"></p> <h2 id="é…ç½®cicd"><a href="#é…ç½®cicd" class="header-anchor">#</a> é…ç½®CICD</h2> <h3 id="_1-é…ç½®-gitlab-ci-yml"><a href="#_1-é…ç½®-gitlab-ci-yml" class="header-anchor">#</a> 1.é…ç½®.gitlab-ci.yml</h3> <p>é…ç½®.gitlab-ci.yamlçš„æµæ°´çº¿é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p> <ul><li>ä½¿ç”¨<code>docker:v1.0</code>çš„é•œåƒä½œä¸ºåŸºç¡€é•œåƒ</li> <li>éœ€è¦æ„å»ºä¸‰ä¸ªæ­¥éª¤ï¼š<code>maven-buildã€docker-buildã€deploy</code></li> <li>ä½¿ç”¨<code>mavené•œåƒ</code>æ„å»ºç¼–è¯‘demo-2048é¡¹ç›®</li> <li>ä½¿ç”¨<code>dockeré•œåƒ</code>buildæ–°çš„é•œåƒï¼Œæ¨é€åˆ°Harborä»“åº“ä¸­</li> <li>ä½¿ç”¨<code>kubeleté•œåƒ</code>éƒ¨ç½²demo-2048çš„yamlæ–‡ä»¶</li></ul> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">image</span><span class="token punctuation">:</span> docker<span class="token punctuation">:</span>v1.0
<span class="token key atrule">stages</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> maven<span class="token punctuation">-</span>build
  <span class="token punctuation">-</span> docker<span class="token punctuation">-</span>build
  <span class="token punctuation">-</span> deploy

<span class="token comment"># è¿™æ˜¯å®šä¹‰çš„å˜é‡ï¼Œæ˜¯Harborä»“åº“ç™»å½•çš„éªŒè¯ä¿¡æ¯ã€‚</span>
<span class="token key atrule">variables</span><span class="token punctuation">:</span>
  <span class="token key atrule">USERNAME</span><span class="token punctuation">:</span> admin
  <span class="token key atrule">PASSWORD</span><span class="token punctuation">:</span> Harbor12345
  <span class="token key atrule">HARBORIP</span><span class="token punctuation">:</span> 10.11.121.112

<span class="token key atrule">maven-build</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> maven<span class="token punctuation">:</span>3.6<span class="token punctuation">-</span>jdk<span class="token punctuation">-</span><span class="token number">8</span>
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> maven<span class="token punctuation">-</span>build 
  <span class="token key atrule">script</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> mkdir <span class="token punctuation">-</span>p /root/.m2/repository
    <span class="token punctuation">-</span> cp <span class="token punctuation">-</span>rvf /opt/repository/*  /root/.m2/repository/
    <span class="token punctuation">-</span> mvn clean install <span class="token punctuation">-</span>Dmaven.test.sktip=true
    <span class="token punctuation">-</span> cp <span class="token punctuation">-</span>rvf /root/demo/target/demo<span class="token punctuation">-</span>2048  /opt/cache

<span class="token key atrule">docker_build</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> docker<span class="token punctuation">:</span>v1.0
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> docker<span class="token punctuation">-</span>build
  <span class="token key atrule">script</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> mv /opt/cache/* /root/demo/Dockerfiles/
    <span class="token punctuation">-</span> cd /root/demo/Dockerfiles/ <span class="token important">&amp;&amp;</span> ls
    <span class="token punctuation">-</span> docker build <span class="token punctuation">-</span>t $HARBORIP/demo/demo<span class="token punctuation">-</span>2048<span class="token punctuation">:</span>v1.0 <span class="token punctuation">-</span>f /root/demo/Dockerfiles/Dockerfile . 
    <span class="token punctuation">-</span> docker login <span class="token punctuation">-</span>u $USERNAME <span class="token punctuation">-</span>p $PASSWORD $HARBORIP 
    <span class="token punctuation">-</span> docker push $HARBORIP/demo/demo<span class="token punctuation">-</span>2048<span class="token punctuation">:</span>v1.0

<span class="token comment"># è¿™é‡Œçš„kubectlæ˜¯åšçš„é•œåƒï¼Œæ˜¯åœ¨æœ¬åœ°ä»“åº“ï¼Œä½¿ç”¨configè¿æ¥Kubernetesé›†ç¾¤</span>
<span class="token key atrule">deploy</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> kubectl<span class="token punctuation">:</span>1.16.6
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> deploy 
  <span class="token key atrule">script</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> mkdir $HOME/.kube <span class="token important">&amp;&amp;</span> cat $K8S_CONFIG <span class="token punctuation">&gt;</span> $HOME/.kube/config
    <span class="token punctuation">-</span> cd $HOME/.kube <span class="token important">&amp;&amp;</span> pwd
    <span class="token punctuation">-</span> sed <span class="token punctuation">-</span>i 's/10.24.2.3/10.11.121.112/g' /root/demo/template/demo<span class="token punctuation">-</span>2048.yaml 
    <span class="token punctuation">-</span> sed <span class="token punctuation">-</span>i 's/<span class="token punctuation">{</span><span class="token punctuation">{</span>build_tag<span class="token punctuation">}</span><span class="token punctuation">}</span>/v1.0/g' /root/demo/template/demo<span class="token punctuation">-</span>2048.yaml 
    <span class="token punctuation">-</span> sed <span class="token punctuation">-</span>i 's/8889/30003/g' /root/demo/template/demo<span class="token punctuation">-</span>2048.yaml 
    <span class="token punctuation">-</span> kubectl apply <span class="token punctuation">-</span>f /root/demo/template/demo<span class="token punctuation">-</span>2048.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="_2-å¼€å§‹æ„å»º"><a href="#_2-å¼€å§‹æ„å»º" class="header-anchor">#</a> 2.å¼€å§‹æ„å»º</h3> <p>ç‚¹å‡» <code>æäº¤å®Œæˆ</code> æ„å»ºCICDã€‚</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848856.png" alt="image-20220425003143807"></p> <p>ç­‰å¾…ç»“æœï¼š</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848288.png" alt="image-20220425003438600"></p> <h3 id="_3-æŸ¥çœ‹gitlab-ci"><a href="#_3-æŸ¥çœ‹gitlab-ci" class="header-anchor">#</a> 3.æŸ¥çœ‹Gitlab-CI</h3> <p>æŸ¥çœ‹æ„å»ºçš„è¾“å‡ºæ—¥å¿—å†…å®¹ã€‚</p> <p>å¦‚ä¸‹æ˜¯maven-buildçš„è¾“å‡ºå†…å®¹ï¼š</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848151.png" alt="image-20220425003531697"></p> <p>å¦‚ä¸‹æ˜¯docker-buildçš„è¾“å‡ºå†…å®¹ï¼š</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848855.png" alt="image-20220425003550405"></p> <p>å¦‚ä¸‹æ˜¯deployçš„è¾“å‡ºå†…å®¹ï¼š</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848591.png" alt="image-20220425003605898"></p> <h3 id="_4-è®¿é—®é¡¹ç›®"><a href="#_4-è®¿é—®é¡¹ç›®" class="header-anchor">#</a> 4.è®¿é—®é¡¹ç›®</h3> <p>æŸ¥çœ‹å½“å‰çš„demoå‘½åç©ºé—´ä¸‹çš„èµ„æºï¼Œdemo-2048åº”ç”¨ç¨‹åºéƒ¨ç½²å®Œæˆã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get  pods -n demo</span>
NAME                                        READY   STATUS    RESTARTS   AGE
demo-2048-6858bb9f8d-522rn                  <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m19s
k8s-runner-gitlab-runner-544f469c44-9m7zw   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3h23m
<span class="token punctuation">[</span>root@k8s-node1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get svc -n demo </span>
NAME        TYPE       CLUSTER-IP     EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>          AGE
demo30003   NodePort   <span class="token number">10.96</span>.113.92   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">8080</span>:30003/TCP   3m24s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>è®¿é—®é¡µé¢ï¼š http://10.11.121.112:30003</p> <p><img src="https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250849199.png" alt="image-20220425003906131"></p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/isicman/Vue/edit/master/docs/ã€ŠCICDã€‹å­¦ä¹ ç¬”è®°/03.GitLab-CI + Harbor + Kubernetes.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/Vue/tags/?tag=CICD" title="æ ‡ç­¾">#CICD</a></div> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/Vue/pages/1ec44e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Gitlab-Runner + k8s å®ç°è‡ªåŠ¨éƒ¨ç½²</div></a> <a href="/Vue/pages/7799fb/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Gitea+K8s-Jenkins-master-slave(webhooké’©å­)</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/Vue/pages/1ec44e/" class="prev">Gitlab-Runner + k8s å®ç°è‡ªåŠ¨éƒ¨ç½²</a></span> <span class="next"><a href="/Vue/pages/7799fb/">Gitea+K8s-Jenkins-master-slave(webhooké’©å­)</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/Vue/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/Vue/pages/ace346/"><div>
            SpringBooté…ç½®æ–‡ä»¶
            <!----></div></a> <span class="date">07-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/Vue/pages/69a126/"><div>
            æ•´åˆJunitå’ŒMybatis
            <!----></div></a> <span class="date">07-27</span></dt></dl><dl><dd>03</dd> <dt><a href="/Vue/pages/3e651a/"><div>
            SpringBootå¿«é€Ÿå…¥é—¨
            <!----></div></a> <span class="date">07-27</span></dt></dl> <dl><dd></dd> <dt><a href="/Vue/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2019-2022
    <span>Evan Xu | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><canvas id="vuepress-canvas-cursor"></canvas><div></div></div></div>
    <script src="/Vue/assets/js/app.2f1a3b6e.js" defer></script><script src="/Vue/assets/js/2.3b495877.js" defer></script><script src="/Vue/assets/js/3.0279f92a.js" defer></script><script src="/Vue/assets/js/70.26a7c3b0.js" defer></script><script src="/Vue/assets/js/4.cb69b0f7.js" defer></script>
  </body>
</html>
