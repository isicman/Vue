<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubernetes é«˜çº§è¿ç»´</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/Vue/img/avatar.png">
    <meta name="description" content="æš‚ä¸”ä¸ºç©º">
    <meta name="keywords" content="å‰ç«¯åšå®¢,ä¸ªäººæŠ€æœ¯åšå®¢,å‰ç«¯,å‰ç«¯å¼€å‘,å‰ç«¯æ¡†æ¶,webå‰ç«¯,å‰ç«¯é¢è¯•é¢˜,æŠ€æœ¯æ–‡æ¡£,å­¦ä¹ ,é¢è¯•,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/Vue/assets/css/0.styles.0779c551.css" as="style"><link rel="preload" href="/Vue/assets/js/app.2f1a3b6e.js" as="script"><link rel="preload" href="/Vue/assets/js/2.3b495877.js" as="script"><link rel="preload" href="/Vue/assets/js/3.0279f92a.js" as="script"><link rel="preload" href="/Vue/assets/js/154.9cabe557.js" as="script"><link rel="preload" href="/Vue/assets/js/4.cb69b0f7.js" as="script"><link rel="prefetch" href="/Vue/assets/js/10.c275bb5d.js"><link rel="prefetch" href="/Vue/assets/js/100.3bb1b0e4.js"><link rel="prefetch" href="/Vue/assets/js/101.a01d59f4.js"><link rel="prefetch" href="/Vue/assets/js/102.f419e012.js"><link rel="prefetch" href="/Vue/assets/js/103.bd5f9634.js"><link rel="prefetch" href="/Vue/assets/js/104.ed16bff2.js"><link rel="prefetch" href="/Vue/assets/js/105.8d8a884a.js"><link rel="prefetch" href="/Vue/assets/js/106.aa743e85.js"><link rel="prefetch" href="/Vue/assets/js/107.cf714f94.js"><link rel="prefetch" href="/Vue/assets/js/108.e6ec757c.js"><link rel="prefetch" href="/Vue/assets/js/109.24cd0706.js"><link rel="prefetch" href="/Vue/assets/js/11.af7952aa.js"><link rel="prefetch" href="/Vue/assets/js/110.b601f694.js"><link rel="prefetch" href="/Vue/assets/js/111.bddaa63e.js"><link rel="prefetch" href="/Vue/assets/js/112.9737407e.js"><link rel="prefetch" href="/Vue/assets/js/113.182a72b9.js"><link rel="prefetch" href="/Vue/assets/js/114.88e3528a.js"><link rel="prefetch" href="/Vue/assets/js/115.e6fb1e07.js"><link rel="prefetch" href="/Vue/assets/js/116.05edf9a6.js"><link rel="prefetch" href="/Vue/assets/js/117.3488639c.js"><link rel="prefetch" href="/Vue/assets/js/118.cb030e7c.js"><link rel="prefetch" href="/Vue/assets/js/119.36ed2122.js"><link rel="prefetch" href="/Vue/assets/js/12.a3654490.js"><link rel="prefetch" href="/Vue/assets/js/120.78f37852.js"><link rel="prefetch" href="/Vue/assets/js/121.33f9f917.js"><link rel="prefetch" href="/Vue/assets/js/122.db28c031.js"><link rel="prefetch" href="/Vue/assets/js/123.fae41aaa.js"><link rel="prefetch" href="/Vue/assets/js/124.6014ee0f.js"><link rel="prefetch" href="/Vue/assets/js/125.048d7ee9.js"><link rel="prefetch" href="/Vue/assets/js/126.79671cb1.js"><link rel="prefetch" href="/Vue/assets/js/127.b607fed5.js"><link rel="prefetch" href="/Vue/assets/js/128.6a5a1980.js"><link rel="prefetch" href="/Vue/assets/js/129.6bc2af6c.js"><link rel="prefetch" href="/Vue/assets/js/13.91a93260.js"><link rel="prefetch" href="/Vue/assets/js/130.31dc0318.js"><link rel="prefetch" href="/Vue/assets/js/131.1f4ef5a2.js"><link rel="prefetch" href="/Vue/assets/js/132.aad55f7b.js"><link rel="prefetch" href="/Vue/assets/js/133.850511a4.js"><link rel="prefetch" href="/Vue/assets/js/134.0f6b070c.js"><link rel="prefetch" href="/Vue/assets/js/135.ee7fea35.js"><link rel="prefetch" href="/Vue/assets/js/136.a46039e3.js"><link rel="prefetch" href="/Vue/assets/js/137.1c7ebf24.js"><link rel="prefetch" href="/Vue/assets/js/138.6a80ffa9.js"><link rel="prefetch" href="/Vue/assets/js/139.f958f7b4.js"><link rel="prefetch" href="/Vue/assets/js/14.58c9ae82.js"><link rel="prefetch" href="/Vue/assets/js/140.d1e73936.js"><link rel="prefetch" href="/Vue/assets/js/141.a9897e5f.js"><link rel="prefetch" href="/Vue/assets/js/142.2b20335e.js"><link rel="prefetch" href="/Vue/assets/js/143.4e6e434c.js"><link rel="prefetch" href="/Vue/assets/js/144.5910990e.js"><link rel="prefetch" href="/Vue/assets/js/145.5c556359.js"><link rel="prefetch" href="/Vue/assets/js/146.86e27014.js"><link rel="prefetch" href="/Vue/assets/js/147.6c4a48cf.js"><link rel="prefetch" href="/Vue/assets/js/148.86e97474.js"><link rel="prefetch" href="/Vue/assets/js/149.c2f69712.js"><link rel="prefetch" href="/Vue/assets/js/15.2ff73105.js"><link rel="prefetch" href="/Vue/assets/js/150.33cf046e.js"><link rel="prefetch" href="/Vue/assets/js/151.5e66e299.js"><link rel="prefetch" href="/Vue/assets/js/152.e56f28bb.js"><link rel="prefetch" href="/Vue/assets/js/153.ad838120.js"><link rel="prefetch" href="/Vue/assets/js/155.7fc9c59f.js"><link rel="prefetch" href="/Vue/assets/js/156.99beb2dc.js"><link rel="prefetch" href="/Vue/assets/js/157.2f6f138c.js"><link rel="prefetch" href="/Vue/assets/js/158.c2ebfe13.js"><link rel="prefetch" href="/Vue/assets/js/159.ecad0f76.js"><link rel="prefetch" href="/Vue/assets/js/16.afec3afd.js"><link rel="prefetch" href="/Vue/assets/js/160.a0c44de2.js"><link rel="prefetch" href="/Vue/assets/js/161.a02953aa.js"><link rel="prefetch" href="/Vue/assets/js/162.da6c21cd.js"><link rel="prefetch" href="/Vue/assets/js/163.ccd82bba.js"><link rel="prefetch" href="/Vue/assets/js/164.a5b2d27c.js"><link rel="prefetch" href="/Vue/assets/js/165.6306c9da.js"><link rel="prefetch" href="/Vue/assets/js/166.d30a40d2.js"><link rel="prefetch" href="/Vue/assets/js/167.576fbdd9.js"><link rel="prefetch" href="/Vue/assets/js/168.5132f3f2.js"><link rel="prefetch" href="/Vue/assets/js/169.4f7b6bda.js"><link rel="prefetch" href="/Vue/assets/js/17.cb0083c7.js"><link rel="prefetch" href="/Vue/assets/js/170.73f50e6b.js"><link rel="prefetch" href="/Vue/assets/js/171.0691ff72.js"><link rel="prefetch" href="/Vue/assets/js/172.5b3bffba.js"><link rel="prefetch" href="/Vue/assets/js/173.a821c842.js"><link rel="prefetch" href="/Vue/assets/js/174.c7954299.js"><link rel="prefetch" href="/Vue/assets/js/175.431864a2.js"><link rel="prefetch" href="/Vue/assets/js/176.d22b5dfb.js"><link rel="prefetch" href="/Vue/assets/js/177.b278b962.js"><link rel="prefetch" href="/Vue/assets/js/178.07cf1514.js"><link rel="prefetch" href="/Vue/assets/js/179.c3273c2d.js"><link rel="prefetch" href="/Vue/assets/js/18.a09885e4.js"><link rel="prefetch" href="/Vue/assets/js/180.77ca26cf.js"><link rel="prefetch" href="/Vue/assets/js/181.788e42a1.js"><link rel="prefetch" href="/Vue/assets/js/182.8e7519e7.js"><link rel="prefetch" href="/Vue/assets/js/183.e54e78ae.js"><link rel="prefetch" href="/Vue/assets/js/184.22debe4b.js"><link rel="prefetch" href="/Vue/assets/js/185.e76ccf85.js"><link rel="prefetch" href="/Vue/assets/js/186.df4cb6e8.js"><link rel="prefetch" href="/Vue/assets/js/187.41fb453e.js"><link rel="prefetch" href="/Vue/assets/js/188.5bca0a92.js"><link rel="prefetch" href="/Vue/assets/js/189.3133bb55.js"><link rel="prefetch" href="/Vue/assets/js/19.13e3db6d.js"><link rel="prefetch" href="/Vue/assets/js/190.0b203720.js"><link rel="prefetch" href="/Vue/assets/js/191.ae34cdeb.js"><link rel="prefetch" href="/Vue/assets/js/192.c6b8de66.js"><link rel="prefetch" href="/Vue/assets/js/193.5350de54.js"><link rel="prefetch" href="/Vue/assets/js/194.9dc316f3.js"><link rel="prefetch" href="/Vue/assets/js/195.371cebb0.js"><link rel="prefetch" href="/Vue/assets/js/196.1164784c.js"><link rel="prefetch" href="/Vue/assets/js/197.824319f1.js"><link rel="prefetch" href="/Vue/assets/js/198.60a7beb3.js"><link rel="prefetch" href="/Vue/assets/js/199.5bcefde2.js"><link rel="prefetch" href="/Vue/assets/js/20.73bf2d20.js"><link rel="prefetch" href="/Vue/assets/js/200.b47e15ba.js"><link rel="prefetch" href="/Vue/assets/js/201.956ec86b.js"><link rel="prefetch" href="/Vue/assets/js/202.8a272715.js"><link rel="prefetch" href="/Vue/assets/js/203.0f429f03.js"><link rel="prefetch" href="/Vue/assets/js/204.278ee080.js"><link rel="prefetch" href="/Vue/assets/js/205.83c0fe12.js"><link rel="prefetch" href="/Vue/assets/js/206.ffdc349c.js"><link rel="prefetch" href="/Vue/assets/js/207.f165bca5.js"><link rel="prefetch" href="/Vue/assets/js/208.6991b2ef.js"><link rel="prefetch" href="/Vue/assets/js/209.c0418849.js"><link rel="prefetch" href="/Vue/assets/js/21.0a96b638.js"><link rel="prefetch" href="/Vue/assets/js/210.4257550c.js"><link rel="prefetch" href="/Vue/assets/js/211.097d1f31.js"><link rel="prefetch" href="/Vue/assets/js/212.ea96e672.js"><link rel="prefetch" href="/Vue/assets/js/213.2b921d6b.js"><link rel="prefetch" href="/Vue/assets/js/214.226476f0.js"><link rel="prefetch" href="/Vue/assets/js/215.3a320e63.js"><link rel="prefetch" href="/Vue/assets/js/216.1388e227.js"><link rel="prefetch" href="/Vue/assets/js/217.050bf527.js"><link rel="prefetch" href="/Vue/assets/js/218.95ee0100.js"><link rel="prefetch" href="/Vue/assets/js/219.acef3d57.js"><link rel="prefetch" href="/Vue/assets/js/22.97c5162c.js"><link rel="prefetch" href="/Vue/assets/js/220.1b2dda0a.js"><link rel="prefetch" href="/Vue/assets/js/221.4505e1c5.js"><link rel="prefetch" href="/Vue/assets/js/222.340ecf8b.js"><link rel="prefetch" href="/Vue/assets/js/223.2acba7c0.js"><link rel="prefetch" href="/Vue/assets/js/224.563b0345.js"><link rel="prefetch" href="/Vue/assets/js/225.f573a8b0.js"><link rel="prefetch" href="/Vue/assets/js/226.bd1a73fe.js"><link rel="prefetch" href="/Vue/assets/js/227.23a589e3.js"><link rel="prefetch" href="/Vue/assets/js/228.6f344c78.js"><link rel="prefetch" href="/Vue/assets/js/229.0c1a78af.js"><link rel="prefetch" href="/Vue/assets/js/23.e42d5b5a.js"><link rel="prefetch" href="/Vue/assets/js/230.e412a305.js"><link rel="prefetch" href="/Vue/assets/js/231.108982c3.js"><link rel="prefetch" href="/Vue/assets/js/232.07986abe.js"><link rel="prefetch" href="/Vue/assets/js/233.61b390cc.js"><link rel="prefetch" href="/Vue/assets/js/234.e1e030d7.js"><link rel="prefetch" href="/Vue/assets/js/235.be0057c0.js"><link rel="prefetch" href="/Vue/assets/js/236.e2722a7c.js"><link rel="prefetch" href="/Vue/assets/js/237.18291d84.js"><link rel="prefetch" href="/Vue/assets/js/238.ec2188b5.js"><link rel="prefetch" href="/Vue/assets/js/239.1629749f.js"><link rel="prefetch" href="/Vue/assets/js/24.7a7fd1e0.js"><link rel="prefetch" href="/Vue/assets/js/240.f1cf9e57.js"><link rel="prefetch" href="/Vue/assets/js/241.55e170d7.js"><link rel="prefetch" href="/Vue/assets/js/242.b7b6b401.js"><link rel="prefetch" href="/Vue/assets/js/243.bb7906d0.js"><link rel="prefetch" href="/Vue/assets/js/244.5ed9a466.js"><link rel="prefetch" href="/Vue/assets/js/245.464ebcaa.js"><link rel="prefetch" href="/Vue/assets/js/246.b49672d3.js"><link rel="prefetch" href="/Vue/assets/js/247.9a55ab30.js"><link rel="prefetch" href="/Vue/assets/js/248.815ea9fd.js"><link rel="prefetch" href="/Vue/assets/js/249.e8dfafa3.js"><link rel="prefetch" href="/Vue/assets/js/25.f17c8641.js"><link rel="prefetch" href="/Vue/assets/js/250.9762a60e.js"><link rel="prefetch" href="/Vue/assets/js/251.92a204a2.js"><link rel="prefetch" href="/Vue/assets/js/252.ec8bcce5.js"><link rel="prefetch" href="/Vue/assets/js/253.180604ac.js"><link rel="prefetch" href="/Vue/assets/js/254.73c69216.js"><link rel="prefetch" href="/Vue/assets/js/255.ee3e1d58.js"><link rel="prefetch" href="/Vue/assets/js/256.8f2376e7.js"><link rel="prefetch" href="/Vue/assets/js/257.6b40ed57.js"><link rel="prefetch" href="/Vue/assets/js/258.cbda5405.js"><link rel="prefetch" href="/Vue/assets/js/259.4afaab82.js"><link rel="prefetch" href="/Vue/assets/js/26.d01eec21.js"><link rel="prefetch" href="/Vue/assets/js/260.223291dd.js"><link rel="prefetch" href="/Vue/assets/js/261.66b7cee0.js"><link rel="prefetch" href="/Vue/assets/js/262.7646537d.js"><link rel="prefetch" href="/Vue/assets/js/263.2102a21b.js"><link rel="prefetch" href="/Vue/assets/js/264.01f69d37.js"><link rel="prefetch" href="/Vue/assets/js/265.3ac8cba8.js"><link rel="prefetch" href="/Vue/assets/js/266.a6a4a04d.js"><link rel="prefetch" href="/Vue/assets/js/267.be57cedf.js"><link rel="prefetch" href="/Vue/assets/js/268.27ea675e.js"><link rel="prefetch" href="/Vue/assets/js/269.8fa76d0c.js"><link rel="prefetch" href="/Vue/assets/js/27.82945f33.js"><link rel="prefetch" href="/Vue/assets/js/270.2c92fb60.js"><link rel="prefetch" href="/Vue/assets/js/271.905fd143.js"><link rel="prefetch" href="/Vue/assets/js/272.eebdf848.js"><link rel="prefetch" href="/Vue/assets/js/273.f02e16f4.js"><link rel="prefetch" href="/Vue/assets/js/274.1bb4b532.js"><link rel="prefetch" href="/Vue/assets/js/275.dd5ea9d3.js"><link rel="prefetch" href="/Vue/assets/js/276.74d6f8ab.js"><link rel="prefetch" href="/Vue/assets/js/277.b5b213b1.js"><link rel="prefetch" href="/Vue/assets/js/278.5e706d6b.js"><link rel="prefetch" href="/Vue/assets/js/279.1489f169.js"><link rel="prefetch" href="/Vue/assets/js/28.4c76df2a.js"><link rel="prefetch" href="/Vue/assets/js/280.19a374ee.js"><link rel="prefetch" href="/Vue/assets/js/281.d65b3987.js"><link rel="prefetch" href="/Vue/assets/js/282.5a6e3624.js"><link rel="prefetch" href="/Vue/assets/js/283.e7c54b99.js"><link rel="prefetch" href="/Vue/assets/js/284.5d480289.js"><link rel="prefetch" href="/Vue/assets/js/285.44c27c32.js"><link rel="prefetch" href="/Vue/assets/js/286.1b8d0289.js"><link rel="prefetch" href="/Vue/assets/js/287.96b027f9.js"><link rel="prefetch" href="/Vue/assets/js/288.130579e7.js"><link rel="prefetch" href="/Vue/assets/js/289.f4187c09.js"><link rel="prefetch" href="/Vue/assets/js/29.6e068a06.js"><link rel="prefetch" href="/Vue/assets/js/290.4c49c46b.js"><link rel="prefetch" href="/Vue/assets/js/291.193647db.js"><link rel="prefetch" href="/Vue/assets/js/292.7268e373.js"><link rel="prefetch" href="/Vue/assets/js/293.bcfefa9e.js"><link rel="prefetch" href="/Vue/assets/js/294.54f6a432.js"><link rel="prefetch" href="/Vue/assets/js/295.5020e3e7.js"><link rel="prefetch" href="/Vue/assets/js/296.d7f32e58.js"><link rel="prefetch" href="/Vue/assets/js/297.5dbbaabe.js"><link rel="prefetch" href="/Vue/assets/js/298.e6bf1a42.js"><link rel="prefetch" href="/Vue/assets/js/299.a18d8ba7.js"><link rel="prefetch" href="/Vue/assets/js/30.b168baee.js"><link rel="prefetch" href="/Vue/assets/js/300.ba217ef5.js"><link rel="prefetch" href="/Vue/assets/js/301.f96a76f5.js"><link rel="prefetch" href="/Vue/assets/js/302.37e0b19e.js"><link rel="prefetch" href="/Vue/assets/js/303.031b4c8e.js"><link rel="prefetch" href="/Vue/assets/js/304.d96cbd8b.js"><link rel="prefetch" href="/Vue/assets/js/305.0dcf6344.js"><link rel="prefetch" href="/Vue/assets/js/306.4f2540d0.js"><link rel="prefetch" href="/Vue/assets/js/31.dad269c9.js"><link rel="prefetch" href="/Vue/assets/js/32.63b50b54.js"><link rel="prefetch" href="/Vue/assets/js/33.04949d86.js"><link rel="prefetch" href="/Vue/assets/js/34.56a89946.js"><link rel="prefetch" href="/Vue/assets/js/35.3390f24b.js"><link rel="prefetch" href="/Vue/assets/js/36.14595b6f.js"><link rel="prefetch" href="/Vue/assets/js/37.8fcd4835.js"><link rel="prefetch" href="/Vue/assets/js/38.1825c8e2.js"><link rel="prefetch" href="/Vue/assets/js/39.b4ada2b6.js"><link rel="prefetch" href="/Vue/assets/js/40.c296d94a.js"><link rel="prefetch" href="/Vue/assets/js/41.283d95eb.js"><link rel="prefetch" href="/Vue/assets/js/42.0c1e2947.js"><link rel="prefetch" href="/Vue/assets/js/43.c6d0bcee.js"><link rel="prefetch" href="/Vue/assets/js/44.3287d646.js"><link rel="prefetch" href="/Vue/assets/js/45.1953ece5.js"><link rel="prefetch" href="/Vue/assets/js/46.a3b47dce.js"><link rel="prefetch" href="/Vue/assets/js/47.cf352360.js"><link rel="prefetch" href="/Vue/assets/js/48.d0f63d8e.js"><link rel="prefetch" href="/Vue/assets/js/49.4badb8d1.js"><link rel="prefetch" href="/Vue/assets/js/5.cacfa1e9.js"><link rel="prefetch" href="/Vue/assets/js/50.746e8eac.js"><link rel="prefetch" href="/Vue/assets/js/51.d56d5dbd.js"><link rel="prefetch" href="/Vue/assets/js/52.904cb343.js"><link rel="prefetch" href="/Vue/assets/js/53.e38427ab.js"><link rel="prefetch" href="/Vue/assets/js/54.b6de4473.js"><link rel="prefetch" href="/Vue/assets/js/55.f44277d0.js"><link rel="prefetch" href="/Vue/assets/js/56.9e836496.js"><link rel="prefetch" href="/Vue/assets/js/57.a7060cfa.js"><link rel="prefetch" href="/Vue/assets/js/58.5456c39a.js"><link rel="prefetch" href="/Vue/assets/js/59.3a2b2cea.js"><link rel="prefetch" href="/Vue/assets/js/6.f3d12b31.js"><link rel="prefetch" href="/Vue/assets/js/60.eb928d20.js"><link rel="prefetch" href="/Vue/assets/js/61.c1088d2f.js"><link rel="prefetch" href="/Vue/assets/js/62.218b1f1d.js"><link rel="prefetch" href="/Vue/assets/js/63.56adb0a3.js"><link rel="prefetch" href="/Vue/assets/js/64.842a8d1d.js"><link rel="prefetch" href="/Vue/assets/js/65.98d7a270.js"><link rel="prefetch" href="/Vue/assets/js/66.790ad0f2.js"><link rel="prefetch" href="/Vue/assets/js/67.f6effd5a.js"><link rel="prefetch" href="/Vue/assets/js/68.ca8c791c.js"><link rel="prefetch" href="/Vue/assets/js/69.da7fff1e.js"><link rel="prefetch" href="/Vue/assets/js/7.3e38d37d.js"><link rel="prefetch" href="/Vue/assets/js/70.26a7c3b0.js"><link rel="prefetch" href="/Vue/assets/js/71.1dd70f74.js"><link rel="prefetch" href="/Vue/assets/js/72.39679f64.js"><link rel="prefetch" href="/Vue/assets/js/73.40083b3a.js"><link rel="prefetch" href="/Vue/assets/js/74.b1ae5f8c.js"><link rel="prefetch" href="/Vue/assets/js/75.b45e9fa4.js"><link rel="prefetch" href="/Vue/assets/js/76.481e860c.js"><link rel="prefetch" href="/Vue/assets/js/77.526130d4.js"><link rel="prefetch" href="/Vue/assets/js/78.37c9e1a0.js"><link rel="prefetch" href="/Vue/assets/js/79.7d94e648.js"><link rel="prefetch" href="/Vue/assets/js/8.d3983478.js"><link rel="prefetch" href="/Vue/assets/js/80.785428df.js"><link rel="prefetch" href="/Vue/assets/js/81.107f320e.js"><link rel="prefetch" href="/Vue/assets/js/82.7520706d.js"><link rel="prefetch" href="/Vue/assets/js/83.e41657b3.js"><link rel="prefetch" href="/Vue/assets/js/84.140eb152.js"><link rel="prefetch" href="/Vue/assets/js/85.e8ca4166.js"><link rel="prefetch" href="/Vue/assets/js/86.cb2900cf.js"><link rel="prefetch" href="/Vue/assets/js/87.ff517a5f.js"><link rel="prefetch" href="/Vue/assets/js/88.adce3afb.js"><link rel="prefetch" href="/Vue/assets/js/89.bd97fe2f.js"><link rel="prefetch" href="/Vue/assets/js/9.06b0b5b8.js"><link rel="prefetch" href="/Vue/assets/js/90.19e9e85c.js"><link rel="prefetch" href="/Vue/assets/js/91.4331efbd.js"><link rel="prefetch" href="/Vue/assets/js/92.5001ecee.js"><link rel="prefetch" href="/Vue/assets/js/93.15ec5fef.js"><link rel="prefetch" href="/Vue/assets/js/94.f8c699ca.js"><link rel="prefetch" href="/Vue/assets/js/95.ff89b1f4.js"><link rel="prefetch" href="/Vue/assets/js/96.9b0780fa.js"><link rel="prefetch" href="/Vue/assets/js/97.e2092ef8.js"><link rel="prefetch" href="/Vue/assets/js/98.9e9ca302.js"><link rel="prefetch" href="/Vue/assets/js/99.badd2c8a.js">
    <link rel="stylesheet" href="/Vue/assets/css/0.styles.0779c551.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Vue/" class="home-link router-link-active"><img src="/Vue/img/logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Vue/" class="nav-link">ğŸ±é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ³å®¹å™¨" class="dropdown-title"><a href="/Vue/note/Kubernetes/" class="link-title">ğŸ³å®¹å™¨</a> <span class="title" style="display:none;">ğŸ³å®¹å™¨</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å®¹å™¨æ–‡ç« </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/pages/b23923/" class="nav-link">Containerd</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/note/Docker/" class="nav-link">ğŸ“’Dockerå®¹å™¨</a></li><li class="dropdown-subitem"><a href="/Vue/note/Containerd/" class="nav-link">ğŸ“’Containerdå®¹å™¨</a></li><li class="dropdown-subitem"><a href="/Vue/note/Kubernetes/" class="nav-link">ğŸ“’Kubernetes</a></li><li class="dropdown-subitem"><a href="/Vue/note/git/" class="nav-link">ğŸ“’Git</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ“’äº‘åŸç”Ÿ" class="dropdown-title"><a href="/Vue/devops/" class="link-title">ğŸ“’äº‘åŸç”Ÿ</a> <span class="title" style="display:none;">ğŸ“’äº‘åŸç”Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/CICD/" class="nav-link">Devops</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/Operator/" class="nav-link">Operator</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸŒæŠ€æœ¯" class="dropdown-title"><a href="/Vue/note/Traing/" class="link-title">ğŸŒæŠ€æœ¯</a> <span class="title" style="display:none;">ğŸŒæŠ€æœ¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/Traing/" class="nav-link">æŠ€èƒ½å¤§èµ›</a></li><li class="dropdown-item"><!----> <a href="/Vue/pages/4c778760be26d8b3/" class="nav-link">GitHubæŠ€å·§</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ–ï¸è€ƒè¯" class="dropdown-title"><a href="/Vue/note/kaozhen/" class="link-title">ğŸ–ï¸è€ƒè¯</a> <span class="title" style="display:none;">ğŸ–ï¸è€ƒè¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/kaozhen/" class="nav-link">1+Xäº‘è®¡ç®—é«˜çº§</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/kaozhen/" class="nav-link">CKA</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/Kubernetes/" class="nav-link">CKS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ‰æ›´å¤š" class="dropdown-title"><a href="/Vue/more/" class="link-title">ğŸ‰æ›´å¤š</a> <span class="title" style="display:none;">ğŸ‰æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/pages/f2a556/" class="nav-link">å­¦ä¹ </a></li><li class="dropdown-item"><!----> <a href="/Vue/pages/aea6571b7a8bae86/" class="nav-link">é¢è¯•</a></li></ul></div></div><div class="nav-item"><a href="/Vue/about/" class="nav-link">ğŸ”å…³äº</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ—¿æ”¶è—" class="dropdown-title"><a href="/Vue/pages/beb6c0bd8a66cea6/" class="link-title">ğŸ—¿æ”¶è—</a> <span class="title" style="display:none;">ğŸ—¿æ”¶è—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/pages/beb6c0bd8a66cea6/" class="nav-link">ç½‘ç«™</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/Vue/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/Vue/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/Vue/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/isicman/Vue" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/Vue/" class="nav-link">ğŸ±é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ³å®¹å™¨" class="dropdown-title"><a href="/Vue/note/Kubernetes/" class="link-title">ğŸ³å®¹å™¨</a> <span class="title" style="display:none;">ğŸ³å®¹å™¨</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å®¹å™¨æ–‡ç« </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/pages/b23923/" class="nav-link">Containerd</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/note/Docker/" class="nav-link">ğŸ“’Dockerå®¹å™¨</a></li><li class="dropdown-subitem"><a href="/Vue/note/Containerd/" class="nav-link">ğŸ“’Containerdå®¹å™¨</a></li><li class="dropdown-subitem"><a href="/Vue/note/Kubernetes/" class="nav-link">ğŸ“’Kubernetes</a></li><li class="dropdown-subitem"><a href="/Vue/note/git/" class="nav-link">ğŸ“’Git</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ“’äº‘åŸç”Ÿ" class="dropdown-title"><a href="/Vue/devops/" class="link-title">ğŸ“’äº‘åŸç”Ÿ</a> <span class="title" style="display:none;">ğŸ“’äº‘åŸç”Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/CICD/" class="nav-link">Devops</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/Operator/" class="nav-link">Operator</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸŒæŠ€æœ¯" class="dropdown-title"><a href="/Vue/note/Traing/" class="link-title">ğŸŒæŠ€æœ¯</a> <span class="title" style="display:none;">ğŸŒæŠ€æœ¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/Traing/" class="nav-link">æŠ€èƒ½å¤§èµ›</a></li><li class="dropdown-item"><!----> <a href="/Vue/pages/4c778760be26d8b3/" class="nav-link">GitHubæŠ€å·§</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ–ï¸è€ƒè¯" class="dropdown-title"><a href="/Vue/note/kaozhen/" class="link-title">ğŸ–ï¸è€ƒè¯</a> <span class="title" style="display:none;">ğŸ–ï¸è€ƒè¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/note/kaozhen/" class="nav-link">1+Xäº‘è®¡ç®—é«˜çº§</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/kaozhen/" class="nav-link">CKA</a></li><li class="dropdown-item"><!----> <a href="/Vue/note/Kubernetes/" class="nav-link">CKS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ‰æ›´å¤š" class="dropdown-title"><a href="/Vue/more/" class="link-title">ğŸ‰æ›´å¤š</a> <span class="title" style="display:none;">ğŸ‰æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/pages/f2a556/" class="nav-link">å­¦ä¹ </a></li><li class="dropdown-item"><!----> <a href="/Vue/pages/aea6571b7a8bae86/" class="nav-link">é¢è¯•</a></li></ul></div></div><div class="nav-item"><a href="/Vue/about/" class="nav-link">ğŸ”å…³äº</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ—¿æ”¶è—" class="dropdown-title"><a href="/Vue/pages/beb6c0bd8a66cea6/" class="link-title">ğŸ—¿æ”¶è—</a> <span class="title" style="display:none;">ğŸ—¿æ”¶è—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/pages/beb6c0bd8a66cea6/" class="nav-link">ç½‘ç«™</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/Vue/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/Vue/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/Vue/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/isicman/Vue" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>å­¦ä¹ ç¬”è®°</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Vue/pages/46159d/" class="sidebar-link">åˆè¯†Kubernetes</a></li><li><a href="/Vue/pages/ff772d/" class="sidebar-link">kubeadmå®‰è£…kubernetes</a></li><li><a href="/Vue/pages/9f3db7/" class="sidebar-link">Centos7åŸºäºContainerdéƒ¨ç½²Kubernetes v1.23.5</a></li><li><a href="/Vue/pages/e46184/" class="sidebar-link">Kubernetesçš„åŸºç¡€æ“ä½œ</a></li><li><a href="/Vue/pages/3ce2fd/" class="sidebar-link">Kubernetesç›‘æ§ä¸æ—¥å¿—ç®¡ç†</a></li><li><a href="/Vue/pages/3738ba/" class="sidebar-link">Kubernetesåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸç®¡ç†</a></li><li><a href="/Vue/pages/b5d485/" class="sidebar-link">Kubernetesè°ƒåº¦</a></li><li><a href="/Vue/pages/c7deaf/" class="sidebar-link">Kubernetesç½‘ç»œ</a></li><li><a href="/Vue/pages/ed6cb5/" class="sidebar-link">Kuberneteså­˜å‚¨</a></li><li><a href="/Vue/pages/de082c/" class="sidebar-link">Kuberneteså®‰å…¨</a></li><li><a href="/Vue/pages/256223/" class="sidebar-link">Kubernetesé›†ç¾¤ç»´æŠ¤</a></li><li><a href="/Vue/pages/24d932/" class="sidebar-link">Kubernetesæ•…éšœæ’æŸ¥</a></li><li><a href="/Vue/pages/d13a63/" class="sidebar-link">HelmåŒ…ç®¡ç†</a></li><li><a href="/Vue/pages/a2b2e9/" aria-current="page" class="active sidebar-link">Kubernetes é«˜çº§è¿ç»´</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#ä½¿ç”¨kubeadmè¿›è¡Œè¯ä¹¦ç®¡ç†" class="sidebar-link">ä½¿ç”¨kubeadmè¿›è¡Œè¯ä¹¦ç®¡ç†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#ä½¿ç”¨è‡ªå®šä¹‰çš„è¯ä¹¦" class="sidebar-link">ä½¿ç”¨è‡ªå®šä¹‰çš„è¯ä¹¦</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#å¤–éƒ¨-ca-æ¨¡å¼" class="sidebar-link">å¤–éƒ¨ CA æ¨¡å¼</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¿‡æœŸ" class="sidebar-link">æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¿‡æœŸ</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#è‡ªåŠ¨æ›´æ–°è¯ä¹¦" class="sidebar-link">è‡ªåŠ¨æ›´æ–°è¯ä¹¦</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#æ‰‹åŠ¨æ›´æ–°è¯ä¹¦" class="sidebar-link">æ‰‹åŠ¨æ›´æ–°è¯ä¹¦</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#è¯ä¹¦" class="sidebar-link">è¯ä¹¦</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#cfsslæ–¹å¼" class="sidebar-link">cfsslæ–¹å¼</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#easyrsaæ–¹å¼" class="sidebar-link">easyrsaæ–¹å¼</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#opensslæ–¹å¼" class="sidebar-link">opensslæ–¹å¼</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#å¥åº·æ£€æŸ¥" class="sidebar-link">å¥åº·æ£€æŸ¥</a></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#é…ç½®å­˜æ´»ã€å°±ç»ªå’Œå¯åŠ¨æ¢æµ‹å™¨" class="sidebar-link">é…ç½®å­˜æ´»ã€å°±ç»ªå’Œå¯åŠ¨æ¢æµ‹å™¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#å®šä¹‰å­˜æ´»å‘½ä»¤" class="sidebar-link">å®šä¹‰å­˜æ´»å‘½ä»¤</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#å®šä¹‰ä¸€ä¸ªå­˜æ´»æ€httpè¯·æ±‚æ¥å£" class="sidebar-link">å®šä¹‰ä¸€ä¸ªå­˜æ´»æ€HTTPè¯·æ±‚æ¥å£</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#å®šä¹‰httpè¯·æ±‚æ¥å£" class="sidebar-link">å®šä¹‰HTTPè¯·æ±‚æ¥å£</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#å®šä¹‰tcpçš„å­˜æ´»æ¢æµ‹" class="sidebar-link">å®šä¹‰TCPçš„å­˜æ´»æ¢æµ‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#å®šä¹‰tcpæ¢é’ˆ" class="sidebar-link">å®šä¹‰TCPæ¢é’ˆ</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#å®šä¹‰å°±ç»ªæ¢æµ‹å™¨" class="sidebar-link">å®šä¹‰å°±ç»ªæ¢æµ‹å™¨</a></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#é…ç½®æ¢æµ‹å™¨" class="sidebar-link">é…ç½®æ¢æµ‹å™¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/Vue/pages/a2b2e9/#probe-æœ‰å¾ˆå¤šé…ç½®å­—æ®µ-å¯ä»¥ä½¿ç”¨è¿™äº›å­—æ®µç²¾ç¡®çš„æ§åˆ¶å­˜æ´»å’Œå°±ç»ªæ£€æµ‹çš„è¡Œä¸º" class="sidebar-link">Probe æœ‰å¾ˆå¤šé…ç½®å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›å­—æ®µç²¾ç¡®çš„æ§åˆ¶å­˜æ´»å’Œå°±ç»ªæ£€æµ‹çš„è¡Œä¸ºï¼š</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#http-æ¢æµ‹" class="sidebar-link">HTTP æ¢æµ‹</a></li><li class="sidebar-sub-header level4"><a href="/Vue/pages/a2b2e9/#http-probes-å¯ä»¥åœ¨-httpget-ä¸Šé…ç½®é¢å¤–çš„å­—æ®µ" class="sidebar-link">HTTP Probes å¯ä»¥åœ¨ httpGet ä¸Šé…ç½®é¢å¤–çš„å­—æ®µï¼š</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#tcp-æ¢æµ‹" class="sidebar-link">TCP æ¢æµ‹</a></li><li class="sidebar-sub-header level4"><a href="/Vue/pages/a2b2e9/#æ¢æµ‹å™¨çº§åˆ«-terminationgraceperiodseconds" class="sidebar-link">æ¢æµ‹å™¨çº§åˆ« terminationGracePeriodSeconds</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#ä½¿ç”¨rbacé‰´æƒ" class="sidebar-link">ä½¿ç”¨RBACé‰´æƒ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#api-å¯¹è±¡" class="sidebar-link">API å¯¹è±¡</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#roleå’Œclusterrole" class="sidebar-link">Roleå’ŒClusterRole</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#roleçš„ç¤ºä¾‹" class="sidebar-link">Roleçš„ç¤ºä¾‹</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#clusterroleç¤ºä¾‹" class="sidebar-link">ClusterRoleç¤ºä¾‹</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#rolebindingå’Œclusterrolebinding" class="sidebar-link">RoleBindingå’ŒClusterRoleBinding</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#rolebinding-ç¤ºä¾‹" class="sidebar-link">RoleBinding ç¤ºä¾‹</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#clusterrolebindingç¤ºä¾‹" class="sidebar-link">ClusterRoleBindingç¤ºä¾‹</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#èšåˆçš„-clusterrole" class="sidebar-link">èšåˆçš„ ClusterRole</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#é¢å‘ç”¨æˆ·çš„è§’è‰²" class="sidebar-link">é¢å‘ç”¨æˆ·çš„è§’è‰²</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#podçš„å®‰å…¨ç­–ç•¥" class="sidebar-link">Podçš„å®‰å…¨ç­–ç•¥</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#ä»€ä¹ˆæ˜¯podå®‰å…¨ç­–ç•¥" class="sidebar-link">ä»€ä¹ˆæ˜¯Podå®‰å…¨ç­–ç•¥ï¼Ÿ</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#å¯ç”¨podå®‰å…¨ç­–ç•¥" class="sidebar-link">å¯ç”¨Podå®‰å…¨ç­–ç•¥</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#æˆæƒç­–ç•¥" class="sidebar-link">æˆæƒç­–ç•¥</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#é…ç½®" class="sidebar-link">é…ç½®</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#åˆ›å»ºä¸€ä¸ªç­–ç•¥å’Œä¸€ä¸ªpod" class="sidebar-link">åˆ›å»ºä¸€ä¸ªç­–ç•¥å’Œä¸€ä¸ªPod</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#å‘½åç©ºé—´ä¸‹podé…é¢" class="sidebar-link">å‘½åç©ºé—´ä¸‹Podé…é¢</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´" class="sidebar-link">åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#åˆ›å»ºresourcequota" class="sidebar-link">åˆ›å»ºResourceQuota</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#éªŒè¯è¯¥èµ„æºé™åˆ¶" class="sidebar-link">éªŒè¯è¯¥èµ„æºé™åˆ¶</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#æ¸…ç†" class="sidebar-link">æ¸…ç†</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/Vue/pages/a2b2e9/#é…ç½®apiå¯¹è±¡é…é¢" class="sidebar-link">é…ç½®APIå¯¹è±¡é…é¢</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#åˆ›å»ºå‘½åç©ºé—´" class="sidebar-link">åˆ›å»ºå‘½åç©ºé—´</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#åˆ›å»ºresourcequota-2" class="sidebar-link">åˆ›å»ºResourceQuota</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#åˆ›å»ºpersistentvolumeclaim" class="sidebar-link">åˆ›å»ºPersistentVolumeClaim</a></li><li class="sidebar-sub-header level3"><a href="/Vue/pages/a2b2e9/#å°è¯•åˆ›å»ºç¬¬äºŒä¸ªpersistentvolumeclaim" class="sidebar-link">å°è¯•åˆ›å»ºç¬¬äºŒä¸ªPersistentVolumeClaim</a></li></ul></li></ul></li><li><a href="/Vue/pages/79ca6c/" class="sidebar-link">NFSåšKubernetesçš„åç«¯å­˜å‚¨</a></li><li><a href="/Vue/pages/af5bae/" class="sidebar-link">GlusterFså¯¹æ¥K8S</a></li><li><a href="/Vue/pages/2e6a5b/" class="sidebar-link">Cephå¯¹æ¥K8Så­˜å‚¨ä½¿ç”¨RBD</a></li><li><a href="/Vue/pages/c741d8/" class="sidebar-link">Rookæ„å»ºCephäº‘åŸç”Ÿå­˜å‚¨</a></li><li><a href="/Vue/pages/a5e623/" class="sidebar-link">Kubectlå¤šé›†ç¾¤é…ç½®</a></li><li><a href="/Vue/pages/a19b63/" class="sidebar-link">ä¸ºç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹é¢„ç•™è®¡ç®—èµ„æº</a></li><li><a href="/Vue/pages/770b73/" class="sidebar-link">Kubernetesï¼ˆk8sï¼‰Helm v3 éƒ¨ç½² EFK æ—¥å¿—ç³»ç»Ÿ</a></li><li><a href="/Vue/pages/53253e/" class="sidebar-link">Kubernetes Python Client</a></li><li><a href="/Vue/pages/e7f866/" class="sidebar-link">Kubernetes kubectlå‘½ä»¤</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CKSè®¤è¯</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-5add8e0a><div class="articleInfo" data-v-5add8e0a><ul class="breadcrumbs" data-v-5add8e0a><li data-v-5add8e0a><a href="/Vue/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-5add8e0a></a></li> <li data-v-5add8e0a><a href="/Vue/note/Kubernetes/#ã€ŠKubernetesã€‹å­¦ä¹ ç¬”è®°" data-v-5add8e0a>ã€ŠKubernetesã€‹å­¦ä¹ ç¬”è®°</a></li><li data-v-5add8e0a><a href="/Vue/note/Kubernetes/#å­¦ä¹ ç¬”è®°" data-v-5add8e0a>å­¦ä¹ ç¬”è®°</a></li></ul> <div class="info" data-v-5add8e0a><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-5add8e0a><a href="https://github.com/2756864799zhang" target="_blank" title="ä½œè€…" class="beLink" data-v-5add8e0a>Vuens</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-5add8e0a><a href="javascript:;" data-v-5add8e0a>2022-01-22</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Kubernetes é«˜çº§è¿ç»´<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="kubernetesé«˜çº§è¿ç»´"><a href="#kubernetesé«˜çº§è¿ç»´" class="header-anchor">#</a> Kubernetesé«˜çº§è¿ç»´</h1> <h2 id="ä½¿ç”¨kubeadmè¿›è¡Œè¯ä¹¦ç®¡ç†"><a href="#ä½¿ç”¨kubeadmè¿›è¡Œè¯ä¹¦ç®¡ç†" class="header-anchor">#</a> ä½¿ç”¨kubeadmè¿›è¡Œè¯ä¹¦ç®¡ç†</h2> <p>ç”± <a href="https://kubernetes.io/zh/docs/reference/setup-tools/kubeadm/" target="_blank" rel="noopener noreferrer">kubeadm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç”Ÿæˆçš„å®¢æˆ·ç«¯è¯ä¹¦åœ¨ 1 å¹´ååˆ°æœŸã€‚ æœ¬é¡µè¯´æ˜å¦‚ä½•ä½¿ç”¨ kubeadm ç®¡ç†è¯ä¹¦ç»­è®¢ã€‚</p> <h3 id="ä½¿ç”¨è‡ªå®šä¹‰çš„è¯ä¹¦"><a href="#ä½¿ç”¨è‡ªå®šä¹‰çš„è¯ä¹¦" class="header-anchor">#</a> ä½¿ç”¨è‡ªå®šä¹‰çš„è¯ä¹¦</h3> <ul><li>é»˜è®¤æƒ…å†µä¸‹, kubeadm ä¼šç”Ÿæˆè¿è¡Œä¸€ä¸ªé›†ç¾¤æ‰€éœ€çš„å…¨éƒ¨è¯ä¹¦ã€‚ ä½ å¯ä»¥é€šè¿‡æä¾›ä½ è‡ªå·±çš„è¯ä¹¦æ¥æ”¹å˜è¿™ä¸ªè¡Œä¸ºç­–ç•¥ã€‚</li> <li>å¦‚æœè¦è¿™æ ·åš, ä½ å¿…é¡»å°†è¯ä¹¦æ–‡ä»¶æ”¾ç½®åœ¨é€šè¿‡ <code>--cert-dir</code> å‘½ä»¤è¡Œå‚æ•°æˆ–è€… kubeadm é…ç½®ä¸­çš„ <code>CertificatesDir</code> é…ç½®é¡¹æŒ‡æ˜çš„ç›®å½•ä¸­ã€‚é»˜è®¤çš„å€¼æ˜¯ <code>/etc/kubernetes/pki</code>ã€‚</li> <li>å¦‚æœåœ¨è¿è¡Œ <code>kubeadm init</code> ä¹‹å‰å­˜åœ¨ç»™å®šçš„è¯ä¹¦å’Œç§é’¥å¯¹ï¼Œkubeadm å°†ä¸ä¼šé‡å†™å®ƒä»¬ã€‚ ä¾‹å¦‚ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥å°†ç°æœ‰çš„ CA å¤åˆ¶åˆ° <code>/etc/kubernetes/pki/ca.crt</code> å’Œ <code>/etc/kubernetes/pki/ca.key</code> ä¸­ï¼Œè€Œ kubeadm å°†ä½¿ç”¨æ­¤ CA å¯¹å…¶ä½™è¯ä¹¦è¿›è¡Œç­¾åã€‚</li></ul> <h3 id="å¤–éƒ¨-ca-æ¨¡å¼"><a href="#å¤–éƒ¨-ca-æ¨¡å¼" class="header-anchor">#</a> å¤–éƒ¨ CA æ¨¡å¼</h3> <ul><li>åªæä¾›äº† <code>ca.crt</code> æ–‡ä»¶ä½†æ˜¯ä¸æä¾› <code>ca.key</code> æ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥çš„ ï¼ˆè¿™åªå¯¹ CA æ ¹è¯ä¹¦å¯ç”¨ï¼Œå…¶å®ƒè¯ä¹¦ä¸å¯ç”¨ï¼‰ã€‚ å¦‚æœæ‰€æœ‰çš„å…¶å®ƒè¯ä¹¦å’Œ kubeconfig æ–‡ä»¶å·²å°±ç»ªï¼Œkubeadm æ£€æµ‹åˆ°æ»¡è¶³ä»¥ä¸Šæ¡ä»¶å°±ä¼šæ¿€æ´» &quot;å¤–éƒ¨ CA&quot; æ¨¡å¼ã€‚kubeadm å°†ä¼šåœ¨æ²¡æœ‰ CA å¯†é’¥æ–‡ä»¶çš„æƒ…å†µä¸‹ç»§ç»­æ‰§è¡Œã€‚</li> <li>å¦åˆ™, kubeadm å°†ç‹¬ç«‹è¿è¡Œ controller-managerï¼Œé™„åŠ ä¸€ä¸ª <code>--controllers=csrsigner</code> çš„å‚æ•°ï¼Œå¹¶ä¸”æŒ‡æ˜ CA è¯ä¹¦å’Œå¯†é’¥ã€‚</li> <li><a href="https://kubernetes.io/zh/docs/setup/best-practices/certificates/" target="_blank" rel="noopener noreferrer">PKI è¯ä¹¦å’Œè¦æ±‚<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>åŒ…æ‹¬é›†ç¾¤ä½¿ç”¨å¤–éƒ¨ CA çš„è®¾ç½®æŒ‡å—ã€‚</li></ul> <h3 id="æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¿‡æœŸ"><a href="#æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¿‡æœŸ" class="header-anchor">#</a> æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¿‡æœŸ</h3> <ul><li>ä½ å¯ä»¥ä½¿ç”¨ <code>check-expiration</code> å­å‘½ä»¤æ¥æ£€æŸ¥è¯ä¹¦ä½•æ—¶è¿‡æœŸ</li> <li>è¯¥å‘½ä»¤æ˜¾ç¤º <code>/etc/kubernetes/pki</code> æ–‡ä»¶å¤¹ä¸­çš„å®¢æˆ·ç«¯è¯ä¹¦ä»¥åŠ kubeadmï¼ˆ<code>admin.conf</code>, <code>controller-manager.conf</code> å’Œ <code>scheduler.conf</code>ï¼‰ ä½¿ç”¨çš„ KUBECONFIG æ–‡ä»¶ä¸­åµŒå…¥çš„å®¢æˆ·ç«¯è¯ä¹¦çš„åˆ°æœŸæ—¶é—´/å‰©ä½™æ—¶é—´ã€‚</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubeadm certs check-expiration</span>
<span class="token punctuation">[</span>check-expiration<span class="token punctuation">]</span> Reading configuration from the cluster<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>check-expiration<span class="token punctuation">]</span> FYI: You can <span class="token function">look</span> at this config <span class="token function">file</span> with <span class="token string">'kubectl -n kube-system get cm kubeadm-config -o yaml'</span>

CERTIFICATE                EXPIRES                  RESIDUAL TIME   CERTIFICATE AUTHORITY   EXTERNALLY MANAGED
admin.conf                 Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d                                    no      
apiserver                  Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d            ca                      no      
apiserver-etcd-client      Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d            etcd-ca                 no      
apiserver-kubelet-client   Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d            ca                      no      
controller-manager.conf    Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d                                    no      
etcd-healthcheck-client    Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d            etcd-ca                 no      
etcd-peer                  Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d            etcd-ca                 no      
etcd-server                Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d            etcd-ca                 no      
front-proxy-client         Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d            front-proxy-ca          no      
scheduler.conf             Nov <span class="token number">23</span>, <span class="token number">2022</span> <span class="token number">18</span>:55 UTC   363d                                    no      

CERTIFICATE AUTHORITY   EXPIRES                  RESIDUAL TIME   EXTERNALLY MANAGED
ca                      Nov <span class="token number">21</span>, <span class="token number">2031</span> <span class="token number">18</span>:55 UTC   9y              no      
etcd-ca                 Nov <span class="token number">21</span>, <span class="token number">2031</span> <span class="token number">18</span>:55 UTC   9y              no      
front-proxy-ca          Nov <span class="token number">21</span>, <span class="token number">2031</span> <span class="token number">18</span>:55 UTC   9y              no      
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="è‡ªåŠ¨æ›´æ–°è¯ä¹¦"><a href="#è‡ªåŠ¨æ›´æ–°è¯ä¹¦" class="header-anchor">#</a> è‡ªåŠ¨æ›´æ–°è¯ä¹¦</h3> <ul><li><code>kubeadm</code> ä¼šåœ¨æ§åˆ¶é¢ <a href="https://kubernetes.io/zh/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/" target="_blank" rel="noopener noreferrer">å‡çº§<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> çš„æ—¶å€™æ›´æ–°æ‰€æœ‰è¯ä¹¦ã€‚</li> <li>è¿™ä¸ªåŠŸèƒ½æ—¨åœ¨è§£å†³æœ€ç®€å•çš„ç”¨ä¾‹ï¼›å¦‚æœä½ å¯¹æ­¤ç±»è¯ä¹¦çš„æ›´æ–°æ²¡æœ‰ç‰¹æ®Šè¦æ±‚ï¼Œå¹¶ä¸”å®šæœŸæ‰§è¡ŒKubernetesç‰ˆæœ¬å‡çº§ï¼ˆæ¯æ¬¡å‡çº§ä¹‹é—´çš„é—´éš”æ—¶é—´å°‘äº1å¹´ï¼‰ï¼Œkubeadmå°†ç¡®ä¿ä½ çš„é›†ç¾¤ä¿æŒæœ€æ–°çŠ¶æ€å¹¶ä¿æŒåˆç†çš„å®‰å…¨æ€§ã€‚</li> <li><strong>è¯´æ˜ï¼š</strong> æœ€ä½³çš„åšæ³•æ˜¯ç»å¸¸å‡çº§é›†ç¾¤ä»¥ç¡®ä¿å®‰å…¨ã€‚</li> <li>å¦‚æœä½ å¯¹è¯ä¹¦æ›´æ–°æœ‰æ›´å¤æ‚çš„éœ€æ±‚ï¼Œåˆ™å¯é€šè¿‡å°† <code>--certificate-renewal=false</code> ä¼ é€’ç»™ <code>kubeadm upgrade apply</code> æˆ–è€… <code>kubeadm upgrade node</code>ï¼Œä»è€Œé€‰æ‹©ä¸é‡‡ç”¨é»˜è®¤è¡Œä¸ºã€‚</li></ul> <h3 id="æ‰‹åŠ¨æ›´æ–°è¯ä¹¦"><a href="#æ‰‹åŠ¨æ›´æ–°è¯ä¹¦" class="header-anchor">#</a> æ‰‹åŠ¨æ›´æ–°è¯ä¹¦</h3> <ul><li><p>ä½ èƒ½éšæ—¶é€šè¿‡ <code>kubeadm certs renew</code> å‘½ä»¤æ‰‹åŠ¨æ›´æ–°ä½ çš„è¯ä¹¦ã€‚</p></li> <li><p>æ­¤å‘½ä»¤ç”¨ CA ï¼ˆæˆ–è€… front-proxy-CA ï¼‰è¯ä¹¦å’Œå­˜å‚¨åœ¨ <code>/etc/kubernetes/pki</code> ä¸­çš„å¯†é’¥æ‰§è¡Œæ›´æ–°ã€‚</p></li> <li><p>æ‰§è¡Œå®Œæ­¤å‘½ä»¤ä¹‹åä½ éœ€è¦é‡å¯æ§åˆ¶é¢ Podsã€‚å› ä¸ºåŠ¨æ€è¯ä¹¦é‡è½½ç›®å‰è¿˜ä¸è¢«æ‰€æœ‰ç»„ä»¶å’Œè¯ä¹¦æ”¯æŒï¼Œæ‰€æœ‰è¿™é¡¹æ“ä½œæ˜¯å¿…é¡»çš„ã€‚ <a href="https://kubernetes.io/zh/docs/tasks/configure-pod-container/static-pod/" target="_blank" rel="noopener noreferrer">é™æ€ Pods<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ˜¯è¢«æœ¬åœ° kubelet è€Œä¸æ˜¯ API Server ç®¡ç†ï¼Œ æ‰€ä»¥ kubectl ä¸èƒ½ç”¨æ¥åˆ é™¤æˆ–é‡å¯ä»–ä»¬ã€‚ è¦é‡å¯é™æ€ Pod ä½ å¯ä»¥ä¸´æ—¶å°†æ¸…å•æ–‡ä»¶ä» <code>/etc/kubernetes/manifests/</code> ç§»é™¤å¹¶ç­‰å¾… 20 ç§’ ï¼ˆå‚è€ƒ <a href="https://kubernetes.io/docs/reference/config-api/kubelet-config.v1beta1/" target="_blank" rel="noopener noreferrer">KubeletConfiguration ç»“æ„<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸­çš„<code>fileCheckFrequency</code> å€¼ï¼‰ã€‚ å¦‚æœ Pod ä¸åœ¨æ¸…å•ç›®å½•é‡Œï¼Œkubeletå°†ä¼šç»ˆæ­¢å®ƒã€‚ åœ¨å¦ä¸€ä¸ª <code>fileCheckFrequency</code> å‘¨æœŸä¹‹åä½ å¯ä»¥å°†æ–‡ä»¶ç§»å›å»ï¼Œä¸ºäº†ç»„ä»¶å¯ä»¥å®Œæˆ kubelet å°†é‡æ–°åˆ›å»º Pod å’Œè¯ä¹¦æ›´æ–°ã€‚</p></li> <li><p><strong>è­¦å‘Šï¼š</strong> å¦‚æœä½ è¿è¡Œäº†ä¸€ä¸ª HA é›†ç¾¤ï¼Œè¿™ä¸ªå‘½ä»¤éœ€è¦åœ¨æ‰€æœ‰æ§åˆ¶é¢æ¿èŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚</p></li> <li><p><strong>è¯´æ˜ï¼š</strong> <code>certs renew</code> ä½¿ç”¨ç°æœ‰çš„è¯ä¹¦ä½œä¸ºå±æ€§ (Common Nameã€Organizationã€SAN ç­‰) çš„æƒå¨æ¥æºï¼Œ è€Œä¸æ˜¯ kubeadm-config ConfigMap ã€‚å¼ºçƒˆå»ºè®®ä½¿å®ƒä»¬ä¿æŒåŒæ­¥ã€‚</p></li> <li><p><code>kubeadm certs renew</code>æä¾›ä»¥ä¸‹é€‰é¡¹ï¼š</p> <ul><li><p>Kubernetes è¯ä¹¦é€šå¸¸åœ¨ä¸€å¹´ååˆ°æœŸã€‚</p></li> <li><p><code>--csr-only</code> å¯ç”¨äºç»è¿‡ä¸€ä¸ªå¤–éƒ¨ CA ç”Ÿæˆçš„è¯ä¹¦ç­¾åè¯·æ±‚æ¥æ›´æ–°è¯ä¹¦ï¼ˆæ— éœ€å®é™…æ›¿æ¢æ›´æ–°è¯ä¹¦ï¼‰ã€‚</p></li> <li><p>å¯ä»¥æ›´æ–°å•ä¸ªè¯ä¹¦è€Œä¸æ˜¯å…¨éƒ¨è¯ä¹¦ã€‚</p></li></ul></li></ul> <h2 id="è¯ä¹¦"><a href="#è¯ä¹¦" class="header-anchor">#</a> è¯ä¹¦</h2> <p>åœ¨ä½¿ç”¨å®¢æˆ·ç«¯è¯ä¹¦è®¤è¯çš„åœºæ™¯ä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡ <code>easyrsa</code>ã€<code>openssl</code> æˆ– <code>cfssl</code> ç­‰å·¥å…·ä»¥æ‰‹å·¥æ–¹å¼ç”Ÿæˆè¯ä¹¦ã€‚</p> <h3 id="cfsslæ–¹å¼"><a href="#cfsslæ–¹å¼" class="header-anchor">#</a> cfsslæ–¹å¼</h3> <ul><li><strong>cfsslä¸‹è½½åœ°å€</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">VERSION</span><span class="token operator">=</span>R1.2
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{</span>cfssl,cfssljson,cfssl-certinfo<span class="token punctuation">}</span>
<span class="token keyword">do</span>
<span class="token function">wget</span> https://pkg.cfssl.org/<span class="token variable">${VERSION}</span>/<span class="token variable">${i}</span>_linux-amd64 -O /usr/local/bin/<span class="token variable">${i}</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong>ç”ŸæˆCAé…ç½®æ–‡ä»¶</strong></li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code>mkdir ssl &amp;&amp; cd ssl
cfssl print-defaults config &gt; config.json
cfssl print-defaults csr &gt; csr.json
cat &gt; ca-config.json &lt;&lt;EOF
<span class="token punctuation">{</span>
  <span class="token property">&quot;signing&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;default&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;expiry&quot;</span><span class="token operator">:</span> <span class="token string">&quot;87600h&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;profiles&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;kubernetes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;usages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;signing&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;key encipherment&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;server auth&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;client auth&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;expiry&quot;</span><span class="token operator">:</span> <span class="token string">&quot;87600h&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
EOF
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ul><li><strong>ç”ŸæˆCAç­¾åé…ç½®æ–‡ä»¶</strong></li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code>cat &gt; ca-csr.json &lt;&lt; EOF
<span class="token punctuation">{</span>
  <span class="token property">&quot;CN&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kubernetes&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;algo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rsa&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">2048</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;names&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token property">&quot;C&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ST&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Beijing&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;L&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;O&quot;</span><span class="token operator">:</span> <span class="token string">&quot;k8s&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;OU&quot;</span><span class="token operator">:</span> <span class="token string">&quot;System&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
EOF
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li><strong>ç”Ÿæˆç§é’¥å’Œè¯ä¹¦</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>cfssl gencert -initca ca-csr.json <span class="token operator">|</span> cfssljson -bare ca
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>åˆ›å»ºä¸€ä¸ªç”¨äºç”ŸæˆAPI Serverçš„å¯†é’¥å’Œè¯ä¹¦çš„JSONé…ç½®æ–‡ä»¶</strong></li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code>cat &gt; kubernetes-csr.json &lt;&lt;EOF
<span class="token punctuation">{</span>
  <span class="token property">&quot;CN&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kubernetes&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hosts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;&lt;MASTER_IP&gt;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;&lt;MASTER_CLUSTER_IP&gt;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;kubernetes&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;kubernetes.default&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;kubernetes.default.svc&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;kubernetes.default.svc.cluster&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;kubernetes.default.svc.cluster.local&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;algo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rsa&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">2048</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;names&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token property">&quot;C&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ST&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Beijing&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;L&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;O&quot;</span><span class="token operator">:</span> <span class="token string">&quot;k8s&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;OU&quot;</span><span class="token operator">:</span> <span class="token string">&quot;System&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span> 
EOF
#è¯¥æ–‡ä»¶éœ€è¦åŒ…å«æ‰€æœ‰ä½¿ç”¨è¯¥è¯ä¹¦çš„ipå’ŒåŸŸååˆ—è¡¨ï¼ŒåŒ…æ‹¬etcdé›†ç¾¤ã€kubernetes masteré›†ç¾¤ã€ä»¥åŠapiserver é›†ç¾¤å†…éƒ¨cluster ipã€‚
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li><strong>ç”Ÿæˆ kubernetes è¯ä¹¦å’Œç§é’¥</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>cfssl gencert -ca<span class="token operator">=</span>ca.pem -ca-key<span class="token operator">=</span>ca-key.pem -config<span class="token operator">=</span>ca-config.json -profile<span class="token operator">=</span>kubernetes kubernetes-csr.json <span class="token operator">|</span> cfssljson -bare kubernetes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><h6 id="åˆ›å»ºadminè¯ä¹¦"><a href="#åˆ›å»ºadminè¯ä¹¦" class="header-anchor">#</a> åˆ›å»ºadminè¯ä¹¦</h6></li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code>cat &gt; admin-csr.json &lt;&lt;EOF
<span class="token punctuation">{</span>
  <span class="token property">&quot;CN&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hosts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;algo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rsa&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">2048</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;names&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;C&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;ST&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;L&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;O&quot;</span><span class="token operator">:</span> <span class="token string">&quot;system:masters&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;OU&quot;</span><span class="token operator">:</span> <span class="token string">&quot;System&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
EOF

cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes admin-csr.json | cfssljson -bare admin
# è¯ä¹¦Oé…ç½®ä¸ºsystem<span class="token operator">:</span>masters åœ¨é›†ç¾¤å†…éƒ¨cluster-adminçš„clusterrolebindingå°†system<span class="token operator">:</span>mastersç»„å’Œcluster-admin clusterroleç»‘å®šåœ¨ä¸€èµ·
Copy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ul><li><h6 id="åˆ›å»ºkube-proxyè¯ä¹¦"><a href="#åˆ›å»ºkube-proxyè¯ä¹¦" class="header-anchor">#</a> åˆ›å»ºkube-proxyè¯ä¹¦</h6></li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code>cat &gt; kube-proxy-csr.json &lt;&lt; EOF
<span class="token punctuation">{</span>
  <span class="token property">&quot;CN&quot;</span><span class="token operator">:</span> <span class="token string">&quot;system:kube-proxy&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hosts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;algo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rsa&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">2048</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;names&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;C&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;ST&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;L&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;O&quot;</span><span class="token operator">:</span> <span class="token string">&quot;k8s&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;OU&quot;</span><span class="token operator">:</span> <span class="token string">&quot;System&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
EOF
cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes  kube-proxy-csr.json | cfssljson -bare kube-proxy
# è¯¥è¯ä¹¦ç”¨æˆ·åä¸ºsystem<span class="token operator">:</span>kube-proxyï¼Œé¢„å®šä¹‰çš„system<span class="token operator">:</span>node-proxier clusterrolebindingså°† system<span class="token operator">:</span>kube-proxyç”¨æˆ·å’Œsystem<span class="token operator">:</span>node-proxierè§’è‰²ç»‘å®šåœ¨ä¸€èµ·
Copy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ul><li><h6 id="æ ¡éªŒè¯ä¹¦ä¿¡æ¯"><a href="#æ ¡éªŒè¯ä¹¦ä¿¡æ¯" class="header-anchor">#</a> æ ¡éªŒè¯ä¹¦ä¿¡æ¯</h6></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>cfssl-certinfo -cert kubernetes.pem
openssl x509  -noout -text -in  kubernetes.pem
Copy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><h6 id="æ‹·è´è¯ä¹¦"><a href="#æ‹·è´è¯ä¹¦" class="header-anchor">#</a> æ‹·è´è¯ä¹¦</h6></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> -p /etc/kubernetes/ssl/ <span class="token operator">&amp;&amp;</span> <span class="token function">cp</span> *.pem /etc/kubernetes/ssl/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="easyrsaæ–¹å¼"><a href="#easyrsaæ–¹å¼" class="header-anchor">#</a> easyrsaæ–¹å¼</h3> <p><strong>easyrsa</strong> æ”¯æŒä»¥æ‰‹å·¥æ–¹å¼ä¸ºä½ çš„é›†ç¾¤ç”Ÿæˆè¯ä¹¦ã€‚</p> <ul><li><strong><code>ä¸‹è½½ã€è§£å‹ã€åˆå§‹åŒ–æ‰“è¿‡è¡¥ä¸çš„ easyrsa3ã€‚</code></strong></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master pod]# curl -O http://172.25.253.144/file/tranning/easy-rsa.tar.gz
[root@master pod]# tar xzf easy-rsa.tar.gz
[root@master pod]# cd easy-rsa-master/easyrsa3
[root@master easyrsa3]# ./easyrsa init-pki
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><strong>ç”Ÿæˆæ–°çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ã€‚å‚æ•° <code>--batch</code> ç”¨äºè®¾ç½®è‡ªåŠ¨æ¨¡å¼ï¼› å‚æ•° <code>--req-cn</code> ç”¨äºè®¾ç½®æ–°çš„æ ¹è¯ä¹¦çš„é€šç”¨åç§°ï¼ˆCNï¼‰ã€‚</strong></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master easyrsa3]# ./easyrsa --batch &quot;--req-cn=172.25.253.3@`date +%s`&quot; build-ca nopass
Generating a 2048 bit RSA private key
...+++
..........+++
writing new private key to '/root/pod/easy-rsa-master/easyrsa3/pki/private/ca.key'
-----
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><strong>ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦å’Œç§˜é’¥ã€‚ å‚æ•° <code>--subject-alt-name</code> è®¾ç½®APIæœåŠ¡å™¨çš„IPå’Œ DNS åç§°ã€‚ <code>MASTER_CLUSTER_IP</code> ç”¨äº API æœåŠ¡å™¨å’Œæ§åˆ¶ç®¡ç†å™¨ï¼Œé€šå¸¸å– CIDR çš„ç¬¬ä¸€ä¸ª IPï¼Œç”± <code>--service-cluster-ip-range</code> çš„å‚æ•°æä¾›ã€‚ å‚æ•° <code>--days</code> ç”¨äºè®¾ç½®è¯ä¹¦çš„è¿‡æœŸæ—¶é—´ã€‚ ä¸‹é¢çš„ç¤ºä¾‹å‡å®šä½ çš„é»˜è®¤ DNS åŸŸåä¸º <code>cluster.local</code>ã€‚</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master easyrsa3<span class="token punctuation">]</span><span class="token comment"># ./easyrsa --subject-alt-name=&quot;IP:172.25.253.3,&quot;\</span>
<span class="token operator">&gt;</span> <span class="token string">&quot;IP:10.96.0.1,&quot;</span><span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token string">&quot;DNS:kubernetes,&quot;</span><span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token string">&quot;DNS:kubernetes.default,&quot;</span><span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token string">&quot;DNS:kubernetes.default.svc,&quot;</span><span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token string">&quot;DNS:kubernetes.default.svc.cluster,&quot;</span><span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token string">&quot;DNS:kubernetes.default.svc.cluster.local&quot;</span> <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> --days<span class="token operator">=</span><span class="token number">10000</span> <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> build-server-full server nopass

Generating a <span class="token number">2048</span> bit RSA private key
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.+++
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.+++
writing new private key to <span class="token string">'/root/pod/easy-rsa-master/easyrsa3/pki/private/server.key'</span>
-----
Using configuration from /root/pod/easy-rsa-master/easyrsa3/openssl-1.0.cnf   <span class="token comment">#è¿™é‡Œæœ‰å‘Šè¯‰ä½ çš„è¯ä¹¦è·¯å¾„</span>
Check that the request matches the signature
Signature ok
The Subject<span class="token string">'s Distinguished Name is as follows
commonName            :ASN.1 12:'</span>server'
Certificate is to be certified <span class="token keyword">until</span> Apr <span class="token number">11</span> <span class="token number">20</span>:46:17 <span class="token number">2049</span> GMT <span class="token punctuation">(</span><span class="token number">10000</span> days<span class="token punctuation">)</span>

Write out database with <span class="token number">1</span> new entries
Data Base Updated
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li><strong>æ‹·è´æ–‡ä»¶ <code>pki/ca.crt</code>ã€<code>pki/issued/server.crt</code> å’Œ <code>pki/private/server.key</code> åˆ°ä½ çš„ç›®å½•ä¸­ã€‚</strong></li> <li><strong>åœ¨ API æœåŠ¡å™¨çš„å¯åŠ¨å‚æ•°ä¸­æ·»åŠ ä»¥ä¸‹å‚æ•°ï¼š</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>--client-ca-file<span class="token operator">=</span>/yourdirectory/ca.crt
--tls-cert-file<span class="token operator">=</span>/yourdirectory/server.crt
--tls-private-key-file<span class="token operator">=</span>/yourdirectory/server.key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>adminè¯ä¹¦</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl genrsa -out admin.key 2048</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl req -new -key admin.key -out admin.csr -subj &quot;/O=system:masters/CN=dmin&quot;</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl x509 -req -set_serial $(date +%s%N) -in admin.csr -CA ca.crt -CAkey ca.key -out admin.crt -days 365 -extensions v3_req -extfile req.conf</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="opensslæ–¹å¼"><a href="#opensslæ–¹å¼" class="header-anchor">#</a> opensslæ–¹å¼</h3> <p><strong>openssl</strong> æ”¯æŒä»¥æ‰‹å·¥æ–¹å¼ä¸ºä½ çš„é›†ç¾¤ç”Ÿæˆè¯ä¹¦ã€‚</p> <ul><li><strong>ç”Ÿæˆä¸€ä¸ª 2048 ä½çš„ ca.key æ–‡ä»¶</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl genrsa -out ca.key 2048</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>åœ¨ca.keyæ–‡ä»¶çš„åŸºç¡€ä¸Šï¼Œç”Ÿæˆca.crtæ–‡ä»¶ï¼ˆç”¨å‚æ•° -days è®¾ç½®è¯ä¹¦æœ‰æ•ˆæœŸï¼‰</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl req -x509 -new -nodes -key ca.key -subj &quot;/CN=${MASTER_IP}&quot; -days 10000 -out ca.crt </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>ç”Ÿæˆä¸€ä¸ª2048ä½çš„server.keyæ–‡ä»¶ï¼š</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl genrsa -out server.key 2048</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>åˆ›å»ºä¸€ä¸ªç”¨äºç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆCSRï¼‰çš„é…ç½®æ–‡ä»¶ã€‚ ä¿å­˜æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼š<code>csr.conf</code>ï¼‰å‰ï¼Œè®°å¾—ç”¨çœŸå®å€¼æ›¿æ¢æ‰å°–æ‹¬å·ä¸­çš„å€¼ï¼ˆä¾‹å¦‚ï¼š<code>&lt;MASTER_IP&gt;</code>ï¼‰ã€‚ æ³¨æ„ï¼š<code>MASTER_CLUSTER_IP</code> å°±åƒå‰ä¸€å°èŠ‚æ‰€è¿°ï¼Œå®ƒçš„å€¼æ˜¯ API æœåŠ¡å™¨çš„æœåŠ¡é›†ç¾¤ IPã€‚ ä¸‹é¢çš„ä¾‹å­å‡å®šä½ çš„é»˜è®¤ DNS åŸŸåä¸º <code>cluster.local</code>ã€‚</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat csr.conf </span>

<span class="token punctuation">[</span> req <span class="token punctuation">]</span>
default_bits <span class="token operator">=</span> <span class="token number">2048</span>
prompt <span class="token operator">=</span> no
default_md <span class="token operator">=</span> sha256
req_extensions <span class="token operator">=</span> req_ext
distinguished_name <span class="token operator">=</span> dn

<span class="token punctuation">[</span> dn <span class="token punctuation">]</span>
C <span class="token operator">=</span> <span class="token operator">&lt;</span>country<span class="token operator">&gt;</span>
ST <span class="token operator">=</span> <span class="token operator">&lt;</span>state<span class="token operator">&gt;</span>
L <span class="token operator">=</span> <span class="token operator">&lt;</span>city<span class="token operator">&gt;</span>
O <span class="token operator">=</span> <span class="token operator">&lt;</span>organization<span class="token operator">&gt;</span>
OU <span class="token operator">=</span> <span class="token operator">&lt;</span>organization unit<span class="token operator">&gt;</span>
CN <span class="token operator">=</span> <span class="token number">172.25</span>.253.3

<span class="token punctuation">[</span> req_ext <span class="token punctuation">]</span>
subjectAltName <span class="token operator">=</span> @alt_names

<span class="token punctuation">[</span> alt_names <span class="token punctuation">]</span>
DNS.1 <span class="token operator">=</span> kubernetes
DNS.2 <span class="token operator">=</span> kubernetes.default
DNS.3 <span class="token operator">=</span> kubernetes.default.svc
DNS.4 <span class="token operator">=</span> kubernetes.default.svc.cluster
DNS.5 <span class="token operator">=</span> kubernetes.default.svc.cluster.local
IP.1 <span class="token operator">=</span> <span class="token number">172.25</span>.253.3
IP.2 <span class="token operator">=</span> <span class="token number">10.96</span>.0.1

<span class="token punctuation">[</span> v3_ext <span class="token punctuation">]</span>
<span class="token assign-left variable">authorityKeyIdentifier</span><span class="token operator">=</span>keyid,issuer:always
<span class="token assign-left variable">basicConstraints</span><span class="token operator">=</span>CA:FALSE
<span class="token assign-left variable">keyUsage</span><span class="token operator">=</span>keyEncipherment,dataEncipherment
<span class="token assign-left variable">extendedKeyUsage</span><span class="token operator">=</span>serverAuth,clientAuth
<span class="token assign-left variable">subjectAltName</span><span class="token operator">=</span>@alt_names
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><ul><li><strong>åŸºäºä¸Šé¢çš„é…ç½®æ–‡ä»¶ç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚ï¼š</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl req -new -key server.key -out server.csr -config csr.conf</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>åŸºäº ca.keyã€ca.key å’Œ server.csr ç­‰ä¸‰ä¸ªæ–‡ä»¶ç”ŸæˆæœåŠ¡ç«¯è¯ä¹¦ï¼š</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key \</span>
-CAcreateserial -out server.crt -days <span class="token number">10000</span> <span class="token punctuation">\</span>
-extensions v3_ext -extfile csr.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>æŸ¥çœ‹è¯ä¹¦ç­¾åè¯·æ±‚ï¼š</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl req  -noout -text -in ./server.csr</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>æŸ¥çœ‹è¯ä¹¦ï¼š</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl x509  -noout -text -in ./server.crt</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>adminè¯ä¹¦</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl genrsa -out admin.key 2048</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl req -new -key admin.key -out admin.csr -subj &quot;/O=system:masters/CN=dmin&quot;</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># openssl x509 -req -set_serial $(date +%s%N) -in admin.csr -CA ca.crt -CAkey ca.key -out admin.crt -days 365 -extensions v3_req -extfile req.conf</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="å¥åº·æ£€æŸ¥"><a href="#å¥åº·æ£€æŸ¥" class="header-anchor">#</a> å¥åº·æ£€æŸ¥</h2> <blockquote><h2 id="é…ç½®å­˜æ´»ã€å°±ç»ªå’Œå¯åŠ¨æ¢æµ‹å™¨"><a href="#é…ç½®å­˜æ´»ã€å°±ç»ªå’Œå¯åŠ¨æ¢æµ‹å™¨" class="header-anchor">#</a> é…ç½®å­˜æ´»ã€å°±ç»ªå’Œå¯åŠ¨æ¢æµ‹å™¨</h2></blockquote> <p><a href="https://kubernetes.io/zh/docs/reference/command-line-tools-reference/kubelet/" target="_blank" rel="noopener noreferrer">kubelet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä½¿ç”¨å­˜æ´»æ¢æµ‹å™¨æ¥çŸ¥é“ä»€ä¹ˆæ—¶å€™è¦é‡å¯å®¹å™¨ï¼Œå­˜æ´»æ¢æµ‹å™¨å¯ä»¥æ•æ‰åˆ°æ­»é”ï¼ˆåº”ç”¨ç¨‹åºåœ¨è¿è¡Œï¼Œä½†æ˜¯æ— æ³•ç»§ç»­æ‰§è¡Œåé¢çš„æ­¥éª¤ï¼‰ã€‚ è¿™æ ·çš„æƒ…å†µä¸‹é‡å¯å®¹å™¨æœ‰åŠ©äºè®©åº”ç”¨ç¨‹åºåœ¨æœ‰é—®é¢˜çš„æƒ…å†µä¸‹æ›´å¯ç”¨ã€‚</p> <p>kubelet ä½¿ç”¨å°±ç»ªæ¢æµ‹å™¨å¯ä»¥çŸ¥é“å®¹å™¨ä»€ä¹ˆæ—¶å€™å‡†å¤‡å¥½äº†å¹¶å¯ä»¥å¼€å§‹æ¥å—è¯·æ±‚æµé‡ï¼Œ å½“ä¸€ä¸ª Pod å†…çš„æ‰€æœ‰å®¹å™¨éƒ½å‡†å¤‡å¥½äº†ï¼Œæ‰èƒ½æŠŠè¿™ä¸ª Pod çœ‹ä½œå°±ç»ªäº†ã€‚ è¿™ç§ä¿¡å·çš„ä¸€ä¸ªç”¨é€”å°±æ˜¯æ§åˆ¶å“ªä¸ª Pod ä½œä¸º Service çš„åç«¯ã€‚ åœ¨ Pod è¿˜æ²¡æœ‰å‡†å¤‡å¥½çš„æ—¶å€™ï¼Œä¼šä» Service çš„è´Ÿè½½å‡è¡¡å™¨ä¸­è¢«å‰”é™¤çš„ã€‚</p> <p>kubelet ä½¿ç”¨å¯åŠ¨æ¢æµ‹å™¨å¯ä»¥çŸ¥é“åº”ç”¨ç¨‹åºå®¹å™¨ä»€ä¹ˆæ—¶å€™å¯åŠ¨äº†ã€‚ å¦‚æœé…ç½®äº†è¿™ç±»æ¢æµ‹å™¨ï¼Œå°±å¯ä»¥æ§åˆ¶å®¹å™¨åœ¨å¯åŠ¨æˆåŠŸåå†è¿›è¡Œå­˜æ´»æ€§å’Œå°±ç»ªæ£€æŸ¥ï¼Œ ç¡®ä¿è¿™äº›å­˜æ´»ã€å°±ç»ªæ¢æµ‹å™¨ä¸ä¼šå½±å“åº”ç”¨ç¨‹åºçš„å¯åŠ¨ã€‚ è¿™å¯ä»¥ç”¨äºå¯¹æ…¢å¯åŠ¨å®¹å™¨è¿›è¡Œå­˜æ´»æ€§æ£€æµ‹ï¼Œé¿å…å®ƒä»¬åœ¨å¯åŠ¨è¿è¡Œä¹‹å‰å°±è¢«æ€æ‰ã€‚</p> <h3 id="å®šä¹‰å­˜æ´»å‘½ä»¤"><a href="#å®šä¹‰å­˜æ´»å‘½ä»¤" class="header-anchor">#</a> å®šä¹‰å­˜æ´»å‘½ä»¤</h3> <ul><li><p>è®¸å¤šé•¿æ—¶é—´è¿è¡Œçš„åº”ç”¨ç¨‹åºæœ€ç»ˆä¼šè¿‡æ¸¡åˆ°æ–­å¼€çš„çŠ¶æ€ï¼Œé™¤éé‡æ–°å¯åŠ¨ï¼Œå¦åˆ™æ— æ³•æ¢å¤ã€‚ Kubernetes æä¾›äº†å­˜æ´»æ¢æµ‹å™¨æ¥å‘ç°å¹¶è¡¥æ•‘è¿™ç§æƒ…å†µã€‚</p></li> <li><p>åœ¨è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹åˆ° Pod ä¸­åªæœ‰ä¸€ä¸ªå®¹å™¨ã€‚</p></li> <li><p><strong><code>periodSeconds</code></strong> å­—æ®µæŒ‡å®šäº† kubelet åº”è¯¥æ¯ 5 ç§’æ‰§è¡Œä¸€æ¬¡å­˜æ´»æ¢æµ‹ã€‚</p></li> <li><p><strong><code>initialDelaySeconds</code></strong> å­—æ®µå‘Šè¯‰ kubelet åœ¨æ‰§è¡Œç¬¬ä¸€æ¬¡æ¢æµ‹å‰åº”è¯¥ç­‰å¾… 5 ç§’ã€‚</p></li> <li><p>kubelet åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ <strong><code>cat /tmp/healthy</code></strong> æ¥è¿›è¡Œæ¢æµ‹ã€‚</p></li> <li><p>å¦‚æœå‘½ä»¤æ‰§è¡ŒæˆåŠŸå¹¶ä¸”è¿”å›å€¼ä¸º 0ï¼Œkubelet å°±ä¼šè®¤ä¸ºè¿™ä¸ªå®¹å™¨æ˜¯å¥åº·å­˜æ´»çš„ã€‚ å¦‚æœè¿™ä¸ªå‘½ä»¤è¿”å›é 0 å€¼ï¼Œkubelet ä¼šæ€æ­»è¿™ä¸ªå®¹å™¨å¹¶é‡æ–°å¯åŠ¨å®ƒã€‚</p></li> <li><p>å½“å®¹å™¨å¯åŠ¨æ—¶ï¼Œæ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š <strong><code>/bin/sh -c &quot;touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600&quot;</code></strong></p></li> <li><p>è¿™ä¸ªå®¹å™¨ç”Ÿå‘½çš„å‰ 30 ç§’ï¼Œ <code>/tmp/healthy</code> æ–‡ä»¶æ˜¯å­˜åœ¨çš„ã€‚ æ‰€ä»¥åœ¨è¿™æœ€å¼€å§‹çš„ 30 ç§’å†…ï¼Œæ‰§è¡Œå‘½ä»¤ <code>cat /tmp/healthy</code> ä¼šè¿”å›æˆåŠŸä»£ç ã€‚ 30 ç§’ä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤ <code>cat /tmp/healthy</code> å°±ä¼šè¿”å›å¤±è´¥ä»£ç ã€‚</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">test</span><span class="token punctuation">:</span> liveness
  <span class="token key atrule">name</span><span class="token punctuation">:</span> liveness<span class="token punctuation">-</span>exec
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> liveness
    <span class="token key atrule">image</span><span class="token punctuation">:</span> k8s.gcr.io/busybox
    <span class="token key atrule">args</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> /bin/sh
    <span class="token punctuation">-</span> <span class="token punctuation">-</span>c
    <span class="token punctuation">-</span> touch /tmp/healthy; sleep 30; rm <span class="token punctuation">-</span>rf /tmp/healthy; sleep 600
    <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>
      <span class="token key atrule">exec</span><span class="token punctuation">:</span>
        <span class="token key atrule">command</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> cat
        <span class="token punctuation">-</span> /tmp/healthy
      <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">5</span>
      <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></li></ul> <blockquote><h2 id="å®šä¹‰ä¸€ä¸ªå­˜æ´»æ€httpè¯·æ±‚æ¥å£"><a href="#å®šä¹‰ä¸€ä¸ªå­˜æ´»æ€httpè¯·æ±‚æ¥å£" class="header-anchor">#</a> å®šä¹‰ä¸€ä¸ªå­˜æ´»æ€HTTPè¯·æ±‚æ¥å£</h2></blockquote> <p>å¦å¤–ä¸€ç§ç±»å‹çš„å­˜æ´»æ¢æµ‹æ–¹å¼æ˜¯ä½¿ç”¨ HTTP GET è¯·æ±‚ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ª Pod çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­è¿è¡Œä¸€ä¸ªåŸºäº <code>k8s.gcr.io/liveness</code> é•œåƒçš„å®¹å™¨ã€‚</p> <h3 id="å®šä¹‰httpè¯·æ±‚æ¥å£"><a href="#å®šä¹‰httpè¯·æ±‚æ¥å£" class="header-anchor">#</a> å®šä¹‰HTTPè¯·æ±‚æ¥å£</h3> <ul><li>åœ¨è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹åˆ° Pod ä¹Ÿåªæœ‰ä¸€ä¸ªå®¹å™¨ã€‚</li> <li><strong><code>periodSeconds</code></strong> å­—æ®µæŒ‡å®šäº† kubelet æ¯éš” 3 ç§’æ‰§è¡Œä¸€æ¬¡å­˜æ´»æ¢æµ‹ã€‚</li> <li><strong><code>initialDelaySeconds</code></strong> å­—æ®µå‘Šè¯‰ kubelet åœ¨æ‰§è¡Œç¬¬ä¸€æ¬¡æ¢æµ‹å‰åº”è¯¥ç­‰å¾… 3 ç§’ã€‚</li> <li>kubelet ä¼šå‘å®¹å™¨å†…è¿è¡Œçš„æœåŠ¡ï¼ˆæœåŠ¡ä¼šç›‘å¬ 8080 ç«¯å£ï¼‰å‘é€ä¸€ä¸ª HTTP GET è¯·æ±‚æ¥æ‰§è¡Œæ¢æµ‹ã€‚ å¦‚æœæœåŠ¡å™¨ä¸Š <strong><code>/healthz</code></strong> è·¯å¾„ä¸‹çš„å¤„ç†ç¨‹åºè¿”å›æˆåŠŸä»£ç ï¼Œåˆ™ kubelet è®¤ä¸ºå®¹å™¨æ˜¯å¥åº·å­˜æ´»çš„ã€‚ å¦‚æœå¤„ç†ç¨‹åºè¿”å›å¤±è´¥ä»£ç ï¼Œåˆ™ kubelet ä¼šæ€æ­»è¿™ä¸ªå®¹å™¨å¹¶ä¸”é‡æ–°å¯åŠ¨å®ƒã€‚</li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">test</span><span class="token punctuation">:</span> liveness
  <span class="token key atrule">name</span><span class="token punctuation">:</span> liveness<span class="token punctuation">-</span>http
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> liveness
    <span class="token key atrule">image</span><span class="token punctuation">:</span> k8s.gcr.io/liveness
    <span class="token key atrule">args</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> /server
    <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>				<span class="token comment">#å‘¨æœŸæ€§çš„</span>
      <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> /healthz
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
        <span class="token key atrule">httpHeaders</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Custom<span class="token punctuation">-</span>Header
          <span class="token key atrule">value</span><span class="token punctuation">:</span> Awesome
      <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">3</span>
      <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>kubeletåœ¨å®¹å™¨å¯åŠ¨ä¹‹å3ç§’å¼€å§‹æ‰§è¡Œå¥åº·æ£€æµ‹ã€‚æ‰€ä»¥å‰å‡ æ¬¡å¥åº·æ£€æŸ¥éƒ½æ˜¯æˆåŠŸçš„ã€‚ä½†æ˜¯10ç§’ä¹‹åï¼Œå¥åº·æ£€æŸ¥ä¼šå¤±è´¥ï¼Œå¹¶ä¸”kubeletä¼šæ€æ­»å®¹å™¨å†é‡æ–°å¯åŠ¨å®¹å™¨ã€‚</p> <blockquote><h2 id="å®šä¹‰tcpçš„å­˜æ´»æ¢æµ‹"><a href="#å®šä¹‰tcpçš„å­˜æ´»æ¢æµ‹" class="header-anchor">#</a> å®šä¹‰TCPçš„å­˜æ´»æ¢æµ‹</h2></blockquote> <p>ç¬¬ä¸‰ç§ç±»å‹çš„å­˜æ´»æ¢æµ‹æ˜¯ä½¿ç”¨ TCP å¥—æ¥å­—ã€‚ é€šè¿‡é…ç½®ï¼Œkubelet ä¼šå°è¯•åœ¨æŒ‡å®šç«¯å£å’Œå®¹å™¨å»ºç«‹å¥—æ¥å­—é“¾æ¥ã€‚ å¦‚æœèƒ½å»ºç«‹è¿æ¥ï¼Œè¿™ä¸ªå®¹å™¨å°±è¢«çœ‹ä½œæ˜¯å¥åº·çš„ï¼Œå¦‚æœä¸èƒ½åˆ™è¿™ä¸ªå®¹å™¨å°±è¢«çœ‹ä½œæ˜¯æœ‰é—®é¢˜çš„ã€‚</p> <h3 id="å®šä¹‰tcpæ¢é’ˆ"><a href="#å®šä¹‰tcpæ¢é’ˆ" class="header-anchor">#</a> å®šä¹‰TCPæ¢é’ˆ</h3> <ul><li>å¦‚ä¸‹å®ä¾‹ï¼Œkubelet ä¼šåœ¨**<code>å®¹å™¨å¯åŠ¨ 5 ç§’åå‘é€ç¬¬ä¸€ä¸ªå°±ç»ªæ¢æµ‹</code>ã€‚**</li> <li>è¿™ä¼šå°è¯•è¿æ¥ <strong><code>nginx</code></strong> å®¹å™¨çš„80ç«¯å£ã€‚ å¦‚æœæ¢æµ‹æˆåŠŸï¼Œè¿™ä¸ª Pod ä¼šè¢«æ ‡è®°ä¸ºå°±ç»ªçŠ¶æ€ï¼Œkubelet å°†ç»§ç»­æ¯éš” 10 ç§’è¿è¡Œä¸€æ¬¡æ£€æµ‹ã€‚</li> <li>é™¤äº†å°±ç»ªæ¢æµ‹ï¼Œ<strong><code>è¿™ä¸ªé…ç½®åŒ…æ‹¬äº†ä¸€ä¸ªå­˜æ´»æ¢æµ‹ã€‚</code></strong></li> <li>kubelet ä¼šåœ¨**<code>å®¹å™¨å¯åŠ¨ 15 ç§’åè¿›è¡Œç¬¬ä¸€æ¬¡å­˜æ´»æ¢æµ‹ã€‚</code>** ä¸å°±ç»ªæ¢æµ‹ç±»ä¼¼ï¼Œä¼šå°è¯•è¿æ¥**<code>nginx</code>**å®¹å™¨çš„80ç«¯å£ã€‚ å¦‚æœå­˜æ´»æ¢æµ‹å¤±è´¥ï¼Œè¿™ä¸ªå®¹å™¨ä¼šè¢«é‡æ–°å¯åŠ¨ã€‚</li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat tcp.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">readinessProbe</span><span class="token punctuation">:</span> 			<span class="token comment">#å®šæœŸæ€§çš„</span>
      <span class="token key atrule">tcpSocket</span><span class="token punctuation">:</span> 
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span> 
      <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">5</span>
      <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">10</span>
    <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span> 
      <span class="token key atrule">tcpSocket</span><span class="token punctuation">:</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span> 
      <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">15</span>
      <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">20</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li><strong>æŸ¥çœ‹çŠ¶æ€çš„è½¬å˜</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME            READY   STATUS             RESTARTS   AGE
nginx           <span class="token number">0</span>/1     Running            <span class="token number">0</span>          27s

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME            READY   STATUS             RESTARTS   AGE
nginx           <span class="token number">1</span>/1     Running            <span class="token number">0</span>          65s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><h2 id="å®šä¹‰å°±ç»ªæ¢æµ‹å™¨"><a href="#å®šä¹‰å°±ç»ªæ¢æµ‹å™¨" class="header-anchor">#</a> å®šä¹‰å°±ç»ªæ¢æµ‹å™¨</h2></blockquote> <p>æœ‰æ—¶å€™ï¼Œåº”ç”¨ç¨‹åºä¼šæš‚æ—¶æ€§çš„ä¸èƒ½æä¾›é€šä¿¡æœåŠ¡ã€‚ ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºåœ¨å¯åŠ¨æ—¶å¯èƒ½éœ€è¦åŠ è½½å¾ˆå¤§çš„æ•°æ®æˆ–é…ç½®æ–‡ä»¶ï¼Œæˆ–æ˜¯å¯åŠ¨åè¦ä¾èµ–ç­‰å¾…å¤–éƒ¨æœåŠ¡ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ—¢ä¸æƒ³æ€æ­»åº”ç”¨ç¨‹åºï¼Œä¹Ÿä¸æƒ³ç»™å®ƒå‘é€è¯·æ±‚ã€‚ Kubernetes æä¾›äº†å°±ç»ªæ¢æµ‹å™¨æ¥å‘ç°å¹¶ç¼“è§£è¿™äº›æƒ…å†µã€‚ å®¹å™¨æ‰€åœ¨ Pod ä¸ŠæŠ¥è¿˜æœªå°±ç»ªçš„ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸æ¥å—é€šè¿‡ Kubernetes Service çš„æµé‡ã€‚å°±ç»ªæ¢æµ‹å™¨åœ¨å®¹å™¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¿æŒè¿è¡ŒçŠ¶æ€ã€‚</p> <p><strong>æ³¨æ„ï¼š</strong> æ´»è·ƒæ€§æ¢æµ‹å™¨ <em>ä¸ç­‰å¾…</em> å°±ç»ªæ€§æ¢æµ‹å™¨æˆåŠŸã€‚ å¦‚æœè¦åœ¨æ‰§è¡Œæ´»è·ƒæ€§æ¢æµ‹å™¨ä¹‹å‰ç­‰å¾…ï¼Œåº”è¯¥ä½¿ç”¨ initialDelaySeconds æˆ– startupProbeã€‚</p> <p>å°±ç»ªæ¢æµ‹å™¨çš„é…ç½®å’Œå­˜æ´»æ¢æµ‹å™¨çš„é…ç½®ç›¸ä¼¼ã€‚ å”¯ä¸€åŒºåˆ«å°±æ˜¯è¦ä½¿ç”¨ <code>readinessProbe</code> å­—æ®µï¼Œè€Œä¸æ˜¯ <code>livenessProbe</code> å­—æ®µã€‚</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">readinessProbe</span><span class="token punctuation">:</span>
  <span class="token key atrule">exec</span><span class="token punctuation">:</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> cat
    <span class="token punctuation">-</span> /tmp/healthy
  <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">5</span>
  <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><h2 id="é…ç½®æ¢æµ‹å™¨"><a href="#é…ç½®æ¢æµ‹å™¨" class="header-anchor">#</a> é…ç½®æ¢æµ‹å™¨</h2></blockquote> <ul><li><h4 id="probe-æœ‰å¾ˆå¤šé…ç½®å­—æ®µ-å¯ä»¥ä½¿ç”¨è¿™äº›å­—æ®µç²¾ç¡®çš„æ§åˆ¶å­˜æ´»å’Œå°±ç»ªæ£€æµ‹çš„è¡Œä¸º"><a href="#probe-æœ‰å¾ˆå¤šé…ç½®å­—æ®µ-å¯ä»¥ä½¿ç”¨è¿™äº›å­—æ®µç²¾ç¡®çš„æ§åˆ¶å­˜æ´»å’Œå°±ç»ªæ£€æµ‹çš„è¡Œä¸º" class="header-anchor">#</a> <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#probe-v1-core" target="_blank" rel="noopener noreferrer">Probe<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æœ‰å¾ˆå¤šé…ç½®å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›å­—æ®µç²¾ç¡®çš„æ§åˆ¶å­˜æ´»å’Œå°±ç»ªæ£€æµ‹çš„è¡Œä¸ºï¼š</h4> <ul><li><p><strong><code>initialDelaySeconds</code></strong>ï¼šå®¹å™¨å¯åŠ¨åè¦ç­‰å¾…å¤šå°‘ç§’åå­˜æ´»å’Œå°±ç»ªæ¢æµ‹å™¨æ‰è¢«åˆå§‹åŒ–ï¼Œé»˜è®¤æ˜¯ 0 ç§’ï¼Œæœ€å°å€¼æ˜¯ 0ã€‚</p></li> <li><p><strong><code>periodSeconds</code></strong>ï¼šæ‰§è¡Œæ¢æµ‹çš„æ—¶é—´é—´éš”ï¼ˆå•ä½æ˜¯ç§’ï¼‰ã€‚é»˜è®¤æ˜¯ 10 ç§’ã€‚æœ€å°å€¼æ˜¯ 1ã€‚</p></li> <li><p><strong><code>timeoutSeconds</code></strong>ï¼šæ¢æµ‹çš„è¶…æ—¶åç­‰å¾…å¤šå°‘ç§’ã€‚é»˜è®¤å€¼æ˜¯ 1 ç§’ã€‚æœ€å°å€¼æ˜¯ 1ã€‚</p></li> <li><p><strong><code>successThreshold</code></strong>ï¼šæ¢æµ‹å™¨åœ¨å¤±è´¥åï¼Œè¢«è§†ä¸ºæˆåŠŸçš„æœ€å°è¿ç»­æˆåŠŸæ•°ã€‚é»˜è®¤å€¼æ˜¯ 1ã€‚ å­˜æ´»å’Œå¯åŠ¨æ¢æµ‹çš„è¿™ä¸ªå€¼å¿…é¡»æ˜¯ 1ã€‚æœ€å°å€¼æ˜¯ 1ã€‚</p></li> <li><p><strong><code>failureThreshold</code></strong>ï¼šå½“æ¢æµ‹å¤±è´¥æ—¶ï¼ŒKubernetes çš„é‡è¯•æ¬¡æ•°ã€‚ å­˜æ´»æ¢æµ‹æƒ…å†µä¸‹çš„æ”¾å¼ƒå°±æ„å‘³ç€é‡æ–°å¯åŠ¨å®¹å™¨ã€‚ å°±ç»ªæ¢æµ‹æƒ…å†µä¸‹çš„æ”¾å¼ƒ Pod ä¼šè¢«æ‰“ä¸Šæœªå°±ç»ªçš„æ ‡ç­¾ã€‚é»˜è®¤å€¼æ˜¯ 3ã€‚æœ€å°å€¼æ˜¯ 1ã€‚</p></li></ul></li></ul> <h3 id="http-æ¢æµ‹"><a href="#http-æ¢æµ‹" class="header-anchor">#</a> HTTP æ¢æµ‹</h3> <ul><li><h4 id="http-probes-å¯ä»¥åœ¨-httpget-ä¸Šé…ç½®é¢å¤–çš„å­—æ®µ"><a href="#http-probes-å¯ä»¥åœ¨-httpget-ä¸Šé…ç½®é¢å¤–çš„å­—æ®µ" class="header-anchor">#</a> <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#httpgetaction-v1-core" target="_blank" rel="noopener noreferrer">HTTP Probes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å¯ä»¥åœ¨ <code>httpGet</code> ä¸Šé…ç½®é¢å¤–çš„å­—æ®µï¼š</h4> <ul><li><p><strong><code>host</code>ï¼šè¿æ¥ä½¿ç”¨çš„ä¸»æœºåï¼Œé»˜è®¤æ˜¯ Pod çš„ IPã€‚ä¹Ÿå¯ä»¥åœ¨ HTTP å¤´ä¸­è®¾ç½® â€œHostâ€ æ¥ä»£æ›¿ã€‚</strong></p></li> <li><p><strong><code>scheme</code> ï¼šç”¨äºè®¾ç½®è¿æ¥ä¸»æœºçš„æ–¹å¼ï¼ˆHTTP è¿˜æ˜¯ HTTPSï¼‰ã€‚é»˜è®¤æ˜¯ HTTPã€‚</strong></p></li> <li><p><strong><code>path</code>ï¼šè®¿é—® HTTP æœåŠ¡çš„è·¯å¾„ã€‚é»˜è®¤å€¼ä¸º &quot;/&quot;ã€‚</strong></p></li> <li><p><strong><code>httpHeaders</code>ï¼šè¯·æ±‚ä¸­è‡ªå®šä¹‰çš„ HTTP å¤´ã€‚HTTP å¤´å­—æ®µå…è®¸é‡å¤ã€‚</strong></p></li> <li><p><strong><code>port</code>ï¼šè®¿é—®å®¹å™¨çš„ç«¯å£å·æˆ–è€…ç«¯å£åã€‚å¦‚æœæ•°å­—å¿…é¡»åœ¨ 1 ï½ 65535 ä¹‹é—´ã€‚</strong></p></li></ul></li></ul> <p>ä½ å¯ä»¥é€šè¿‡ä¸ºæ¢æµ‹è®¾ç½® <code>.httpHeaders</code> æ¥é‡è½½é»˜è®¤çš„å¤´éƒ¨å­—æ®µå€¼ï¼›ä¾‹å¦‚ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>
  <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
    <span class="token key atrule">httpHeaders</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Accept
        <span class="token key atrule">value</span><span class="token punctuation">:</span> application/json

<span class="token key atrule">startupProbe</span><span class="token punctuation">:</span>
  <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
    <span class="token key atrule">httpHeaders</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> User<span class="token punctuation">-</span>Agent
        <span class="token key atrule">value</span><span class="token punctuation">:</span> MyUserAgent
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡å°†è¿™äº›å¤´éƒ¨å­—æ®µå®šä¹‰ä¸ºç©ºå€¼ï¼Œä»è¯·æ±‚ä¸­å»æ‰è¿™äº›å¤´éƒ¨å­—æ®µã€‚</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>
  <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
    <span class="token key atrule">httpHeaders</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Accept
        <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>

<span class="token key atrule">startupProbe</span><span class="token punctuation">:</span>
  <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
    <span class="token key atrule">httpHeaders</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> User<span class="token punctuation">-</span>Agent
        <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="tcp-æ¢æµ‹"><a href="#tcp-æ¢æµ‹" class="header-anchor">#</a> TCP æ¢æµ‹</h3> <p>å¯¹äºä¸€æ¬¡ TCP æ¢æµ‹ï¼Œkubelet åœ¨èŠ‚ç‚¹ä¸Šï¼ˆä¸æ˜¯åœ¨ Pod é‡Œé¢ï¼‰å»ºç«‹æ¢æµ‹è¿æ¥ï¼Œ è¿™æ„å‘³ç€ä½ ä¸èƒ½åœ¨ <code>host</code> å‚æ•°ä¸Šé…ç½®æœåŠ¡åç§°ï¼Œå› ä¸º kubelet ä¸èƒ½è§£ææœåŠ¡åç§°ã€‚</p> <ul><li><h4 id="æ¢æµ‹å™¨çº§åˆ«-terminationgraceperiodseconds"><a href="#æ¢æµ‹å™¨çº§åˆ«-terminationgraceperiodseconds" class="header-anchor">#</a> æ¢æµ‹å™¨çº§åˆ« <code>terminationGracePeriodSeconds</code></h4> <ul><li><strong>FEATURE STATE:</strong> <code>Kubernetes v1.22 [beta]</code></li> <li>åœ¨ 1.21 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œå½“ç‰¹æ€§é—¨æ§ <code>ProbeTerminationGracePeriod</code> ä¸º å¯ç”¨çŠ¶æ€æ—¶ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šä¸€ä¸ªæ¢æµ‹çº§åˆ«çš„ <code>terminationGracePeriodSeconds</code> ä½œä¸º æ¢é’ˆè§„æ ¼çš„ä¸€éƒ¨åˆ†ã€‚</li> <li>å½“ç‰¹æ€§é—¨æ§è¢«å¯ç”¨æ—¶ï¼Œå¹¶ä¸” Pod çº§å’Œæ¢é’ˆçº§çš„ <code>terminationGracePeriodSeconds</code> éƒ½å·²è®¾ç½®ï¼Œkubelet å°† ä½¿ç”¨æ¢é’ˆçº§è®¾ç½®çš„å€¼ã€‚</li></ul></li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat http_probe.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> 172.25.253.3/library/nginx
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">ports</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span> 
      <span class="token key atrule">name</span><span class="token punctuation">:</span> liveness<span class="token punctuation">-</span>port 
      <span class="token key atrule">hostPort</span><span class="token punctuation">:</span> <span class="token number">80</span> 
    <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>
      <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> /healthz 
        <span class="token key atrule">port</span><span class="token punctuation">:</span> liveness<span class="token punctuation">-</span>port 
      <span class="token key atrule">failureThreshold</span><span class="token punctuation">:</span> <span class="token number">1</span> 		<span class="token comment">#åœ¨æµ‹è¯•åè¢«è§†ä¸ºå¤±è´¥çš„æ¢é’ˆçš„æœ€å°è¿ç»­æ•…éšœæ•°æˆåŠŸçš„</span>
      <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">60</span>
      <span class="token key atrule">terminationGracePeriodSeconds</span><span class="token punctuation">:</span> <span class="token number">60</span>   <span class="token comment">#å¯é€‰çš„æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œpodéœ€è¦åœ¨æ¢å¤´æ•…éšœå®½é™æœŸæ˜¯åœ¨ç§’ä¹‹åçš„æŒç»­æ—¶é—´ã€‚</span>
      
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME                                      READY   STATUS    RESTARTS   AGE
nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner<span class="token punctuation">-</span>654754dd8d<span class="token punctuation">-</span>hnm2g   1/1     Running   0          66m
nginx                                     1/1     Running   0          3s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><ul><li>å¦‚æœä½ å·²ç»ä¸ºç°æœ‰ Pod è®¾ç½®äº† â€œterminationGracePeriodSecondsâ€ å­—æ®µå¹¶ä¸” ä¸å†å¸Œæœ›ä½¿ç”¨é’ˆå¯¹æ¯ä¸ªæ¢é’ˆçš„ç»ˆæ­¢å®½é™æœŸï¼Œåˆ™å¿…é¡»åˆ é™¤é‚£äº›ç°æœ‰çš„ Podã€‚</li> <li>ï¼ˆæ§åˆ¶å¹³é¢æˆ–æŸäº›å…¶ä»–ç»„ä»¶ï¼‰åˆ›å»ºæ›¿æ¢Podsï¼Œå¹¶ä¸”ç‰¹æ€§é—¨æ§â€œProbeTerminationGracePeriodâ€è¢«ç¦ç”¨ï¼Œé‚£ä¹ˆAPIæœåŠ¡å™¨ä¼šå¿½ç•¥Podçº§åˆ«çš„<code>terminationGracePeriodSeconds</code>å­—æ®µï¼Œå³ä½¿Podæ¨¡æ¿æŒ‡å®šäº†å®ƒã€‚</li></ul> <p>æ¢æµ‹å™¨çº§åˆ«çš„ <code>terminationGracePeriodSeconds</code> ä¸èƒ½ç”¨äºè®¾ç½®å°±ç»ªæ€æ¢é’ˆã€‚ å®ƒå°†è¢« API æœåŠ¡å™¨æ‹’ç»ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME                                      READY   STATUS             RESTARTS     AGE
nfs-client-provisioner-654754dd8d-hnm2g   <span class="token number">1</span>/1     Running            <span class="token number">0</span>            72m
nginx                                     <span class="token number">0</span>/1     CrashLoopBackOff   <span class="token number">5</span> <span class="token punctuation">(</span>0s ago<span class="token punctuation">)</span>   6m1s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="ä½¿ç”¨rbacé‰´æƒ"><a href="#ä½¿ç”¨rbacé‰´æƒ" class="header-anchor">#</a> ä½¿ç”¨RBACé‰´æƒ</h2> <p>åŸºäºè§’è‰²ï¼ˆRoleï¼‰çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰æ˜¯ä¸€ç§åŸºäºç»„ç»‡ä¸­ç”¨æˆ·çš„è§’è‰²æ¥è°ƒèŠ‚æ§åˆ¶å¯¹ è®¡ç®—æœºæˆ–ç½‘ç»œèµ„æºçš„è®¿é—®çš„æ–¹æ³•ã€‚</p> <p>RBAC é‰´æƒæœºåˆ¶ä½¿ç”¨ <code>rbac.authorization.k8s.io</code> <a href="https://kubernetes.io/zh/docs/concepts/overview/kubernetes-api/#api-groups-and-versioning" target="_blank" rel="noopener noreferrer">API ç»„<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¥é©±åŠ¨é‰´æƒå†³å®šï¼Œå…è®¸ä½ é€šè¿‡ Kubernetes API åŠ¨æ€é…ç½®ç­–ç•¥ã€‚</p> <p>è¦å¯ç”¨ RBACï¼Œåœ¨å¯åŠ¨ <a href="https://kubernetes.io/zh/docs/reference/command-line-tools-reference/kube-apiserver/" target="_blank" rel="noopener noreferrer">API æœåŠ¡å™¨<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ—¶å°† <code>--authorization-mode</code> å‚æ•°è®¾ç½®ä¸ºä¸€ä¸ªé€—å·åˆ†éš”çš„åˆ—è¡¨å¹¶ç¡®ä¿å…¶ä¸­åŒ…å« <code>RBAC</code>ã€‚</p> <h3 id="api-å¯¹è±¡"><a href="#api-å¯¹è±¡" class="header-anchor">#</a> API å¯¹è±¡</h3> <p>RBAC API å£°æ˜äº†å››ç§ Kubernetes å¯¹è±¡ï¼š<em>Role</em>ã€<em>ClusterRole</em>ã€<em>RoleBinding</em> å’Œ <em>ClusterRoleBinding</em>ã€‚ä½ å¯ä»¥åƒä½¿ç”¨å…¶ä»– Kubernetes å¯¹è±¡ä¸€æ ·ï¼Œ é€šè¿‡ç±»ä¼¼ <code>kubectl</code> è¿™ç±»å·¥å…· <a href="https://kubernetes.io/zh/docs/concepts/overview/working-with-objects/kubernetes-objects/#understanding-kubernetes-objects" target="_blank" rel="noopener noreferrer">æè¿°å¯¹è±¡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, æˆ–ä¿®è¡¥å¯¹è±¡ã€‚</p> <h3 id="roleå’Œclusterrole"><a href="#roleå’Œclusterrole" class="header-anchor">#</a> Roleå’ŒClusterRole</h3> <p>RBAC çš„ <em>Role</em> æˆ– <em>ClusterRole</em> ä¸­<code>åŒ…å«ä¸€ç»„ä»£è¡¨ç›¸å…³æƒé™çš„è§„åˆ™</code>ã€‚ <code>è¿™äº›æƒé™æ˜¯çº¯ç²¹ç´¯åŠ çš„ï¼ˆä¸å­˜åœ¨æ‹’ç»æŸæ“ä½œçš„è§„åˆ™ï¼‰</code>ã€‚</p> <p>Role æ€»æ˜¯ç”¨æ¥åœ¨æŸä¸ª<a href="https://kubernetes.io/zh/docs/concepts/overview/working-with-objects/namespaces/" target="_blank" rel="noopener noreferrer">åå­—ç©ºé—´<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å†…è®¾ç½®è®¿é—®æƒé™ï¼›åœ¨ä½ åˆ›å»º Role æ—¶ï¼Œä½ å¿…é¡»æŒ‡å®šè¯¥ Role æ‰€å±çš„åå­—ç©ºé—´ã€‚</p> <p>ä¸ä¹‹ç›¸å¯¹ï¼ŒClusterRole åˆ™æ˜¯ä¸€ä¸ªé›†ç¾¤ä½œç”¨åŸŸçš„èµ„æºã€‚è¿™ä¸¤ç§èµ„æºçš„åå­—ä¸åŒï¼ˆRole å’Œ ClusterRoleï¼‰æ˜¯å› ä¸º Kubernetes å¯¹è±¡è¦ä¹ˆæ˜¯åå­—ç©ºé—´ä½œç”¨åŸŸçš„ï¼Œè¦ä¹ˆæ˜¯é›†ç¾¤ä½œç”¨åŸŸçš„ï¼Œ ä¸å¯ä¸¤è€…å…¼å…·ã€‚</p> <p><strong>ClusterRole æœ‰è‹¥å¹²ç”¨æ³•ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥ï¼š</strong></p> <ol><li>å®šä¹‰å¯¹æŸåå­—ç©ºé—´åŸŸå¯¹è±¡çš„è®¿é—®æƒé™ï¼Œå¹¶å°†åœ¨å„ä¸ªåå­—ç©ºé—´å†…å®Œæˆæˆæƒï¼›</li> <li>ä¸ºåå­—ç©ºé—´ä½œç”¨åŸŸçš„å¯¹è±¡è®¾ç½®è®¿é—®æƒé™ï¼Œå¹¶è·¨æ‰€æœ‰åå­—ç©ºé—´æ‰§è¡Œæˆæƒï¼›</li> <li>ä¸ºé›†ç¾¤ä½œç”¨åŸŸçš„èµ„æºå®šä¹‰è®¿é—®æƒé™ã€‚</li></ol> <h3 id="roleçš„ç¤ºä¾‹"><a href="#roleçš„ç¤ºä¾‹" class="header-anchor">#</a> Roleçš„ç¤ºä¾‹</h3> <p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½äº &quot;default&quot; åå­—ç©ºé—´çš„ Role çš„ç¤ºä¾‹ï¼Œå¯ç”¨æ¥æˆäºˆå¯¹ <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/" target="_blank" rel="noopener noreferrer">pods<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> çš„è¯»è®¿é—®æƒé™ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master role<span class="token punctuation">]</span><span class="token comment"># kubectl create role pod-reader --namespace=default --resource=pods  --verb=get,watch,list --dry-run  -o yaml &gt; role.yaml </span>

<span class="token punctuation">[</span>root@master role<span class="token punctuation">]</span><span class="token comment"># cat role.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Role						<span class="token comment">#æŒ‡å®šèµ„æºç±»å‹ä¸ºRole</span>
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token null important">null</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pod<span class="token punctuation">-</span>reader			
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default			<span class="token comment">#åå­—ç©ºé—´ä¸ºé»˜è®¤</span>
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;&quot;</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span>					<span class="token comment">#å¯ä»¥è®¿é—®çš„èµ„æºæ˜¯POD</span>
  <span class="token punctuation">-</span> pods
  <span class="token key atrule">verbs</span><span class="token punctuation">:</span>						<span class="token comment">#å¯¹è¯¥èµ„æºå¯ä»¥æ“ä½œçš„æƒé™ è¯»è®¿é—®æƒé™</span>
  <span class="token punctuation">-</span> get			
  <span class="token punctuation">-</span> watch
  <span class="token punctuation">-</span> list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="clusterroleç¤ºä¾‹"><a href="#clusterroleç¤ºä¾‹" class="header-anchor">#</a> ClusterRoleç¤ºä¾‹</h3> <p><strong>ClusterRole å¯ä»¥å’Œ Role ç›¸åŒå®Œæˆæˆæƒã€‚ å› ä¸º ClusterRole å±äºé›†ç¾¤èŒƒå›´ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¯ä»¥ä¸ºä»¥ä¸‹èµ„æºæˆäºˆè®¿é—®æƒé™ï¼š</strong></p> <ul><li>é›†ç¾¤èŒƒå›´èµ„æºï¼ˆæ¯”å¦‚ <a href="https://kubernetes.io/zh/docs/concepts/architecture/nodes/" target="_blank" rel="noopener noreferrer">èŠ‚ç‚¹ï¼ˆNodeï¼‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼‰</li> <li>éèµ„æºç«¯ç‚¹ï¼ˆæ¯”å¦‚ <code>/healthz</code>ï¼‰</li> <li>è·¨åå­—ç©ºé—´è®¿é—®çš„åå­—ç©ºé—´ä½œç”¨åŸŸçš„èµ„æºï¼ˆå¦‚ Podsï¼‰ï¼Œæ¯”å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ ClusterRole æ¥å…è®¸æŸç‰¹å®šç”¨æˆ·æ‰§è¡Œ <code>kubectl get pods --all-namespaces</code></li></ul> <p>ä¸‹é¢æ˜¯ä¸€ä¸ª ClusterRole çš„ç¤ºä¾‹ï¼Œå¯ç”¨æ¥ä¸ºä»»ä¸€ç‰¹å®šåå­—ç©ºé—´ä¸­çš„ <a href="https://kubernetes.io/zh/docs/concepts/configuration/secret/" target="_blank" rel="noopener noreferrer">Secret<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æˆäºˆè¯»è®¿é—®æƒé™ï¼Œ æˆ–è€…è·¨åå­—ç©ºé—´çš„è®¿é—®æƒé™ï¼ˆå–å†³äºè¯¥è§’è‰²æ˜¯å¦‚ä½•<a href="https://kubernetes.io/zh/docs/reference/access-authn-authz/rbac/#rolebinding-and-clusterrolebinding" target="_blank" rel="noopener noreferrer">ç»‘å®š<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„ï¼‰ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master role<span class="token punctuation">]</span><span class="token comment"># kubectl create clusterrole secret-reader --resource=secrets --verb=get,watch,list --dry-run -o yaml &gt; clusterrole.yaml </span>

<span class="token punctuation">[</span>root@master role<span class="token punctuation">]</span><span class="token comment"># cat clusterrole.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token null important">null</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>reader
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;&quot;</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> secrets
  <span class="token key atrule">verbs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> get
  <span class="token punctuation">-</span> watch
  <span class="token punctuation">-</span> list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="rolebindingå’Œclusterrolebinding"><a href="#rolebindingå’Œclusterrolebinding" class="header-anchor">#</a> RoleBindingå’ŒClusterRoleBinding</h3> <p>è§’è‰²ç»‘å®šï¼ˆRole Bindingï¼‰æ˜¯<code>å°†è§’è‰²ä¸­å®šä¹‰çš„æƒé™èµ‹äºˆä¸€ä¸ªæˆ–è€…ä¸€ç»„ç”¨æˆ·</code>ã€‚ å®ƒåŒ…å«è‹¥å¹² <strong>ä¸»ä½“</strong>ï¼ˆç”¨æˆ·ã€ç»„æˆ–æœåŠ¡è´¦æˆ·ï¼‰çš„åˆ—è¡¨å’Œå¯¹è¿™äº›ä¸»ä½“æ‰€è·å¾—çš„è§’è‰²çš„å¼•ç”¨ã€‚ RoleBinding åœ¨æŒ‡å®šçš„åå­—ç©ºé—´ä¸­æ‰§è¡Œæˆæƒï¼Œè€Œ ClusterRoleBinding åœ¨é›†ç¾¤èŒƒå›´æ‰§è¡Œæˆæƒã€‚</p> <p>ä¸€ä¸ª RoleBinding å¯ä»¥å¼•ç”¨åŒä¸€çš„åå­—ç©ºé—´ä¸­çš„ä»»ä½• Roleã€‚ æˆ–è€…ï¼Œä¸€ä¸ª RoleBinding å¯ä»¥å¼•ç”¨æŸ ClusterRole å¹¶å°†è¯¥ ClusterRole ç»‘å®šåˆ° RoleBinding æ‰€åœ¨çš„åå­—ç©ºé—´ã€‚ å¦‚æœä½ å¸Œæœ›å°†æŸ ClusterRole ç»‘å®šåˆ°é›†ç¾¤ä¸­æ‰€æœ‰åå­—ç©ºé—´ï¼Œä½ è¦ä½¿ç”¨ ClusterRoleBindingã€‚</p> <h3 id="rolebinding-ç¤ºä¾‹"><a href="#rolebinding-ç¤ºä¾‹" class="header-anchor">#</a> RoleBinding ç¤ºä¾‹</h3> <ul><li>ä¸‹é¢çš„ä¾‹å­ä¸­çš„ RoleBinding å°† &quot;pod-reader&quot; Role æˆäºˆåœ¨ &quot;default&quot; åå­—ç©ºé—´ä¸­çš„ç”¨æˆ· &quot;jane&quot;ã€‚ è¿™æ ·ï¼Œç”¨æˆ· &quot;jane&quot; å°±å…·æœ‰äº†è¯»å– &quot;default&quot; åå­—ç©ºé—´ä¸­ pods çš„æƒé™ã€‚</li> <li><code>RoleBinding ä¹Ÿå¯ä»¥å¼•ç”¨ ClusterRoleï¼Œä»¥å°†å¯¹åº” ClusterRole ä¸­å®šä¹‰çš„è®¿é—®æƒé™æˆäºˆ RoleBinding æ‰€åœ¨åå­—ç©ºé—´çš„èµ„æºã€‚</code></li> <li><code>è¿™ç§å¼•ç”¨ä½¿å¾—ä½ å¯ä»¥è·¨æ•´ä¸ªé›†ç¾¤å®šä¹‰ä¸€ç»„é€šç”¨çš„è§’è‰²ï¼Œ ä¹‹ååœ¨å¤šä¸ªåå­—ç©ºé—´ä¸­å¤ç”¨ã€‚</code></li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master role<span class="token punctuation">]</span><span class="token comment"># kubectl create rolebinding read-pods --namespace=default --user=jane --role=pod-reader --dry-run -o yaml &gt; rolebinding.yaml </span>

<span class="token punctuation">[</span>root@master role<span class="token punctuation">]</span><span class="token comment"># cat rolebinding.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> RoleBinding						<span class="token comment">#æ­¤è§’è‰²ç»‘å®šå…è®¸â€˜janeâ€™è¯»å–â€˜defaultâ€™åå­—ç©ºé—´ä¸­çš„Pods</span>
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token null important">null</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> read<span class="token punctuation">-</span>pods
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">roleRef</span><span class="token punctuation">:</span>								<span class="token comment">#æŒ‡å®šæŸä¸ªRoleæˆ–è€…æ˜¯Clusterroleçš„ç»‘å®šå…³ç³»</span>
  <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> Role							<span class="token comment">#æ­¤å­—æ®µæ˜¯Roleæˆ–è€…clusterRole</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pod<span class="token punctuation">-</span>reader						<span class="token comment">#è¿™æ˜¯ä½ çš„Roleæˆ–è€…clusterRoleçš„åå­—åŒ¹é…					</span>
<span class="token key atrule">subjects</span><span class="token punctuation">:</span>								<span class="token comment">#ä½ å¯ä»¥æŒ‡å®šä¸æ­¢ä¸€ä¸ªsubjectï¼ˆä¸»ä½“ï¼‰</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> User
  <span class="token key atrule">name</span><span class="token punctuation">:</span> jane							<span class="token comment">#nameæ˜¯åŒºåˆ†å¤§å°å†™çš„</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>å°½ç®¡ä¸‹é¢çš„ RoleBinding å¼•ç”¨çš„æ˜¯ä¸€ä¸ª ClusterRoleï¼Œ&quot;dave&quot;ï¼ˆè¿™é‡Œçš„ä¸»ä½“ï¼Œ åŒºåˆ†å¤§å°å†™ï¼‰åªèƒ½è®¿é—® &quot;development&quot; åå­—ç©ºé—´ä¸­çš„ Secrets å¯¹è±¡ï¼Œå› ä¸º RoleBinding æ‰€åœ¨çš„åå­—ç©ºé—´ï¼ˆç”±å…¶ metadata å†³å®šï¼‰æ˜¯ &quot;development&quot;ã€‚</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token comment"># æ­¤è§’è‰²ç»‘å®šä½¿å¾—ç”¨æˆ· &quot;dave&quot; èƒ½å¤Ÿè¯»å– &quot;development&quot; åå­—ç©ºé—´ä¸­çš„ Secrets</span>
<span class="token comment"># ä½ éœ€è¦ä¸€ä¸ªåä¸º &quot;secret-reader&quot; çš„ ClusterRole</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> RoleBinding
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> read<span class="token punctuation">-</span>secrets
  <span class="token comment"># RoleBinding çš„åå­—ç©ºé—´å†³å®šäº†è®¿é—®æƒé™çš„æˆäºˆèŒƒå›´ã€‚</span>
  <span class="token comment"># è¿™é‡Œéšå«æˆæƒä»…åœ¨ &quot;development&quot; åå­—ç©ºé—´å†…çš„è®¿é—®æƒé™ã€‚</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> development
<span class="token key atrule">subjects</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">kind</span><span class="token punctuation">:</span> User
  <span class="token key atrule">name</span><span class="token punctuation">:</span> dave <span class="token comment"># 'name' æ˜¯åŒºåˆ†å¤§å°å†™çš„</span>
  <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
<span class="token key atrule">roleRef</span><span class="token punctuation">:</span>
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
  <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>reader
  <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="clusterrolebindingç¤ºä¾‹"><a href="#clusterrolebindingç¤ºä¾‹" class="header-anchor">#</a> ClusterRoleBindingç¤ºä¾‹</h3> <p>è¦è·¨æ•´ä¸ªé›†ç¾¤å®Œæˆè®¿é—®æƒé™çš„æˆäºˆï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª ClusterRoleBindingã€‚ ä¸‹é¢çš„ ClusterRoleBinding å…è®¸ &quot;manager&quot; ç»„å†…çš„æ‰€æœ‰ç”¨æˆ·è®¿é—®ä»»ä½•åå­—ç©ºé—´ä¸­çš„ Secretsã€‚</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master role<span class="token punctuation">]</span><span class="token comment"># kubectl create clusterrolebinding read-secrets-global --clusterrole=secret-reader --group=manager  --dry-run -o yaml &gt; clusterrolebinding.yaml </span>

<span class="token punctuation">[</span>root@master role<span class="token punctuation">]</span><span class="token comment"># cat clusterrolebinding.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRoleBinding			<span class="token comment"># æ­¤é›†ç¾¤è§’è‰²ç»‘å®šå…è®¸ â€œmanagerâ€ ç»„ä¸­çš„ä»»ä½•äººè®¿é—®ä»»ä½•åå­—ç©ºé—´ä¸­çš„ secrets</span>
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token null important">null</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> read<span class="token punctuation">-</span>secrets<span class="token punctuation">-</span>global
<span class="token key atrule">roleRef</span><span class="token punctuation">:</span>
  <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
  <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>reader
<span class="token key atrule">subjects</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> Group
  <span class="token key atrule">name</span><span class="token punctuation">:</span> manager
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>ç»‘å®šä¹‹åï¼Œä½ ä¸èƒ½å†ä¿®æ”¹ç»‘å®šå¯¹è±¡æ‰€å¼•ç”¨çš„Roleæˆ–ClusterRoleã€‚è¯•å›¾æ”¹å˜ç»‘å®šå¯¹è±¡çš„ roleRef å°†å¯¼è‡´åˆæ³•æ€§æ£€æŸ¥é”™è¯¯ã€‚å¦‚æœä½ æƒ³è¦æ”¹å˜ç°æœ‰ç»‘å®šå¯¹è±¡ä¸­ roleRefå­—æ®µçš„å†…å®¹ï¼Œå¿…é¡»åˆ é™¤é‡æ–°åˆ›å»ºç»‘å®šå¯¹è±¡ã€‚</code></p> <p>è¿™ç§é™åˆ¶æœ‰ä¸¤ä¸ªä¸»è¦åŸå› ï¼š</p> <ol><li>é’ˆå¯¹ä¸åŒè§’è‰²çš„ç»‘å®šæ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ç»‘å®šã€‚è¦æ±‚é€šè¿‡åˆ é™¤/é‡å»ºç»‘å®šæ¥æ›´æ”¹ <code>roleRef</code>, è¿™æ ·å¯ä»¥ç¡®ä¿è¦èµ‹äºˆç»‘å®šçš„æ‰€æœ‰ä¸»ä½“ä¼šè¢«æˆäºˆæ–°çš„è§’è‰²ï¼ˆè€Œä¸æ˜¯åœ¨å…è®¸æˆ–è€…ä¸å°å¿ƒä¿®æ”¹ äº† <code>roleRef</code> çš„æƒ…å†µä¸‹å¯¼è‡´æ‰€æœ‰ç°æœ‰ä¸»ä½“æœªç»éªŒè¯å³è¢«æˆäºˆæ–°è§’è‰²å¯¹åº”çš„æƒé™ï¼‰ã€‚</li> <li>å°† <code>roleRef</code> è®¾ç½®ä¸ºä¸å¯ä»¥æ”¹å˜ï¼Œè¿™ä½¿å¾—å¯ä»¥ä¸ºç”¨æˆ·æˆäºˆå¯¹ç°æœ‰ç»‘å®šå¯¹è±¡çš„ <code>update</code> æƒé™ï¼Œ è¿™æ ·å¯ä»¥è®©ä»–ä»¬ç®¡ç†ä¸»ä½“åˆ—è¡¨ï¼ŒåŒæ—¶ä¸èƒ½æ›´æ”¹è¢«æˆäºˆè¿™äº›ä¸»ä½“çš„è§’è‰²ã€‚</li></ol> <p><code>pods</code>å¯¹åº”åå­—ç©ºé—´ä½œç”¨åŸŸçš„Podèµ„æºï¼Œè€Œ <code>log</code> æ˜¯ <code>pods</code>çš„å­èµ„æºã€‚åœ¨RBACè§’è‰²è¡¨è¾¾å­èµ„æºæ—¶ï¼Œä½¿ç”¨æ–œçº¿ï¼ˆ<code>/</code>ï¼‰æ¥åˆ†éš”èµ„æºå’Œå­èµ„æºã€‚è¦å…è®¸æŸä¸»ä½“è¯»å– <code>pods</code> åŒæ—¶è®¿é—®è¿™äº›Podçš„ <code>log</code> å­èµ„æº</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Role
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pod<span class="token punctuation">-</span>and<span class="token punctuation">-</span>pod<span class="token punctuation">-</span>logs<span class="token punctuation">-</span>reader
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;pods&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pods/log&quot;</span><span class="token punctuation">]</span>			<span class="token comment">#pods/logæ˜¯podçš„èµ„æº</span>
  <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">]</span>
 
<span class="token comment">#ä¹Ÿå¯ä»¥é€šè¿‡ resourceNames åˆ—è¡¨æŒ‰åç§°å¼•ç”¨èµ„æºã€‚</span>
<span class="token comment">#åœ¨ HTTP å±‚é¢ï¼Œç”¨æ¥è®¿é—® ConfigMap çš„èµ„æºçš„åç§°ä¸º &quot;configmaps&quot;</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;configmaps&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">resourceNames</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;my-configmap&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;update&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="èšåˆçš„-clusterrole"><a href="#èšåˆçš„-clusterrole" class="header-anchor">#</a> èšåˆçš„ ClusterRole</h3> <p>ä½ å¯ä»¥å°†è‹¥å¹² ClusterRole <strong>èšåˆï¼ˆAggregateï¼‰</strong> èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå¤åˆçš„ ClusterRoleã€‚ æŸä¸ªæ§åˆ¶å™¨ä½œä¸ºé›†ç¾¤æ§åˆ¶é¢çš„ä¸€éƒ¨åˆ†ä¼šç›‘è§†å¸¦æœ‰ <code>aggregationRule</code> çš„ ClusterRole å¯¹è±¡é›†åˆã€‚<code>aggregationRule</code> ä¸ºæ§åˆ¶å™¨å®šä¹‰ä¸€ä¸ªæ ‡ç­¾ <a href="https://kubernetes.io/zh/docs/concepts/overview/working-with-objects/labels/" target="_blank" rel="noopener noreferrer">é€‰æ‹©ç®—ç¬¦<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¾›åè€…åŒ¹é… åº”è¯¥ç»„åˆåˆ°å½“å‰ ClusterRole çš„ <code>roles</code> å­—æ®µä¸­çš„ ClusterRole å¯¹è±¡ã€‚</p> <p>ä¸‹é¢æ˜¯ä¸€ä¸ªèšåˆ ClusterRole çš„ç¤ºä¾‹ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> monitoring
<span class="token key atrule">aggregationRule</span><span class="token punctuation">:</span>
  <span class="token key atrule">clusterRoleSelectors</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">rbac.example.com/aggregate-to-monitoring</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
<span class="token key atrule">rules</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># æ§åˆ¶é¢è‡ªåŠ¨å¡«å……è¿™é‡Œçš„è§„åˆ™</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>å¦‚æœä½ åˆ›å»ºä¸€ä¸ªä¸æŸç°æœ‰èšåˆ ClusterRole çš„æ ‡ç­¾é€‰æ‹©ç®—ç¬¦åŒ¹é…çš„ ClusterRoleï¼Œ è¿™ä¸€å˜åŒ–ä¼šè§¦å‘æ–°çš„è§„åˆ™è¢«æ·»åŠ åˆ°èšåˆ ClusterRole çš„æ“ä½œã€‚</li> <li>é»˜è®¤çš„<a href="https://kubernetes.io/zh/docs/reference/access-authn-authz/rbac/#default-roles-and-role-bindings" target="_blank" rel="noopener noreferrer">é¢å‘ç”¨æˆ·çš„è§’è‰²<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä½¿ç”¨ ClusterRole èšåˆã€‚ è¿™ä½¿å¾—ä½œä¸ºé›†ç¾¤ç®¡ç†å‘˜çš„ä½ å¯ä»¥ä¸ºæ‰©å±•é»˜è®¤è§„åˆ™ï¼ŒåŒ…æ‹¬ä¸ºå®šåˆ¶èµ„æºè®¾ç½®è§„åˆ™ï¼Œ æ¯”å¦‚é€šè¿‡ CustomResourceDefinitions æˆ–èšåˆ API æœåŠ¡å™¨æä¾›çš„å®šåˆ¶èµ„æºã€‚</li></ul> <p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ªæ ‡ç­¾åŒæ ·ä¸º <code>rbac.example.com/aggregate-to-monitoring: true</code> çš„ ClusterRoleï¼Œæ–°çš„è§„åˆ™å¯è¢«æ·»åŠ åˆ° &quot;monitoring&quot; ClusterRole ä¸­ã€‚</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> monitoring<span class="token punctuation">-</span>endpoints
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">rbac.example.com/aggregate-to-monitoring</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
<span class="token comment"># å½“ä½ åˆ›å»º &quot;monitoring-endpoints&quot; ClusterRole æ—¶ï¼Œ</span>
<span class="token comment"># ä¸‹é¢çš„è§„åˆ™ä¼šè¢«æ·»åŠ åˆ° &quot;monitoring&quot; ClusterRole ä¸­</span>
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;services&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;endpoints&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pods&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;watch&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><code>ä¸‹é¢çš„ClusterRolesè®©é»˜è®¤è§’è‰² &quot;admin&quot;å’Œ&quot;edit&quot;æ‹¥æœ‰ç®¡ç†è‡ªå®šä¹‰èµ„æº &quot;CronTabs&quot; çš„æƒé™ï¼Œ&quot;view&quot; è§’è‰²å¯¹ CronTabèµ„æºæ‹¥æœ‰è¯»æ“ä½œæƒé™ã€‚ä½ å¯ä»¥å‡å®šCronTabå¯¹è±¡åœ¨APIæœåŠ¡å™¨æ‰€çœ‹åˆ°çš„URLä¸­è¢«å‘½åä¸º &quot;crontabs&quot;ã€‚</code></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> aggregate<span class="token punctuation">-</span>cron<span class="token punctuation">-</span>tabs<span class="token punctuation">-</span>edit
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token comment"># æ·»åŠ ä»¥ä¸‹æƒé™åˆ°é»˜è®¤è§’è‰² &quot;admin&quot; å’Œ &quot;edit&quot; ä¸­</span>
    <span class="token key atrule">rbac.authorization.k8s.io/aggregate-to-admin</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
    <span class="token key atrule">rbac.authorization.k8s.io/aggregate-to-edit</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;stable.example.com&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;crontabs&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;watch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;create&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;update&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;patch&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;delete&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">---</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> aggregate<span class="token punctuation">-</span>cron<span class="token punctuation">-</span>tabs<span class="token punctuation">-</span>view
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token comment"># æ·»åŠ ä»¥ä¸‹æƒé™åˆ° &quot;view&quot; é»˜è®¤è§’è‰²ä¸­</span>
    <span class="token key atrule">rbac.authorization.k8s.io/aggregate-to-view</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;stable.example.com&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;crontabs&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;watch&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="é¢å‘ç”¨æˆ·çš„è§’è‰²"><a href="#é¢å‘ç”¨æˆ·çš„è§’è‰²" class="header-anchor">#</a> é¢å‘ç”¨æˆ·çš„è§’è‰²</h3> <ul><li>ä¸€äº›é»˜è®¤çš„ ClusterRole ä¸æ˜¯ä»¥å‰ç¼€ <code>system:</code> å¼€å¤´çš„ã€‚è¿™äº›æ˜¯é¢å‘ç”¨æˆ·çš„è§’è‰²ã€‚ å®ƒä»¬åŒ…æ‹¬è¶…çº§ç”¨æˆ·ï¼ˆSuper-Userï¼‰è§’è‰²ï¼ˆ<code>cluster-admin</code>ï¼‰ã€ ä½¿ç”¨ ClusterRoleBinding åœ¨é›†ç¾¤èŒƒå›´å†…å®Œæˆæˆæƒçš„è§’è‰²ï¼ˆ<code>cluster-status</code>ï¼‰ã€ ä»¥åŠä½¿ç”¨ RoleBinding åœ¨ç‰¹å®šåå­—ç©ºé—´ä¸­æˆäºˆçš„è§’è‰²ï¼ˆ<code>admin</code>ã€<code>edit</code>ã€<code>view</code>ï¼‰ã€‚</li> <li>é¢å‘ç”¨æˆ·çš„ ClusterRole ä½¿ç”¨ <a href="https://kubernetes.io/zh/docs/reference/access-authn-authz/rbac/#aggregated-clusterroles" target="_blank" rel="noopener noreferrer">ClusterRole èšåˆ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä»¥å…è®¸ç®¡ç†å‘˜åœ¨ è¿™äº› ClusterRole ä¸Šæ·»åŠ ç”¨äºå®šåˆ¶èµ„æºçš„è§„åˆ™ã€‚å¦‚æœæƒ³è¦æ·»åŠ è§„åˆ™åˆ° <code>admin</code>ã€<code>edit</code> æˆ–è€… <code>view</code>ï¼Œ å¯ä»¥åˆ›å»ºå¸¦æœ‰ä»¥ä¸‹ä¸€ä¸ªæˆ–å¤šä¸ªæ ‡ç­¾çš„ ClusterRoleï¼š</li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">rbac.authorization.k8s.io/aggregate-to-admin</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
    <span class="token key atrule">rbac.authorization.k8s.io/aggregate-to-edit</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
    <span class="token key atrule">rbac.authorization.k8s.io/aggregate-to-view</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="podçš„å®‰å…¨ç­–ç•¥"><a href="#podçš„å®‰å…¨ç­–ç•¥" class="header-anchor">#</a> Podçš„å®‰å…¨ç­–ç•¥</h2> <p><code>PodSecurityPolicy åœ¨ Kubernetes v1.21 ç‰ˆæœ¬ä¸­è¢«å¼ƒç”¨ï¼Œå°†åœ¨ v1.25 ä¸­åˆ é™¤ã€‚</code></p> <p>Pod å®‰å…¨ç­–ç•¥ä½¿å¾—å¯¹ Pod åˆ›å»ºå’Œæ›´æ–°è¿›è¡Œç»†ç²’åº¦çš„æƒé™æ§åˆ¶æˆä¸ºå¯èƒ½ã€‚</p> <h3 id="ä»€ä¹ˆæ˜¯podå®‰å…¨ç­–ç•¥"><a href="#ä»€ä¹ˆæ˜¯podå®‰å…¨ç­–ç•¥" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯Podå®‰å…¨ç­–ç•¥ï¼Ÿ</h3> <p><em>Pod å®‰å…¨ç­–ç•¥ï¼ˆPod Security Policyï¼‰</em> æ˜¯é›†ç¾¤çº§åˆ«çš„èµ„æºï¼Œå®ƒèƒ½å¤Ÿæ§åˆ¶ Pod è§„çº¦ ä¸­ä¸å®‰å…¨æ€§ç›¸å…³çš„å„ä¸ªæ–¹é¢ã€‚ <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#podsecuritypolicy-v1beta1-policy" target="_blank" rel="noopener noreferrer">PodSecurityPolicy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å¯¹è±¡å®šä¹‰äº†ä¸€ç»„ Pod è¿è¡Œæ—¶å¿…é¡»éµå¾ªçš„æ¡ä»¶åŠç›¸å…³å­—æ®µçš„é»˜è®¤å€¼ï¼Œåªæœ‰ Pod æ»¡è¶³è¿™äº›æ¡ä»¶ æ‰ä¼šè¢«ç³»ç»Ÿæ¥å—ã€‚ Pod å®‰å…¨ç­–ç•¥å…è®¸ç®¡ç†å‘˜æ§åˆ¶</p> <p><strong><em>Pod å®‰å…¨ç­–ç•¥</em> ç”±è®¾ç½®å’Œç­–ç•¥ç»„æˆï¼Œå®ƒä»¬èƒ½å¤Ÿæ§åˆ¶ Pod è®¿é—®çš„å®‰å…¨ç‰¹å¾ã€‚è¿™äº›è®¾ç½®åˆ†ä¸ºå¦‚ä¸‹ä¸‰ç±»ï¼š</strong></p> <ul><li><em>åŸºäºå¸ƒå°”å€¼æ§åˆ¶</em> ï¼šè¿™ç§ç±»å‹çš„å­—æ®µé»˜è®¤ä¸ºæœ€ä¸¥æ ¼é™åˆ¶çš„å€¼ã€‚</li> <li><em>åŸºäºè¢«å…è®¸çš„å€¼é›†åˆæ§åˆ¶</em> ï¼šè¿™ç§ç±»å‹çš„å­—æ®µä¼šä¸è¿™ç»„å€¼è¿›è¡Œå¯¹æ¯”ï¼Œä»¥ç¡®è®¤å€¼è¢«å…è®¸ã€‚</li> <li><em>åŸºäºç­–ç•¥æ§åˆ¶</em> ï¼šè®¾ç½®é¡¹é€šè¿‡ä¸€ç§ç­–ç•¥æä¾›çš„æœºåˆ¶æ¥ç”Ÿæˆè¯¥å€¼ï¼Œè¿™ç§æœºåˆ¶èƒ½å¤Ÿç¡®ä¿æŒ‡å®šçš„å€¼è½åœ¨è¢«å…è®¸çš„è¿™ç»„å€¼ä¸­ã€‚</li></ul> <h3 id="å¯ç”¨podå®‰å…¨ç­–ç•¥"><a href="#å¯ç”¨podå®‰å…¨ç­–ç•¥" class="header-anchor">#</a> å¯ç”¨Podå®‰å…¨ç­–ç•¥</h3> <p>Pod å®‰å…¨ç­–ç•¥å®ç°ä¸ºä¸€ç§å¯é€‰çš„ <a href="https://kubernetes.io/zh/docs/reference/access-authn-authz/admission-controllers/#podsecuritypolicy" target="_blank" rel="noopener noreferrer">å‡†å…¥æ§åˆ¶å™¨<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚ <a href="https://kubernetes.io/zh/docs/reference/access-authn-authz/admission-controllers/#how-do-i-turn-on-an-admission-control-plug-in" target="_blank" rel="noopener noreferrer">å¯ç”¨äº†å‡†å…¥æ§åˆ¶å™¨<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å³å¯å¼ºåˆ¶å®æ–½ Pod å®‰å…¨ç­–ç•¥ï¼Œä¸è¿‡å¦‚æœæ²¡æœ‰æˆæƒè®¤å¯ç­–ç•¥ä¹‹å‰å³å¯ç”¨å‡†å…¥æ§åˆ¶å™¨å°†å¯¼è‡´é›†ç¾¤ä¸­æ— æ³•åˆ›å»ºä»»ä½• Podã€‚</p> <p>ç”±äºPodå®‰å…¨ç­–ç•¥APIï¼ˆ<code>policy/v1beta1/podsecuritypolicy</code>ï¼‰æ˜¯ç‹¬ç«‹äºå‡†å…¥æ§åˆ¶å™¨ æ¥å¯ç”¨çš„ï¼Œå¯¹äºç°æœ‰é›†ç¾¤è€Œè¨€ï¼Œå»ºè®®åœ¨å¯ç”¨å‡†å…¥æ§åˆ¶å™¨ä¹‹å‰å…ˆæ·»åŠ ç­–ç•¥å¹¶å¯¹å…¶æˆæƒã€‚</p> <h3 id="æˆæƒç­–ç•¥"><a href="#æˆæƒç­–ç•¥" class="header-anchor">#</a> æˆæƒç­–ç•¥</h3> <p>PodSecurityPolicy èµ„æºè¢«åˆ›å»ºæ—¶ï¼Œå¹¶ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ä¸ºäº†ä½¿ç”¨è¯¥èµ„æºï¼Œéœ€è¦å¯¹ å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·æˆ–è€…ç›®æ ‡ Pod çš„ <a href="https://kubernetes.io/zh/docs/tasks/configure-pod-container/configure-service-account/" target="_blank" rel="noopener noreferrer">æœåŠ¡è´¦å·<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æˆæƒï¼Œé€šè¿‡å…è®¸å…¶å¯¹ç­–ç•¥æ‰§è¡Œ <code>use</code> åŠ¨è¯å…è®¸å…¶ä½¿ç”¨è¯¥ç­–ç•¥ã€‚</p> <p>å¤§å¤šæ•° Kubernetes Pod ä¸æ˜¯ç”±ç”¨æˆ·ç›´æ¥åˆ›å»ºçš„ã€‚ç›¸åï¼Œè¿™äº› Pod æ˜¯ç”± <a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/" target="_blank" rel="noopener noreferrer">Deployment<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€ <a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/replicaset/" target="_blank" rel="noopener noreferrer">ReplicaSet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æˆ–è€…ç»ç”±æ§åˆ¶å™¨ç®¡ç†å™¨æ¨¡ç‰ˆåŒ–çš„æ§åˆ¶å™¨åˆ›å»ºã€‚</p> <p>èµ‹äºˆæ§åˆ¶å™¨è®¿é—®ç­–ç•¥çš„æƒé™æ„å‘³ç€å¯¹åº”æ§åˆ¶å™¨æ‰€åˆ›å»ºçš„ <em>æ‰€æœ‰</em> Pod éƒ½å¯è®¿é—®ç­–ç•¥ã€‚ å› æ­¤ï¼Œå¯¹ç­–ç•¥è¿›è¡Œæˆæƒçš„ä¼˜å…ˆæ–¹æ¡ˆæ˜¯ä¸º Pod çš„æœåŠ¡è´¦å·æˆäºˆè®¿é—®æƒé™</p> <h3 id="é…ç½®"><a href="#é…ç½®" class="header-anchor">#</a> é…ç½®</h3> <p>ä¸ºè¿è¡Œæ­¤ç¤ºä¾‹ï¼Œé…ç½®ä¸€ä¸ªåå­—ç©ºé—´å’Œä¸€ä¸ªæœåŠ¡è´¦å·ã€‚æˆ‘ä»¬å°†ç”¨è¿™ä¸ªæœåŠ¡è´¦å·æ¥ æ¨¡æ‹Ÿä¸€ä¸ªéç®¡ç†å‘˜è´¦å·çš„ç”¨æˆ·ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl create namespace psp-example</span>
<span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl create serviceaccount -n psp-example fake-user</span>
<span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl create rolebinding -n psp-example fake-editor --clusterrole=edit --serviceaccount=psp-example:fake-user</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>åˆ›å»ºä¸¤ä¸ªåˆ«åï¼Œä»¥æ›´æ¸…æ™°åœ°å±•ç¤ºæˆ‘ä»¬æ‰€ä½¿ç”¨çš„ç”¨æˆ·è´¦å·ï¼ŒåŒæ—¶å‡å°‘ä¸€äº›é”®ç›˜è¾“å…¥ï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># alias kubectl-admin='kubectl -n psp-example'</span>
<span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># alias kubectl-user='kubectl --as=system:serviceaccount:psp-example:fake-user -n psp-example'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="åˆ›å»ºä¸€ä¸ªç­–ç•¥å’Œä¸€ä¸ªpod"><a href="#åˆ›å»ºä¸€ä¸ªç­–ç•¥å’Œä¸€ä¸ªpod" class="header-anchor">#</a> åˆ›å»ºä¸€ä¸ªç­–ç•¥å’Œä¸€ä¸ªPod</h3> <p>åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªç¤ºä¾‹çš„ PodSecurityPolicy å¯¹è±¡ã€‚ è¿™é‡Œçš„ç­–ç•¥åªæ˜¯ç”¨æ¥ç¦æ­¢åˆ›å»ºæœ‰ç‰¹æƒè¦æ±‚çš„ Podsã€‚</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># cat podsecuritypolicy.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> policy/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> PodSecurityPolicy
<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  <span class="token key atrule">name</span><span class="token punctuation">:</span> example 
<span class="token key atrule">spec</span><span class="token punctuation">:</span> 
  <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> 		<span class="token comment"># Don't allow privileged pods!</span>
  <span class="token key atrule">seLinux</span><span class="token punctuation">:</span> 					<span class="token comment"># å…¶ä½™éƒ¨åˆ†å¡«å†™ä¸€äº›å¿…å¡«å­—æ®µ</span>
    <span class="token key atrule">rule</span><span class="token punctuation">:</span> RunAsAny 
  <span class="token key atrule">supplementalGroups</span><span class="token punctuation">:</span>
    <span class="token key atrule">rule</span><span class="token punctuation">:</span> RunAsAny
  <span class="token key atrule">runAsUser</span><span class="token punctuation">:</span> 
    <span class="token key atrule">rule</span><span class="token punctuation">:</span> RunAsAny
  <span class="token key atrule">fsGroup</span><span class="token punctuation">:</span> 
    <span class="token key atrule">rule</span><span class="token punctuation">:</span> RunAsAny
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">'*'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>ä½¿ç”¨ kubectl æ‰§è¡Œåˆ›å»ºæ“ä½œï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl-admin create -f podsecuritypolicy.yaml</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç°åœ¨ï¼Œä½œä¸ºä¸€ä¸ªéç‰¹æƒç”¨æˆ·ï¼Œå°è¯•åˆ›å»ºä¸€ä¸ªç®€å•çš„ Podï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>kubectl<span class="token punctuation">-</span>user create <span class="token punctuation">-</span>f<span class="token punctuation">-</span> &lt;&lt;EOF
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pause
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> pause
      <span class="token key atrule">image</span><span class="token punctuation">:</span> k8s.gcr.io/pause
EOF
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>è¾“å‡ºç±»ä¼¼äºï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>Error from server <span class="token punctuation">(</span>Forbidden<span class="token punctuation">)</span>: error when creating <span class="token string">&quot;STDIN&quot;</span><span class="token builtin class-name">:</span> pods <span class="token string">&quot;pause&quot;</span> is forbidden: unable to validate against any pod security policy: <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å°½ç®¡ PodSecurityPolicy è¢«åˆ›å»ºï¼ŒPod çš„æœåŠ¡è´¦å·æˆ–è€… <code>fake-user</code> ç”¨æˆ·éƒ½æ²¡æœ‰ä½¿ç”¨è¯¥ç­–ç•¥çš„æƒé™ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl-user auth can-i use podsecuritypolicy/example</span>
Warning: resource <span class="token string">'podsecuritypolicies'</span> is not namespace scoped <span class="token keyword">in</span> group <span class="token string">'policy'</span>
no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="å‘½åç©ºé—´ä¸‹podé…é¢"><a href="#å‘½åç©ºé—´ä¸‹podé…é¢" class="header-anchor">#</a> å‘½åç©ºé—´ä¸‹Podé…é¢</h2> <p>Resource Quotasï¼ˆèµ„æºé…é¢ï¼Œç®€ç§°quotaï¼‰<code>æ˜¯å¯¹namespaceè¿›è¡Œèµ„æºé…é¢ï¼Œé™åˆ¶èµ„æºä½¿ç”¨çš„ä¸€ç§ç­–ç•¥ã€‚</code></p> <p>K8Sæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·æ¶æ„ï¼Œå½“å¤šç”¨æˆ·æˆ–è€…å›¢é˜Ÿå…±äº«ä¸€ä¸ªK8Sç³»ç»Ÿæ—¶ï¼ŒSAä½¿ç”¨quotaé˜²æ­¢ç”¨æˆ·ï¼ˆåŸºäºnamespaceçš„ï¼‰çš„èµ„æºæŠ¢å ï¼Œå®šä¹‰å¥½èµ„æºåˆ†é…ç­–ç•¥ã€‚</p> <p>Quotaåº”ç”¨åœ¨Namespaceä¸Šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰Resource Quotaçš„ï¼Œéœ€è¦å¦å¤–åˆ›å»ºQuotaï¼Œ<code>å¹¶ä¸”æ¯ä¸ªNamespaceæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªQuotaå¯¹è±¡ã€‚</code></p> <h3 id="åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´"><a href="#åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´" class="header-anchor">#</a> åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´</h3> <p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ï¼Œè¿™æ ·å¯ä»¥å°†æœ¬æ¬¡æ“ä½œä¸­åˆ›å»ºçš„èµ„æºä¸é›†ç¾¤å…¶ä»–èµ„æºéš”ç¦»å¼€æ¥ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl create namespace quota-pod-example </span>
namespace/quota-pod-example created
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="åˆ›å»ºresourcequota"><a href="#åˆ›å»ºresourcequota" class="header-anchor">#</a> åˆ›å»ºResourceQuota</h3> <p><code>åˆ›å»ºä¸€ä¸ªquotaé™åˆ¶æœ€å¤§çš„podæ•°é‡æ˜¯2ä¸ª</code></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl create quota pod-demo --hard=pods=2 --namespace=quota-pod-example --dry-run -o yaml &gt; quota.yaml       </span>

<span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># cat quota.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ResourceQuota
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token null important">null</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pod<span class="token punctuation">-</span>demo
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> quota<span class="token punctuation">-</span>pod<span class="token punctuation">-</span>example
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">hard</span><span class="token punctuation">:</span>
    <span class="token key atrule">pods</span><span class="token punctuation">:</span> <span class="token string">&quot;2&quot;</span>
<span class="token key atrule">status</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="éªŒè¯è¯¥èµ„æºé™åˆ¶"><a href="#éªŒè¯è¯¥èµ„æºé™åˆ¶" class="header-anchor">#</a> éªŒè¯è¯¥èµ„æºé™åˆ¶</h3> <p><code>è¿™é‡Œä½¿ç”¨deploymentçš„æ§åˆ¶å™¨æ¥åˆ›å»º3ä¸ªPod</code>ï¼Œæ­¤æ—¶ä¼šå‘ç°ï¼Œdeploymentçš„podè¢«é™åˆ¶æˆ2ä¸ªpod</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl create deployment nginx --image=172.25.253.3/library/nginx --replicas=3 --namespace quota-pod-example </span>
deployment.apps/nginx created

<span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl get deployments.apps -n quota-pod-example  </span>
NAME    READY   UP-TO-DATE   AVAILABLE   AGE
nginx   <span class="token number">2</span>/3     <span class="token number">2</span>            <span class="token number">2</span>           11s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="æ¸…ç†"><a href="#æ¸…ç†" class="header-anchor">#</a> æ¸…ç†</h3> <p>åˆ é™¤å‘½åç©ºé—´</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl delete namespaces quota-pod-example </span>
namespace <span class="token string">&quot;quota-pod-example&quot;</span> deleted
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="é…ç½®apiå¯¹è±¡é…é¢"><a href="#é…ç½®apiå¯¹è±¡é…é¢" class="header-anchor">#</a> é…ç½®APIå¯¹è±¡é…é¢</h2> <h3 id="åˆ›å»ºå‘½åç©ºé—´"><a href="#åˆ›å»ºå‘½åç©ºé—´" class="header-anchor">#</a> åˆ›å»ºå‘½åç©ºé—´</h3> <p>åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ä»¥ä¾¿æœ¬ä¾‹ä¸­åˆ›å»ºçš„èµ„æºå’Œé›†ç¾¤ä¸­çš„å…¶ä½™éƒ¨åˆ†ç›¸éš”ç¦»ã€‚</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl create namespace quota-object-example</span>
namespace/quota-object-example created
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="åˆ›å»ºresourcequota-2"><a href="#åˆ›å»ºresourcequota-2" class="header-anchor">#</a> åˆ›å»ºResourceQuota</h3> <p>ä¸‹é¢æ˜¯ä¸€ä¸ª ResourceQuota å¯¹è±¡çš„é…ç½®æ–‡ä»¶</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl create quota object-quota-demo --namespace quota-object-example --hard=persistentvolumeclaims=1,services.loadbalancers=2,services.nodeports=0 --dry-run -o yaml &gt; quota-api.yaml                  </span>

<span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># cat  quota-api.yaml    </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ResourceQuota
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token null important">null</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> object<span class="token punctuation">-</span>quota<span class="token punctuation">-</span>demo
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> quota<span class="token punctuation">-</span>object<span class="token punctuation">-</span>example
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">hard</span><span class="token punctuation">:</span>
    <span class="token key atrule">persistentvolumeclaims</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span>
    <span class="token key atrule">services.loadbalancers</span><span class="token punctuation">:</span> <span class="token string">&quot;2&quot;</span>
    <span class="token key atrule">services.nodeports</span><span class="token punctuation">:</span> <span class="token string">&quot;0&quot;</span>
<span class="token key atrule">status</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f quota-api.yaml </span>
resourcequota/object<span class="token punctuation">-</span>quota<span class="token punctuation">-</span>demo created
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>æŸ¥çœ‹ ResourceQuota çš„è¯¦ç»†ä¿¡æ¯ï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>kubectl get resourcequota object-quota-demo --namespace<span class="token operator">=</span>quota-object-example --output<span class="token operator">=</span>yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¾“å‡ºç»“æœè¡¨æ˜åœ¨ quota-object-example å‘½åç©ºé—´ä¸­ï¼Œè‡³å¤šåªèƒ½æœ‰ä¸€ä¸ª PersistentVolumeClaimï¼Œ æœ€å¤šä¸¤ä¸ª LoadBalancer ç±»å‹çš„æœåŠ¡ï¼Œä¸èƒ½æœ‰ NodePort ç±»å‹çš„æœåŠ¡ã€‚</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">hard</span><span class="token punctuation">:</span>
    <span class="token key atrule">persistentvolumeclaims</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span>
    <span class="token key atrule">services.loadbalancers</span><span class="token punctuation">:</span> <span class="token string">&quot;2&quot;</span>
    <span class="token key atrule">services.nodeports</span><span class="token punctuation">:</span> <span class="token string">&quot;0&quot;</span>
  <span class="token key atrule">used</span><span class="token punctuation">:</span>
    <span class="token key atrule">persistentvolumeclaims</span><span class="token punctuation">:</span> <span class="token string">&quot;0&quot;</span>
    <span class="token key atrule">services.loadbalancers</span><span class="token punctuation">:</span> <span class="token string">&quot;0&quot;</span>
    <span class="token key atrule">services.nodeports</span><span class="token punctuation">:</span> <span class="token string">&quot;0&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="åˆ›å»ºpersistentvolumeclaim"><a href="#åˆ›å»ºpersistentvolumeclaim" class="header-anchor">#</a> åˆ›å»ºPersistentVolumeClaim</h3> <p>ä¸‹é¢æ˜¯ä¸€ä¸ª PersistentVolumeClaim å¯¹è±¡çš„é…ç½®æ–‡ä»¶ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># cat pvc.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> PersistentVolumeClaim
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> quota<span class="token punctuation">-</span>object<span class="token punctuation">-</span>example
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pvc<span class="token punctuation">-</span>quota<span class="token punctuation">-</span>demo
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">storageClassName</span><span class="token punctuation">:</span> manual
  <span class="token key atrule">accessModes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ReadWriteOnce
  <span class="token key atrule">resources</span><span class="token punctuation">:</span>
    <span class="token key atrule">requests</span><span class="token punctuation">:</span>
      <span class="token key atrule">storage</span><span class="token punctuation">:</span> 3Gi

<span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f pvc.yaml </span>
persistentvolumeclaim/pvc<span class="token punctuation">-</span>quota<span class="token punctuation">-</span>demo created
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>è¾“å‡ºä¿¡æ¯è¡¨æ˜ PersistentVolumeClaim å­˜åœ¨å¹¶ä¸”å¤„äº Pending çŠ¶æ€ï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl get pvc -n quota-object-example</span>
NAME             STATUS    VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS   AGE
pvc-quota-demo   Pending                                      manual         6s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="å°è¯•åˆ›å»ºç¬¬äºŒä¸ªpersistentvolumeclaim"><a href="#å°è¯•åˆ›å»ºç¬¬äºŒä¸ªpersistentvolumeclaim" class="header-anchor">#</a> å°è¯•åˆ›å»ºç¬¬äºŒä¸ªPersistentVolumeClaim</h3> <p>ä¸‹é¢æ˜¯ç¬¬äºŒä¸ª PersistentVolumeClaim çš„é…ç½®æ–‡ä»¶ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># vim pvc.yaml              </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> PersistentVolumeClaim
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> quota<span class="token punctuation">-</span>object<span class="token punctuation">-</span>example
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pvc<span class="token punctuation">-</span>quota<span class="token punctuation">-</span>demo2
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">storageClassName</span><span class="token punctuation">:</span> manual
  <span class="token key atrule">accessModes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ReadWriteOnce
  <span class="token key atrule">resources</span><span class="token punctuation">:</span>
    <span class="token key atrule">requests</span><span class="token punctuation">:</span>
      <span class="token key atrule">storage</span><span class="token punctuation">:</span> 4Gi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>å°è¯•åˆ›å»ºç¬¬äºŒä¸ª PersistentVolumeClaimï¼š</p> <p><code>è¾“å‡ºä¿¡æ¯è¡¨æ˜ç¬¬äºŒä¸ª PersistentVolumeClaim æ²¡æœ‰åˆ›å»ºæˆåŠŸï¼Œå› ä¸ºè¿™ä¼šè¶…å‡ºå‘½åç©ºé—´çš„é…é¢ã€‚</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master pod<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f pvc.yaml</span>
Error from server <span class="token punctuation">(</span>Forbidden<span class="token punctuation">)</span>: error when creating <span class="token string">&quot;pvc.yaml&quot;</span><span class="token builtin class-name">:</span> persistentvolumeclaims <span class="token string">&quot;pvc-quota-demo3&quot;</span> is forbidden: exceeded quota: object-quota-demo, requested: <span class="token assign-left variable">persistentvolumeclaims</span><span class="token operator">=</span><span class="token number">1</span>, used: <span class="token assign-left variable">persistentvolumeclaims</span><span class="token operator">=</span><span class="token number">1</span>, limited: <span class="token assign-left variable">persistentvolumeclaims</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/isicman/Vue/edit/master/docs/ã€ŠKubernetesã€‹å­¦ä¹ ç¬”è®°/01.å­¦ä¹ ç¬”è®°/14.é«˜çº§è¿ç»´.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/Vue/tags/?tag=Kubernetes" title="æ ‡ç­¾">#Kubernetes</a></div> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/Vue/pages/d13a63/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">HelmåŒ…ç®¡ç†</div></a> <a href="/Vue/pages/79ca6c/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">NFSåšKubernetesçš„åç«¯å­˜å‚¨</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/Vue/pages/d13a63/" class="prev">HelmåŒ…ç®¡ç†</a></span> <span class="next"><a href="/Vue/pages/79ca6c/">NFSåšKubernetesçš„åç«¯å­˜å‚¨</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/Vue/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/Vue/pages/ace346/"><div>
            SpringBooté…ç½®æ–‡ä»¶
            <!----></div></a> <span class="date">07-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/Vue/pages/69a126/"><div>
            æ•´åˆJunitå’ŒMybatis
            <!----></div></a> <span class="date">07-27</span></dt></dl><dl><dd>03</dd> <dt><a href="/Vue/pages/3e651a/"><div>
            SpringBootå¿«é€Ÿå…¥é—¨
            <!----></div></a> <span class="date">07-27</span></dt></dl> <dl><dd></dd> <dt><a href="/Vue/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2019-2022
    <span>Evan Xu | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><canvas id="vuepress-canvas-cursor"></canvas><div></div></div></div>
    <script src="/Vue/assets/js/app.2f1a3b6e.js" defer></script><script src="/Vue/assets/js/2.3b495877.js" defer></script><script src="/Vue/assets/js/3.0279f92a.js" defer></script><script src="/Vue/assets/js/154.9cabe557.js" defer></script><script src="/Vue/assets/js/4.cb69b0f7.js" defer></script>
  </body>
</html>
