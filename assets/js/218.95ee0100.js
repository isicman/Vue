(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{698:function(s,a,t){"use strict";t.r(a);var e=t(19),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"vpnaas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vpnaas"}},[s._v("#")]),s._v(" VPNaaS")]),s._v(" "),t("p",[s._v("在Openstack的Havana版本中，neutron增加的一个功能就是VPNaas，将VPN功能引入到了neutron中，虽然在Havana版中只支持IPSec协议的VPN，功能还比较弱，但这个关键特性已经有了，后续会不断加强该特性，在这次的design summit会议上也有专门议题讨论了icehouce版本中VPNaas会做什么，具体可以参考"),t("a",{attrs:{href:"https://etherpad.openstack.org/p/NeutronVPNaaSIceHouse",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),t("OutboundLink")],1),s._v("，在介绍VPNaas之前，先简单说一下VPN的一些基本概念。")]),s._v(" "),t("h2",{attrs:{id:"vpn介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vpn介绍"}},[s._v("#")]),s._v(" VPN介绍")]),s._v(" "),t("p",[t("strong",[s._v("什么是VPN？")])]),s._v(" "),t("p",[s._v("VPN可以通过在L2或L3层建立一条逻辑链路让广域网上多个内网能够相互访问。VPN的实现方式很多，有基于租用专用物理线路实现的（如帧中继和ATM，因为是专用线路，贵啊，但QoS好，对语音等对延迟敏感的数据流至关重要，可运行上层的IP,IPX, AppleTalk,IP多播多种协议），也有基于以太网的虚连接的实现方式（不是专用线路，灵活，数据通道不安全要结合如IPSec来保证）")]),s._v(" "),t("ul",[t("li",[s._v("ATM和帧中继都是L2层VPN")]),s._v(" "),t("li",[s._v("GRE，L2TP，MPLS和IPSec属于L3层VPN技术")])]),s._v(" "),t("p",[t("code",[s._v("GRE VPN：")]),s._v("建VPN很方便，但没有安全机制，需结合IPSec来支持身份验证、完整性、访问控制和机密性。\n"),t("code",[s._v("SSL VPN：")]),s._v("这种VPN的最大好处在于，仅需要一个单独的TCP或UDP端口便可以轻易穿越大多数防火墙进行数据传送\n"),t("code",[s._v("MPLS VPN：")]),s._v("当使用GRE这些遂道技术来实现VPN时，因为是点至点的，当新添一个站点，需修改每个站点的VPN配置。MPLS是在传数据之前就先用L3层的路由机制将L2层的标签在途径的每个路由器上都事先算好了，并且这种标签是自动配置的，所以添加一个新站点很方便")]),s._v(" "),t("h2",{attrs:{id:"ipsec-vpn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ipsec-vpn"}},[s._v("#")]),s._v(" IPSec VPN")]),s._v(" "),t("p",[s._v("在Havana版本中仅实现了IPSec VPN，为了方便在neutron中操作VPNaas，先介绍IPSec的一些基本概念。\nIPSec的使用模式：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("IPSec传输模式：")]),s._v("传输过程中IPSec源端点不会修改IP报中的目标IP地址。")]),s._v(" "),t("li",[t("code",[s._v("IPSec遂道模式：")]),s._v("传输过程中IPSec源端点会修改IP报中的目标IP地址。\n在neutron中使用的就是IPSec的遂道模式。")])]),s._v(" "),t("p",[s._v("IPSec中的两个重要协议：")]),s._v(" "),t("ul",[t("li",[s._v("AH：它使用消息摘要算法生成一个散列值，包括不变的报头字段（如源IP，目标IP），不同于ESP，不提供机密性，即不加密数据本身，所以不是很有用。计算报头摘要时要排除一些可变字段（如服务类型ToS，标记，分段偏移、存活时间TTL和报头校验和）。关于IPSec与NAT，NAT要发挥作用，它可能要修改IP源地址、目标地址、源端口、目标端口、IP和TCP报头的校验和、TCP序列号和确认号以及有效负载中的IP地址。因为，使用AH时，NAT不可行。")]),s._v(" "),t("li",[s._v("ESP：提供机密性、数据完整性、数据来源验证和反重放功能。对于IPSec传输模式，使用ESP时NAT依然不可行。但在遂道模式下，只要NAT执行1：1的地址转换，不将多个内网地址转换一个外部地址并使用端口来区分它们，NAT和ESP便可以共存。一个最简单的办法就是在IPSec之间执行NAT，但这并非总是可能的，所以有了NAT跨越技术（NAT Traversal, NAT-T)，它由三部分组成，首先判断远程peer是否支持NAT跨越，其次是检测peer之间的路径上是否有NAT；最后是决定如何使用UDP封闭来处理NAT。")])]),s._v(" "),t("h2",{attrs:{id:"ipsec-ike密钥交换协议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ipsec-ike密钥交换协议"}},[s._v("#")]),s._v(" IPsec IKE密钥交换协议")]),s._v(" "),t("p",[s._v("Internet 密钥交换（IPsec IKE）是 IPsec 体系结构中的一种主要协议。它是一种混合协议，使用部分 Oakley 和部分 SKEME，并协同 ISAKMP 提供密钥生成材料和其它安全连系，比如用于 IPsec DOI 的 AH 和 ESP 。")]),s._v(" "),t("h2",{attrs:{id:"vpn架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vpn架构"}},[s._v("#")]),s._v(" VPN架构")]),s._v(" "),t("p",[s._v("Neutron中VPN代码架构")]),s._v(" "),t("p",[s._v("下面介绍一下VPNaas在neutron中的实现，VPNaas的模块架构如下图所示")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205121252971.png",alt:"img"}})]),s._v(" "),t("p",[s._v("逻辑架构即在Network node的router上安装openswan来为内部的子网提供vpn服务")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205121252912.png",alt:"img"}})]),s._v(" "),t("h2",{attrs:{id:"vpn环境部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vpn环境部署"}},[s._v("#")]),s._v(" VPN环境部署")]),s._v(" "),t("p",[s._v("VPN服务可以为不同数据中内网互访提供服务，为了模拟这个场景，我创建了两套单独的openstack环境，环境信息如下。")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("OpenStack-1")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("OpenStasck-2")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("管理IP： 10.100.32.248")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("管理IP：   10.100.32.249")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("平台外网: 192.168.1.0/24")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("平台外网： 192.168.1.0/24")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("VPN内网: 10.10.10.0/24")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("VPN内网：10.10.20.0/24")])])])]),s._v(" "),t("h2",{attrs:{id:"vpn使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vpn使用"}},[s._v("#")]),s._v(" VPN使用")]),s._v(" "),t("p",[s._v("需要创建router和external network\nVPN服务是运行在三层网关上的，所以创建VPN之前要先创建一个router，并为这个router创建一个external network。 如果VPN关联的router没有external network，创建VPN服务时不会报错，但运行时会报错。")]),s._v(" "),t("blockquote",[t("p",[s._v("注意：")]),s._v(" "),t("p",[s._v("按照如上的环境，以下操作分别需要对两个OpenStack环境操作，VPN的内网不一样需要注意以下。")])]),s._v(" "),t("h3",{attrs:{id:"_1-创建路由网络"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建路由网络"}},[s._v("#")]),s._v(" 1.创建路由网络")]),s._v(" "),t("ul",[t("li",[s._v("分别需要创建外网和内网，外网使用flat模式，内网选择vxlan模式。")]),s._v(" "),t("li",[s._v("需要创建路由器分别绑定外网的接口，添加不同的内网接口")]),s._v(" "),t("li",[s._v("OpenStack环境1使用内网： "),t("code",[s._v("10.10.10.0/24")])]),s._v(" "),t("li",[s._v("OpenStack环境2使用内网： "),t("code",[s._v("10.10.20.0/24")])])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack network create \\")]),s._v("\n--provider-network-type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("flat "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--provider-physical-network"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("provider "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--external --share extnet\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack subnet create extnet-subnet \\")]),s._v("\n--network extnet "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--gateway "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--allocation-pool "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("start")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.10,end"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.254 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--subnet-range "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.0/24\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack network create \\")]),s._v("\n--provider-network-type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vxlan "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--provider-segment"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--internal "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--share intnet\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack subnet create intnet-subnet \\")]),s._v("\n--network intnet "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--subnet-range "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.0/24 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--gateway "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.1\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack router create Router")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack router add subnet Router intnet-subnet")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron router-gateway-set Router extnet --fixed-ip subnet_id=extnet-subnet,ip_address=192.168.1.224")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("p",[s._v("所有的网络环境：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack  network list ")]),s._v("\n+--------------------------------------+---------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Subnets                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+---------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 0c427edf-3bfb-483f-9419-be7d91a0e223 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" intnet  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e603abc5-41d3-4a4f-a4b8-75c72f505f8d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 6678be57-1f47-4c9f-bd64-e6540e0abc17 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" extnet  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 5ec4e1fc-989e-45df-83cc-675d53df7cc7 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" c3b4f236-cd71-41b6-9121-8edf07157174 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" intnet1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+---------+--------------------------------------+\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack subnet list ")]),s._v("\n+--------------------------------------+---------------+--------------------------------------+----------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Network                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Subnet         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+---------------+--------------------------------------+----------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 5ec4e1fc-989e-45df-83cc-675d53df7cc7 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" extnet-subnet "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 6678be57-1f47-4c9f-bd64-e6540e0abc17 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.0/24 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e603abc5-41d3-4a4f-a4b8-75c72f505f8d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" intnet-subnet "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 0c427edf-3bfb-483f-9419-be7d91a0e223 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.0/24  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+---------------+--------------------------------------+----------------+\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack router list ")]),s._v("\n+--------------------------------------+--------+--------+-------+----------------------------------+-------------+-------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" State "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Project                          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Distributed "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" HA    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+--------+--------+-------+----------------------------------+-------------+-------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 9bb15ae4-432b-419d-a201-74e88da54051 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Router "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" UP    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" False       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" False "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+--------+--------+-------+----------------------------------+-------------+-------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("h3",{attrs:{id:"_2-创建ike-policy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建ike-policy"}},[s._v("#")]),s._v(" 2.创建ike policy")]),s._v(" "),t("p",[s._v("ike policy是用来作密钥管理的，操作命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron vpn-ikepolicy-create ikepolicy1 ")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\nCreated a new ikepolicy:\n+-------------------------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Field                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------------------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" auth_algorithm          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sha1                                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" description             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" encryption_algorithm    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" aes-128                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 5cfcbd95-2fe6-46bc-9974-be74c01ae35a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ike_version             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" v1                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" lifetime                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"units"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"seconds"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ikepolicy1                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" pfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" group5                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" phase1_negotiation_mode "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" main                                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" project_id              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------------------+--------------------------------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h3",{attrs:{id:"_3-创建ipec-policy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-创建ipec-policy"}},[s._v("#")]),s._v(" 3.创建ipec policy")]),s._v(" "),t("p",[s._v("用来配置ipsec的加密算法、使用模式、密钥生存期、使用协议等")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron vpn-ipsecpolicy-create ipsecpolicy1")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\nCreated a new ipsecpolicy:\n+----------------------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Field                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----------------------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" auth_algorithm       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sha1                                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" description          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" encapsulation_mode   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tunnel                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" encryption_algorithm "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" aes-128                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e67f8e41-20b1-47eb-a443-ef3370ae4501 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" lifetime             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"units"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"seconds"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ipsecpolicy1                         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" pfs                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" group5                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" project_id           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" transform_protocol   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" esp                                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----------------------+--------------------------------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h3",{attrs:{id:"_4-创建vpn-service服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-创建vpn-service服务"}},[s._v("#")]),s._v(" 4.创建vpn-service服务")]),s._v(" "),t("p",[s._v("ROUTER：VPN关联的router\nSUBNET：VPN要保护的内网")]),s._v(" "),t("blockquote",[t("p",[s._v("注意：")]),s._v(" "),t("p",[s._v("这里创建vpn-service的时候，是绑定路由器的ID，绑定内网子网的ID，不是网卡的ID。")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack  router list ")]),s._v("\n+--------------------------------------+--------+--------+-------+----------------------------------+-------------+-------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" State "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Project                          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Distributed "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" HA    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+--------+--------+-------+----------------------------------+-------------+-------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 9bb15ae4-432b-419d-a201-74e88da54051 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Router "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" UP    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" False       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" False "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+--------+--------+-------+----------------------------------+-------------+-------+\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# openstack network list ")]),s._v("\n+--------------------------------------+--------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Subnets                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+--------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 0c427edf-3bfb-483f-9419-be7d91a0e223 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" intnet "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e603abc5-41d3-4a4f-a4b8-75c72f505f8d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 6678be57-1f47-4c9f-bd64-e6540e0abc17 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" extnet "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 5ec4e1fc-989e-45df-83cc-675d53df7cc7 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+--------+--------------------------------------+\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron vpn-service-create 9bb15ae4-432b-419d-a201-74e88da54051 e603abc5-41d3-4a4f-a4b8-75c72f505f8d")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\nCreated a new vpnservice:\n+----------------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Field          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----------------+--------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" admin_state_up "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" True                                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" description    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" external_v4_ip "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.224                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" external_v6_ip "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" flavor_id      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 1ef2e2a6-3993-4b21-a0fb-5aeeb91dc76c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" project_id     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" router_id      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 9bb15ae4-432b-419d-a201-74e88da54051 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" PENDING_CREATE                       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" subnet_id      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e603abc5-41d3-4a4f-a4b8-75c72f505f8d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----------------+--------------------------------------+\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron vpn-service-list ")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" router_id                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 1ef2e2a6-3993-4b21-a0fb-5aeeb91dc76c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 9bb15ae4-432b-419d-a201-74e88da54051 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br")])]),t("p",[s._v("在没有创建下一步的ipsec-site-connection之前，status的状态会一直是"),t("code",[s._v("pending")]),s._v("状态，创建了"),t("code",[s._v("ipsec-site-connection")]),s._v("，并且创建成功后才会变为"),t("code",[s._v("active")])]),s._v(" "),t("h3",{attrs:{id:"_5-创建ipsec站点连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-创建ipsec站点连接"}},[s._v("#")]),s._v(" 5.创建ipsec站点连接")]),s._v(" "),t("p",[s._v("创建ipsec站点连接前，我们需要查看一下双方对端的外网网卡的网关地址，包括对端内网的地址，还需要的是ike的密钥以及ipec的密钥包括我们已经绑定好的VPN-Service。")]),s._v(" "),t("p",[s._v("命令解析：")]),s._v(" "),t("ul",[t("li",[t("strong",[t("code",[s._v("vpnservice-id")])]),s._v(" ：第四部创建的vpn-service的id")]),s._v(" "),t("li",[t("strong",[t("code",[s._v("peer-address")])]),s._v(" ：对端VPN的IP地址")]),s._v(" "),t("li",[t("strong",[t("code",[s._v("peer-cidr")])]),s._v(" ：对端VPN要保护的内网IP psk：IKE要使用的共享密钥")])]),s._v(" "),t("p",[s._v("查看当前的外网卡的网关地址：")]),s._v(" "),t("p",[t("code",[s._v("这里使用的是绑定路由器的外网IP，也可以使用网关地址。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205121609565.png",alt:"image-20220512160901331"}})]),s._v(" "),t("p",[s._v("以下是在OpenStack环境1中创建的:")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron ipsec-site-connection-create --name vpnconnection1 \\")]),s._v("\n--vpnservice-id 1ef2e2a6-3993-4b21-a0fb-5aeeb91dc76c "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--ikepolicy-id ikepolicy1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--ipsecpolicy-id ipsecpolicy1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--peer-address "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.210 --peer-id "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.210 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--peer-cidr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".20.0/24 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--psk secret\n\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\nCreated a new ipsec_site_connection:\n+-------------------+----------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Field             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------------+----------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" admin_state_up    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" True                                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" auth_mode         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" psk                                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" description       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" dpd               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hold"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"interval"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timeout"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" c71c013b-3eaa-4031-89a3-5ca02b9a3861               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ikepolicy_id      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 5cfcbd95-2fe6-46bc-9974-be74c01ae35a               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" initiator         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" bi-directional                                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ipsecpolicy_id    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e67f8e41-20b1-47eb-a443-ef3370ae4501               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" local_ep_group_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" local_id          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mtu               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v("                                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" vpnconnection1                                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_address      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.210                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_cidrs        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".20.0/24                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_ep_group_id  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_id           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.210                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" project_id        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" psk               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" secret                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" route_mode        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" static                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" PENDING_CREATE                                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" vpnservice_id     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 1ef2e2a6-3993-4b21-a0fb-5aeeb91dc76c               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------------+----------------------------------------------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br")])]),t("p",[s._v("以下是在OpenStack环境2中创建的:")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron ipsec-site-connection-create --name vpnconnection1 \\")]),s._v("\n--vpnservice-id e5ecff67-1eae-4ef7-a99b-081d649f4e2c "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--ikepolicy-id ikepolicy1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--ipsecpolicy-id ipsecpolicy1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--peer-address "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.224 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--peer-id "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.224 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--peer-cidr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.0/24 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--psk secret\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\nCreated a new ipsec_site_connection:\n+-------------------+----------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Field             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------------+----------------------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" admin_state_up    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" True                                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" auth_mode         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" psk                                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" description       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" dpd               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hold"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"interval"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timeout"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 0a0d8209-74f7-4914-a3ff-aad41abf84e6               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ikepolicy_id      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("98171820")]),s._v("-2c24-44b5-99af-c84197c7d050               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" initiator         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" bi-directional                                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ipsecpolicy_id    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 7bda3e06-8d21-4628-80a9-f45e0150bf6a               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" local_ep_group_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" local_id          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mtu               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v("                                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" vpnconnection1                                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_address      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.224                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_cidrs        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.0/24                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_ep_group_id  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_id           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.224                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" project_id        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" b7fbb1b959344c0f8b7eacdd2baa19d0                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" psk               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" secret                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" route_mode        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" static                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" PENDING_CREATE                                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" b7fbb1b959344c0f8b7eacdd2baa19d0                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" vpnservice_id     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e5ecff67-1eae-4ef7-a99b-081d649f4e2c               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------------+----------------------------------------------------+\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron vpn-service-list ")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" router_id                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e5ecff67-1eae-4ef7-a99b-081d649f4e2c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" b7fbb1b959344c0f8b7eacdd2baa19d0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cd3f2a9c-518f-4a74-b2f5-ae0108b85365 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br")])]),t("h3",{attrs:{id:"_6-vpn验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-vpn验证"}},[s._v("#")]),s._v(" 6.VPN验证")]),s._v(" "),t("p",[s._v("1.在openstack环境1查看vpn-service的环境：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron vpn-service-list ")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" router_id                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 1ef2e2a6-3993-4b21-a0fb-5aeeb91dc76c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 9bb15ae4-432b-419d-a201-74e88da54051 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("2.在openstack环境1查看ipsec-site-connection环境：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron ipsec-site-connection-list")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\n+--------------------------------------+----------------+----------------------------------+---------------+-----------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_address  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" auth_mode "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+----------------+----------------------------------+---------------+-----------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" c71c013b-3eaa-4031-89a3-5ca02b9a3861 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" vpnconnection1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 860e327cc9ca468888f0124fc6e436c3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.210 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" psk       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+----------------+----------------------------------+---------------+-----------+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("3.在openstack环境2查看vpn-service的环境：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron vpn-service-list")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" router_id                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" e5ecff67-1eae-4ef7-a99b-081d649f4e2c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" b7fbb1b959344c0f8b7eacdd2baa19d0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cd3f2a9c-518f-4a74-b2f5-ae0108b85365 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+----------------------------------+--------------------------------------+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("4.在openstack环境2查看ipsec-site-connection的环境：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# neutron ipsec-site-connection-list ")]),s._v("\nneutron CLI is deprecated and will be removed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the future. Use openstack CLI instead.\n+--------------------------------------+----------------+----------------------------------+---------------+-----------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tenant_id                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" peer_address  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" auth_mode "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+----------------+----------------------------------+---------------+-----------+--------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 0a0d8209-74f7-4914-a3ff-aad41abf84e6 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" vpnconnection1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" b7fbb1b959344c0f8b7eacdd2baa19d0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.224 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" psk       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+----------------+----------------------------------+---------------+-----------+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("5.分别查看两个OpenStack环境的虚拟机情况：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nova list ")]),s._v("\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Task State "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Power State "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Networks            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 8d41c439-f217-4166-88b1-9b8d1bd39cb8 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" centos "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" -          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Running     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("intnet")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".10.147 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@controller ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nova list ")]),s._v("\n+--------------------------------------+------+--------+------------+-------------+---------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ID                                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Status "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Task State "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Power State "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Networks            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+--------+------------+-------------+---------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 3c81a0ca-f1b0-4952-ab32-baa8cf415129 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" vm   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ACTIVE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" -          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Running     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("intnet")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.10")]),s._v(".20.247 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------------------------+------+--------+------------+-------------+---------------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("6.使用环境1里面的虚拟机访问环境2的虚拟机：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205121616750.png",alt:"image-20220512161645094"}})])])}),[],!1,null,null,null);a.default=r.exports}}]);