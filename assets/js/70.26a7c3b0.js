(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{550:function(s,t,a){"use strict";a.r(t);var n=a(19),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"gitlab-gitlab-ci-harbor-kubernetes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab-gitlab-ci-harbor-kubernetes"}},[s._v("#")]),s._v(" GitLab + GitLab CI + Harbor + Kubernetes")]),s._v(" "),a("h2",{attrs:{id:"项目要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目要求"}},[s._v("#")]),s._v(" 项目要求")]),s._v(" "),a("p",[s._v("该公司决定采用"),a("code",[s._v("GitLab + GitLab CI + Harbor + Kubernetes")]),s._v("架构来构建CICD环境，以缩短新功能开发上线周期，及时满足客户的需求，实现DevOps的部分流程，来减轻部署运维的负担，实现可视化容器生命周期管理、应用发布和版本迭代更新，请完成CICD环境部署。CICD应用系统架构如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250851345.png",alt:"image-20220425085103011"}})]),s._v(" "),a("h2",{attrs:{id:"环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境准备"}},[s._v("#")]),s._v(" 环境准备")]),s._v(" "),a("p",[s._v("这里使用项目为2048游戏")]),s._v(" "),a("p",[a("strong",[s._v("项目地址：")]),s._v("  https://gitee.com/isicman/demo-2048.git")]),s._v(" "),a("h3",{attrs:{id:"_1-节点规划"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-节点规划"}},[s._v("#")]),s._v(" 1.节点规划")]),s._v(" "),a("p",[s._v("使用Docker或者使用Kubernetes集群环境，这里使用的是Kubernetes集群环境。")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("IP地址")]),s._v(" "),a("th",[s._v("主机名称")]),s._v(" "),a("th",[s._v("主机资源")]),s._v(" "),a("th",[s._v("节点名称")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("10.11.121.111")]),s._v(" "),a("td",[s._v("k8s-master")]),s._v(" "),a("td",[s._v("12G/6VCPU")]),s._v(" "),a("td",[s._v("GitLab+GitLab-Runner")])]),s._v(" "),a("tr",[a("td",[s._v("10.11.121.112")]),s._v(" "),a("td",[s._v("k8s-node1")]),s._v(" "),a("td",[s._v("8G/6VCPU")]),s._v(" "),a("td",[s._v("Harbor")])]),s._v(" "),a("tr",[a("td",[s._v("10.11.121.113")]),s._v(" "),a("td",[s._v("k8s-node2")]),s._v(" "),a("td",[s._v("8G/6VCPU")]),s._v(" "),a("td",[s._v("node")])])])]),s._v(" "),a("h3",{attrs:{id:"_2-查看集群状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-查看集群状态"}},[s._v("#")]),s._v(" 2.查看集群状态")]),s._v(" "),a("p",[s._v("可以通过"),a("code",[s._v("kubectl cluster-info")]),s._v("命令查看当前的集群信息。 通过 "),a("code",[s._v("kubectl get node")]),s._v("查看当前节点数量。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl cluster-info ")]),s._v("\nKubernetes control plane is running at https://10.11.121.111:6443\nKubeDNS is running at https://10.11.121.111:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n\nTo further debug and diagnose cluster problems, use "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubectl cluster-info dump'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get node ")]),s._v("\nNAME         STATUS   ROLES                  AGE   VERSION\nk8s-master   Ready    control-plane,master   25h   v1.20.0\nk8s-node1    Ready    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                 25h   v1.20.0\nk8s-node2    Ready    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                 25h   v1.20.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"部署gitlab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署gitlab"}},[s._v("#")]),s._v(" 部署GitLab")]),s._v(" "),a("h3",{attrs:{id:"_1-gitlab概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-gitlab概述"}},[s._v("#")]),s._v(" 1.GitLab概述")]),s._v(" "),a("p",[s._v("GitLab 是利用 Ruby on Rails 一个开源的版本管理系统，实现一个自托管的 Git 项目仓库，可通过 Web 界面进行访问公开的或者私人项目。它拥有与 Github 类似的功能，能够浏览源代码，管理缺陷和注释。可以管理团队对仓库的访问，它非常易于浏览提交过的版本并提供一个文件历史库。团队成员可以利用内置的简单聊天程序 (Wall) 进行交流。它还提供一个代码片段收集功能可以轻松实现代码复用，便于日后有需要的时候进行查找。")]),s._v(" "),a("h3",{attrs:{id:"_2-gitlab部署方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-gitlab部署方式"}},[s._v("#")]),s._v(" 2.GitLab部署方式")]),s._v(" "),a("p",[s._v("GitLab 可以安装在大多数 GNU/Linux 发行版中，并与多个云提供商一起安装。要从 GitLab 获得最佳体验，您必须平衡性能、可靠性、易于管理（备份、升级和故障排除）以及托管成本。")]),s._v(" "),a("p",[s._v("目前比较常见的部署方式有如下三种：")]),s._v(" "),a("ul",[a("li",[s._v("直接安装在操作系统上，例如： "),a("code",[s._v("Mac/Windows/Linux")])]),s._v(" "),a("li",[s._v("通过容器的方式安装，例如： "),a("code",[s._v("Docker、Kubernetes")])]),s._v(" "),a("li",[s._v("使用Helm包安装： "),a("code",[s._v("Chart包的方式")])])]),s._v(" "),a("h3",{attrs:{id:"_3-docker部署gitlab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker部署gitlab"}},[s._v("#")]),s._v(" 3.Docker部署GitLab")]),s._v(" "),a("p",[s._v("1.使用Docker命令部署Gitlab，由于Gitlab的镜像大概有几个G，所以需要等待很久的时间，直到完全启动。")]),s._v(" "),a("p",[s._v("参数解析：")]),s._v(" "),a("p",[a("code",[s._v("hostname")]),s._v("  \t\t\t  域名 或 ip")]),s._v(" "),a("p",[a("code",[s._v("publish 、-p")]),s._v(" \t\t端口映射")]),s._v(" "),a("p",[a("code",[s._v("restart")]),s._v(" \t\t\t\t重启方式")]),s._v(" "),a("p",[a("code",[s._v("volume、-v")]),s._v(" \t\t   目录挂载")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d \\")]),s._v("\n  --hostname "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.11")]),s._v(".121.111 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(":443 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("222")]),s._v(":22 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --name gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --restart always "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /srv/gitlab/config:/etc/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /srv/gitlab/logs:/var/log/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /srv/gitlab/data:/var/opt/gitlab "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  gitlab/gitlab-ce:latest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("2.查看当前的Docker进程。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps | grep  gitlab ")]),s._v("\n686f123b649c   gitlab/gitlab-ce:latest                             "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/assets/wrapper"')]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" hours ago   Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::80-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:443-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/tcp, :::443-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/tcp, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:222-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::222-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp   gitlab\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("3.通过浏览器访问GitLab的页面： http://10.11.121.111")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204242235534.png",alt:"image-20220424223532525"}})]),s._v(" "),a("p",[s._v("4.这里默认的用户是 "),a("code",[s._v("root")]),s._v(" ，默认的密码只有24h有效，所以我们需要更改一下密码。")]),s._v(" "),a("p",[s._v("先查出用户的id，例如下面用户是root id=1")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it gitlab /bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(":1,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Administrator"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"active"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"avatar_url"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=80'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\u0026"}},[s._v("\\u0026")]),s._v('d=identicon"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"web_url"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://192.168.0.173/root"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nroot@10:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-rails console -e production")]),s._v("\n--------------------------------------------------------------------------------\n Ruby:         ruby "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.7")]),s._v(".4p191 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-07 revision a21a3b7d23"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("x86_64-linux"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n GitLab:       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.4")]),s._v(".1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("1a23d731c9f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" FOSS\n GitLab Shell: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13.21")]),s._v(".1\n PostgreSQL:   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.7")]),s._v("\n--------------------------------------------------------------------------------\nLoading production environment "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Rails "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.1")]),s._v(".4.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nirb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":001:"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("u")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("User.where"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id:1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".first\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<User id:1 @root>")]),s._v("\nirb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":002:"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v(" u.password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'00000000'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"00000000"')]),s._v("\nirb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":003:"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v(" u.password_confirmation"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'00000000'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"00000000"')]),s._v("\nirb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":004:"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v(" u.save"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nEnqueued ActionMailer::MailDeliveryJob "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Job ID: d7bc1e90-4941-4125-bf90-b018c92b5d73"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to Sidekiq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mailers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" with arguments: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DeviseMailer"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password_change"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deliver_now"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":args"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<GlobalID:0x00007f0b99fbc3a8 @uri=#<URI::GID gid://gitlab/User/1>>]}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nirb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":005:"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h3",{attrs:{id:"_4-创建项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-创建项目"}},[s._v("#")]),s._v(" 4.创建项目")]),s._v(" "),a("p",[s._v("2.登录Gitlab之后，需要创建一个项目名称叫做"),a("code",[s._v("demo")]),s._v("。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204242237733.png",alt:"image-20220424223745243"}})]),s._v(" "),a("p",[s._v("2.选择"),a("code",[s._v("public")]),s._v("，也是上市的意思，不需要初始化存储库。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204242240317.png",alt:"image-20220424224043845"}})]),s._v(" "),a("p",[s._v("3.首先我们拉取gitee上的源码到本地，再推送到Gitlab源码托管demo仓库的Master分支。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git clone https://gitee.com/isicman/demo-2048.git ")]),s._v("\nCloning into "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'demo-2048'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nUsername "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://gitee.com'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" isicman\nPassword "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://isicman@gitee.com'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" \nremote: Enumerating objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("71")]),s._v(", done.\nremote: Counting objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("71")]),s._v("/71"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\nremote: Compressing objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v("/59"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\nremote: Total "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("71")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", pack-reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nUnpacking objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("71")]),s._v("/71"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd demo-2048/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":28 Dockerfiles\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1491")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":28 pom.xml\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("315")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":28 README.md\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":28 src\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":06 template\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo-2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git config --global user.name "Administrator"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo-2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git config --global user.email "admin@example.com"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo-2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git init")]),s._v("\nReinitialized existing Git repository "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /opt/demo-2048/.git/\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo-2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git remote rename origin old-origin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo-2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git remote add origin http://10.11.121.111/root/demo.git")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo-2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo-2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "Initial commit"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# On branch master")]),s._v("\nnothing to commit, working directory clean\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master demo-2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -u origin --all")]),s._v("\nUsername "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://10.11.121.111'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" root\nPassword "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://root@10.11.121.111'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" \nCounting objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("71")]),s._v(", done.\nDelta compression using up to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" threads.\nCompressing objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v("/59"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\nWriting objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("71")]),s._v("/71"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("82.04")]),s._v(" KiB "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" bytes/s, done.\nTotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("71")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTo http://10.11.121.111/root/demo2.git\n * "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("new branch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      master -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" master\nBranch master "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" up to track remote branch master from origin.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br")])]),a("p",[s._v("4.再次刷新仓库查看，源码已经推送成功。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204242249037.png",alt:"image-20220424224925906"}})]),s._v(" "),a("p",[s._v("5.需要记住这里的Runner的"),a("code",[s._v("URL和Token")]),s._v("，因为后面的GitLab—Runner连接GitLab需要使用到。")]),s._v(" "),a("p",[s._v("此处我的URL: "),a("code",[s._v("http://10.11.121.111/")])]),s._v(" "),a("p",[s._v("此处我的Token："),a("code",[s._v("o4_NCTZvpnViRE7iGxoi")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250847343.png",alt:"image-20220424225358742"}})]),s._v(" "),a("h2",{attrs:{id:"部署gitlab-runner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署gitlab-runner"}},[s._v("#")]),s._v(" 部署GitLab-Runner")]),s._v(" "),a("h3",{attrs:{id:"_1-gitlab-ci介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-gitlab-ci介绍"}},[s._v("#")]),s._v(" 1.GitLab-CI介绍")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250847312.webp",alt:"img"}})]),s._v(" "),a("p",[s._v("GitLab Runner是一个"),a("a",{attrs:{href:"https://so.csdn.net/so/search?q=%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"}},[s._v("开源项目"),a("OutboundLink")],1),s._v("，用于运行您的作业并将结果发送回GitLab。它与GitLab CI一起使用，GitLab CI是GitLab随附的开源持续集成服务，用于协调作业。")]),s._v(" "),a("p",[s._v("一般来说，gitlab上已由负责人配置好了"),a("code",[s._v("gitlab-runner")]),s._v("，我们只需要编写好"),a("code",[s._v(".gitlab.yml")]),s._v("文件提交代码即可触发runner进行工作。但对于初学者来说，你可能想能不能在提交代码前在本地先执行"),a("code",[s._v(".gitlab.yml")]),s._v("文件的job，本地调试成功检查没有问题后再进行最终代码的提交，触发服务端的CI流程。答案当然也是可以的。"),a("code",[s._v(".gitlab.yml")]),s._v("文件中定义的job其实是某个服务器中的"),a("code",[s._v("gitlab-runner")]),s._v("在运行，那我们也可以在本地安装好"),a("code",[s._v("gitlab-runner")]),s._v("手动的来执行本地"),a("code",[s._v(".gitlab.yml")]),s._v("中的"),a("code",[s._v("job")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"_2-gitlab-runner部署方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-gitlab-runner部署方式"}},[s._v("#")]),s._v(" 2.GitLab-Runner部署方式")]),s._v(" "),a("p",[s._v("你几乎可以在任何机器上安装"),a("code",[s._v("gitlab-runner")]),s._v("，安装的方式这里推荐如下几种：")]),s._v(" "),a("ul",[a("li",[s._v("Linux使用二进制的方式")]),s._v(" "),a("li",[s._v("Docker中使用容器的方式启动Gitlab—Runner")]),s._v(" "),a("li",[s._v("Helm包的方式安装Gitlab-Runner")])]),s._v(" "),a("p",[a("code",[s._v("如下我分别使用了两种不同的方式部署Gitlab-Runner，可以选择其中一种。")])]),s._v(" "),a("h3",{attrs:{id:"_3-docker部署runner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker部署runner"}},[s._v("#")]),s._v(" 3.Docker部署Runner")]),s._v(" "),a("p",[a("strong",[s._v("1.安装gitlab runner")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name gitlab-runner --restart always \\")]),s._v("\n  -v /srv/gitlab-runner/config:/etc/gitlab-runner "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /var/run/docker.sock:/var/run/docker.sock "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  gitlab/gitlab-runner:latest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("2.注册gitlab runner")])]),s._v(" "),a("p",[s._v("参数解析：")]),s._v(" "),a("ol",[a("li",[s._v("gitlab-runner register 是启动register的命令")]),s._v(" "),a("li",[s._v("GitLab的Runner显示的URL地址： "),a("code",[s._v("--url")])]),s._v(" "),a("li",[s._v("GitLab的Runner显示的Token值：  "),a("code",[s._v("--registration-token")])]),s._v(" "),a("li",[s._v("设置Runner的标签： "),a("code",[s._v("--tag-list")])]),s._v(" "),a("li",[s._v("设置CICD构建时可以不启用Tag："),a("code",[s._v("--run-untagged")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run --rm -v /srv/gitlab-runner/config:/etc/gitlab-runner gitlab/gitlab-runner register \\")]),s._v("\n  --non-interactive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --executor "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --docker-image alpine:latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --url "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://10.11.121.111/"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --registration-token "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"o4_NCTZvpnViRE7iGxoi"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --description "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first-register-runner"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --tag-list "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"k8s"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --run-untagged"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --locked"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"false"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --access-level"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"not_protected"')]),s._v(" \n  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps | grep gitlab-runner ")]),s._v("\n3e0a02917540   gitlab/gitlab-runner:latest                         "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/dumb-init …"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" hours ago   Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" hours                                                                                                                             gitlab-runner\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[a("strong",[s._v("2.查看Gitlab连接情况")])]),s._v(" "),a("p",[s._v("1.进入Gitlab的CICD配置中，找到Runner配置，刷新此页面。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848483.png",alt:"image-20220424231601423"}})]),s._v(" "),a("p",[s._v("2.或者在Menu的菜单栏中，找到 "),a("code",[s._v("Admin")]),s._v(", 然后选择 "),a("code",[s._v("Runner")]),s._v("，可以查看到当前的Runner连接情况。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848560.png",alt:"image-20220424231816380"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848031.png",alt:"image-20220424232117034"}})]),s._v(" "),a("h3",{attrs:{id:"_4-helm部署runner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-helm部署runner"}},[s._v("#")]),s._v(" 4.Helm部署Runner")]),s._v(" "),a("p",[a("strong",[s._v("什么是Helm？")])]),s._v(" "),a("p",[s._v("就像 Java 使用 maven；node 使用 npm；python 使用 pip；Linux 使用 yum 或 Apt 一样，不管是什么样的工作，技术人员都会希望有一种资源管理器/包管理器，以此来方便得查找、下载、安装、使用和分发软件包。")]),s._v(" "),a("p",[s._v("Helm 使用的包格式称为 "),a("code",[s._v("chart")]),s._v("，它是一个描述 Kubernetes 相关资源对象的文件集合。它的技术特点类似 jinja模版，以渲染模版的方式，生成运行一个服务实例所需的一系列资源对象文件，并以此进行服务的发布。通过这种方式，我们也可以十分简单的制作自定义的 chart。")]),s._v(" "),a("p",[s._v("所以 Helm 即可以说是 "),a("code",[s._v("K8S的包管理器")]),s._v("，它使得我们对于 K8S 的操作不再需要细化到资源对象，而是可以作为一个实例进行管理。不再需要去写 "),a("code",[s._v("deployment")]),s._v(" 、"),a("code",[s._v("service")]),s._v(" 、"),a("code",[s._v("ingress")]),s._v(" 的 yaml，而是可以直接通过 "),a("code",[s._v("install")]),s._v(" 命令实现服务实例的安装。")]),s._v(" "),a("p",[a("strong",[s._v("1.拉取Gitlab-Runner的Chart包")])]),s._v(" "),a("p",[s._v("项目地址："),a("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fcharts%2Fgitlab-runner",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://gitlab.com/gitlab-org/charts/gitlab-runner"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master gitlab-runner"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("369")]),s._v(" Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" 03:39 Chart.yaml\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("236")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" 05:48 templates\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6452")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" 05:47 values.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("strong",[s._v("2.配置Chart的模板")])]),s._v(" "),a("p",[s._v("修改Chart包的values.yaml配置如下：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("gitlabUrl:")]),s._v(" \t配置Gitlab的URL")]),s._v(" "),a("li",[a("code",[s._v("runnerRegistrationToken:")]),s._v("      配置Gitlab的Runner的Token")]),s._v(" "),a("li",[a("code",[s._v("namespace:")]),s._v("     配置命名空间")]),s._v(" "),a("li",[a("code",[s._v("tags:")]),s._v("              配置标签")]),s._v(" "),a("li",[a("code",[s._v("cachePath:")]),s._v("     配置缓存路径")])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gitlab/gitlab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("runner"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("v11.7.0\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("imagePullPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" IfNotPresent\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" busybox\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1.0\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitlabUrl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://10.11.121.111"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runnerRegistrationToken")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"o4_NCTZvpnViRE7iGxoi"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("unregisterRunners")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("concurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkInterval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rbac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("clusterWideAccess")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metrics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16.04")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tags")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"k8s"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("privileged")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" demo\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cachePath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/cache"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("builds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("helpers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("resources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[a("strong",[s._v("3.Helm部署Gitlab-Runner")])]),s._v(" "),a("p",[s._v("使用"),a("code",[s._v("helm install")]),s._v("命令创建安装Gitlab—Runner。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master gitlab-cicd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# helm install k8s-runner gitlab-runner/ -n demo")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master gitlab-cicd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# helm list -n demo ")]),s._v("\nNAME      \tNAMESPACE\tREVISION\tUPDATED                                \tSTATUS  \tCHART               \tAPP VERSION\nk8s-runner\tdemo     \t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       \t"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-04-24 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":13:11.742949709 +0000 UTC\tdeployed\tgitlab-runner-0.1.37\t\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("4.查看Gitlab连接情况")])]),s._v(" "),a("p",[s._v("1.查看当前的资源是否创建成功。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get -n demo all")]),s._v("\nNAME                                            READY   STATUS    RESTARTS   AGE\npod/k8s-runner-gitlab-runner-544f469c44-9m7zw   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          155m\n\nNAME                                       READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/k8s-runner-gitlab-runner   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           155m\n\nNAME                                                  DESIRED   CURRENT   READY   AGE\nreplicaset.apps/k8s-runner-gitlab-runner-544f469c44   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       155m\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("2.回到Gitlab刷新CICD的Runner的配置，新的Gitlab-Runner连接成功。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848984.png",alt:"image-20220424235055148"}})]),s._v(" "),a("p",[a("strong",[s._v("3.测试GitLab的CICD流水线")])]),s._v(" "),a("p",[s._v("1.进入demo的项目,点击 "),a("code",[s._v("CI/CD")]),s._v("，然后找到"),a("code",[s._v("Editor")]),s._v(" ，编写一个流水线脚本，运行job1，输出Hello Word。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848184.png",alt:"image-20220425000049979"}})]),s._v(" "),a("p",[s._v("如上的.gitlab-ci.yaml文件如下：")]),s._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" .pre\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" build\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" test\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" deploy \n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("job1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .pre\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(' echo "Hello Word"\n\n'),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("job2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" build\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(' echo "This is build"\n\n'),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("job3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(' echo "This is test"\n\n'),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("job4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" deploy\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(' echo "This is deploy"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("2.点击 "),a("code",[s._v("Commit changes")]),s._v(" 提交流水线脚本。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848169.png",alt:"image-20220425000312131"}})]),s._v(" "),a("p",[s._v("3.构建完成之后，查看当前的部署情况，可以发现四个阶段的任务都正常部署，所以说明Gitlab-CI已经可以正常运行。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848335.png",alt:"image-20220425000806089"}})]),s._v(" "),a("p",[s._v("4.点击Job1，查看当前的Job1输出的日志，是否为Hello Word。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848471.png",alt:"image-20220425001000417"}})]),s._v(" "),a("p",[s._v("如上图可以看到Job1任务输出的内容正常。")]),s._v(" "),a("h2",{attrs:{id:"部署harbor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署harbor"}},[s._v("#")]),s._v(" 部署Harbor")]),s._v(" "),a("h3",{attrs:{id:"_1-harbor介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-harbor介绍"}},[s._v("#")]),s._v(" 1.Harbor介绍")]),s._v(" "),a("p",[s._v("Harbor 源于 2014 年 VMware中国研发中心云原生实验室的一个内部项目，旨在为容器的开发人员解决镜像管理的问题。随着 Kubernetes 和容器技术的流行，该项目于 2016 年开源，2018 年 7 月捐赠给 CNCF，在同年 11 月被正式接受为孵化项目，并在云原生技术路线与生态中演进。")]),s._v(" "),a("p",[s._v("2020年5月 Harbor 2.0 正式发布，增加了对 OCI 制品的支持，能够存储大量云原生制品，例如容器镜像、Helm Chart、CNAB、OPA 和 Singularity 等等。开发人员可依照 OCI 规范，通过 OCI 索引和 OCI 制品功能开拓更广泛的应用场景，包括策略、远程复制和基于角色的访问控制等。")]),s._v(" "),a("h3",{attrs:{id:"_2-harbor部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-harbor部署"}},[s._v("#")]),s._v(" 2.Harbor部署")]),s._v(" "),a("ul",[a("li",[s._v("首选必须安装docker-compose的插件，这里我已经安装了docker-compose")]),s._v(" "),a("li",[s._v("禁用https策略，使用http策略")]),s._v(" "),a("li",[s._v("将hostname修改为10.11.121.112")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 harbor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose version ")]),s._v("\nDocker Compose version v2.2.1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar zxvf harbor-offline.tar.gz ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd harbor/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim harbor.yaml ")]),s._v("\nhostname: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.11")]),s._v(".121.112\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http related config")]),s._v("\nhttp:\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# port for http, default is 80. If https enabled, this port will redirect to https port")]),s._v("\n  port: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https related config")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#https:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https port for harbor, default is 443")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  port: 443")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The path of cert and key files for nginx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  certificate: /your/certificate/path")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  private_key: /your/private/key/path")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[s._v("执行命令安装Harbor，查看harbor的进程。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 harbor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./install.sh ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Step "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": checking "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" is installed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nNote: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.10")]),s._v(".14\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Step "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": checking "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" is installed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nNote: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.2")]),s._v(".1\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Step "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": loading Harbor images "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n···\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Step "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": starting Harbor "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Running "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("/10\n ⠿ Network harbor_harbor        Created                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".1s\n ⠿ Container harbor-log         Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".6s\n ⠿ Container harbor-db          Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".6s\n ⠿ Container registryctl        Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".2s\n ⠿ Container harbor-portal      Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".8s\n ⠿ Container registry           Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".2s\n ⠿ Container redis              Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".2s\n ⠿ Container harbor-core        Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0s\n ⠿ Container nginx              Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".3s\n ⠿ Container harbor-jobservice  Started                                                                                                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".3s\n✔ ----Harbor has been installed and started successfully.----\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 harbor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose  ps ")]),s._v("\nNAME                COMMAND                  SERVICE             STATUS              PORTS\nharbor-core         "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/harbor/entrypoint.…"')]),s._v("   core                running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \nharbor-db           "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/docker-entrypoint.…"')]),s._v("   postgresql          running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \nharbor-jobservice   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/harbor/entrypoint.…"')]),s._v("   jobservice          running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \nharbor-log          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh -c /usr/loc…"')]),s._v("   log                 running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:1514-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10514")]),s._v("/tcp\nharbor-portal       "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   portal              running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \nnginx               "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   proxy               running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp, :::80-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp\nredis               "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis-server /etc/r…"')]),s._v("   redis               running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \nregistry            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/harbor/entryp…"')]),s._v("   registry            running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \nregistryctl         "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/harbor/start.…"')]),s._v("   registryctl         running "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("p",[s._v("访问Harbor地址： http://10.11.121.112")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848345.png",alt:"image-20220425001823055"}})]),s._v(" "),a("h3",{attrs:{id:"_3-添加镜像仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加镜像仓库"}},[s._v("#")]),s._v(" 3.添加镜像仓库")]),s._v(" "),a("p",[s._v("点击 "),a("code",[s._v("新建项目")]),s._v(" ，创建项目名称为 "),a("code",[s._v("demo")]),s._v("，访问级别设置为 "),a("code",[s._v("公开")]),s._v("。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848880.png",alt:"image-20220425002022377"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848072.png",alt:"image-20220425002121911"}})]),s._v(" "),a("h2",{attrs:{id:"配置cicd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置cicd"}},[s._v("#")]),s._v(" 配置CICD")]),s._v(" "),a("h3",{attrs:{id:"_1-配置-gitlab-ci-yml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-配置-gitlab-ci-yml"}},[s._v("#")]),s._v(" 1.配置.gitlab-ci.yml")]),s._v(" "),a("p",[s._v("配置.gitlab-ci.yaml的流水线配置文件内容如下：")]),s._v(" "),a("ul",[a("li",[s._v("使用"),a("code",[s._v("docker:v1.0")]),s._v("的镜像作为基础镜像")]),s._v(" "),a("li",[s._v("需要构建三个步骤："),a("code",[s._v("maven-build、docker-build、deploy")])]),s._v(" "),a("li",[s._v("使用"),a("code",[s._v("maven镜像")]),s._v("构建编译demo-2048项目")]),s._v(" "),a("li",[s._v("使用"),a("code",[s._v("docker镜像")]),s._v("build新的镜像，推送到Harbor仓库中")]),s._v(" "),a("li",[s._v("使用"),a("code",[s._v("kubelet镜像")]),s._v("部署demo-2048的yaml文件")])]),s._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" maven"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("build\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("build\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" deploy\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这是定义的变量，是Harbor仓库登录的验证信息。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("variables")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("USERNAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" admin\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Harbor12345\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("HARBORIP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10.11.121.112\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maven-build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" maven"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3.6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("jdk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" maven"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("build \n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mkdir "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p /root/.m2/repository\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rvf /opt/repository/*  /root/.m2/repository/\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mvn clean install "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Dmaven.test.sktip=true\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rvf /root/demo/target/demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("2048  /opt/cache\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("docker_build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("build\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mv /opt/cache/* /root/demo/Dockerfiles/\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cd /root/demo/Dockerfiles/ "),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" ls\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" docker build "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("t $HARBORIP/demo/demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("f /root/demo/Dockerfiles/Dockerfile . \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" docker login "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("u $USERNAME "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p $PASSWORD $HARBORIP \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" docker push $HARBORIP/demo/demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("2048"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里的kubectl是做的镜像，是在本地仓库，使用config连接Kubernetes集群")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubectl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.16.6\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" deploy \n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mkdir $HOME/.kube "),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" cat $K8S_CONFIG "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" $HOME/.kube/config\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cd $HOME/.kube "),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" pwd\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" sed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("i 's/10.24.2.3/10.11.121.112/g' /root/demo/template/demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("2048.yaml \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" sed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("i 's/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("build_tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/v1.0/g' /root/demo/template/demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("2048.yaml \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" sed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("i 's/8889/30003/g' /root/demo/template/demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("2048.yaml \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" kubectl apply "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("f /root/demo/template/demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("2048.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br")])]),a("h3",{attrs:{id:"_2-开始构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-开始构建"}},[s._v("#")]),s._v(" 2.开始构建")]),s._v(" "),a("p",[s._v("点击 "),a("code",[s._v("提交完成")]),s._v(" 构建CICD。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848856.png",alt:"image-20220425003143807"}})]),s._v(" "),a("p",[s._v("等待结果：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848288.png",alt:"image-20220425003438600"}})]),s._v(" "),a("h3",{attrs:{id:"_3-查看gitlab-ci"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-查看gitlab-ci"}},[s._v("#")]),s._v(" 3.查看Gitlab-CI")]),s._v(" "),a("p",[s._v("查看构建的输出日志内容。")]),s._v(" "),a("p",[s._v("如下是maven-build的输出内容：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848151.png",alt:"image-20220425003531697"}})]),s._v(" "),a("p",[s._v("如下是docker-build的输出内容：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848855.png",alt:"image-20220425003550405"}})]),s._v(" "),a("p",[s._v("如下是deploy的输出内容：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250848591.png",alt:"image-20220425003605898"}})]),s._v(" "),a("h3",{attrs:{id:"_4-访问项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-访问项目"}},[s._v("#")]),s._v(" 4.访问项目")]),s._v(" "),a("p",[s._v("查看当前的demo命名空间下的资源，demo-2048应用程序部署完成。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get  pods -n demo")]),s._v("\nNAME                                        READY   STATUS    RESTARTS   AGE\ndemo-2048-6858bb9f8d-522rn                  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          3m19s\nk8s-runner-gitlab-runner-544f469c44-9m7zw   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          3h23m\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-node1 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get svc -n demo ")]),s._v("\nNAME        TYPE       CLUSTER-IP     EXTERNAL-IP   PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("          AGE\ndemo30003   NodePort   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".113.92   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":30003/TCP   3m24s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("访问页面： http://10.11.121.112:30003")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/2756864799zhang/image/main/img/202204250849199.png",alt:"image-20220425003906131"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);