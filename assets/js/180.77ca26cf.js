(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{659:function(t,s,e){"use strict";e.r(s);var a=e(19),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"linux下firewalld命令管理详解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux下firewalld命令管理详解"}},[t._v("#")]),t._v(" Linux下firewalld命令管理详解")]),t._v(" "),e("h2",{attrs:{id:"firewalld中的区域管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#firewalld中的区域管理"}},[t._v("#")]),t._v(" Firewalld中的区域管理")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("阻塞区域（block）")]),t._v(" "),e("th",[e("strong",[t._v("任何传入的网络数据包都将被阻止")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("工作区域（work）")]),t._v(" "),e("td",[t._v("相信网络上的其他计算机，不会损害你的计算机")])]),t._v(" "),e("tr",[e("td",[t._v("家庭区域（home）")]),t._v(" "),e("td",[t._v("相信网络上的其他计算机，不会损害你的计算机")])]),t._v(" "),e("tr",[e("td",[t._v("公共区域（public）")]),t._v(" "),e("td",[t._v("不相信网络上的任何计算机，只有选择接受传入的网络连接")])]),t._v(" "),e("tr",[e("td",[t._v("隔离区域（DMZ）")]),t._v(" "),e("td",[t._v("隔离区域也称为非军事区域，内外网络之间增加的一层网络，起到缓冲作用。对于隔离区域，只有选择接受传入的网络连接")])]),t._v(" "),e("tr",[e("td",[t._v("信任区域（trusted）")]),t._v(" "),e("td",[t._v("所有的网络连接都可以接受")])]),t._v(" "),e("tr",[e("td",[t._v("丢弃区域（drop）")]),t._v(" "),e("td",[t._v("任何传入的网络连接都被拒绝")])]),t._v(" "),e("tr",[e("td",[t._v("内部区域（internal）")]),t._v(" "),e("td",[t._v("信任网络上的其他计算机，不会损害你的计算机。只有选择接受传入的网络连接")])]),t._v(" "),e("tr",[e("td",[t._v("外部区域（external）")]),t._v(" "),e("td",[t._v("不相信网络上的其他计算机，不会损害你的计算机。只有选择接受传入的网络连接")])])])]),t._v(" "),e("h2",{attrs:{id:"常用区域管理方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用区域管理方法"}},[t._v("#")]),t._v(" 常用区域管理方法")]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("firewall-config              \t\t    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##开启火墙的图形管理")]),t._v("\nfirewall-cmd --state\t\t\t\t \t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看防火墙状态")]),t._v("\nfirewall-cmd --get-active-zones \t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看正在生效的域")]),t._v("\nfirewall-cmd --get-default-zone \t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看默认的域")]),t._v("\nfirewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --list-all \t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看public域里的设置，--zone指定域")]),t._v("\nfirewall-cmd --list-all \t\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#列出默认域的火墙情况")]),t._v("\nfirewall-cmd --set-default-zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public \t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#把默认的域设为public")]),t._v("\nfirewall-cmd --get-zones \t\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看所有的域")]),t._v("\nfirewall-cmd --get-services \t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看所有可以添加到火墙里的服务")]),t._v("\nfirewall-cmd --list-all-zones \t \t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##查看所有域的所有设置")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])]),e("blockquote",[e("p",[e("strong",[t._v("注：Firewalld的默认区域是public")])])]),t._v(" "),e("h2",{attrs:{id:"基本命令用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基本命令用法"}},[t._v("#")]),t._v(" 基本命令用法")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("参数")]),t._v(" "),e("th",[t._v("功能")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[t._v("--permanent")])]),t._v(" "),e("td",[e("strong",[t._v("永久设定")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--zone")])]),t._v(" "),e("td",[e("strong",[t._v("指定域")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--add-service")])]),t._v(" "),e("td",[e("strong",[t._v("添加服务")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--remove-service")])]),t._v(" "),e("td",[e("strong",[t._v("删除服务")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--add-source")])]),t._v(" "),e("td",[e("strong",[t._v("添加主机ip")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--remove-source")])]),t._v(" "),e("td",[e("strong",[t._v("删除主机ip")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--add-port")])]),t._v(" "),e("td",[e("strong",[t._v("添加端口")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--remove-port")])]),t._v(" "),e("td",[e("strong",[t._v("删除端口")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--add-interface")])]),t._v(" "),e("td",[e("strong",[t._v("添加网卡")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--change-interface")])]),t._v(" "),e("td",[e("strong",[t._v("改变网卡")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("--remove-interface")])]),t._v(" "),e("td",[e("strong",[t._v("删除网卡")])])])])]),t._v(" "),e("h2",{attrs:{id:"参数用法示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数用法示例"}},[t._v("#")]),t._v(" 参数用法示例")]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ firewall-cmd --permanent --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("trusted --add-source"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".0.1\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加外来主机ip到trusted域")]),t._v("\n$ firewall-cmd --permanent --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("trusted --remove-source"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".0.1\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#从trusted域中删除外来主机ip")]),t._v("\n$ firewall-cmd --permanent --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("trusted --add-interface"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eth0\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加网卡到指定的域")]),t._v("\n$ firewall-cmd --permanent --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("trusted --change-interface"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eth0\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#改变网卡所在的域")]),t._v("\n$ firewall-cmd --permanent --zone-trusted --remove-interface"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eth0\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#将网卡从指定域上面删除")]),t._v("\n$ firewall-cmd --permanent --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-service"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("smtp\t\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久添加服务")]),t._v("\n$ firewall-cmd --permanent --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --remove-service"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("smtp\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久移走服务")]),t._v("\n$ firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --list-ports\t\t\t\t\t\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#列出允许的端口")]),t._v("\n$ firewall-cmd --permanent --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("/tcp\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久添加端口")]),t._v("\n$ firewall-cmd --permanent --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --remove-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("/tcp\t\t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#永久删除端口")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])]),e("blockquote",[e("p",[t._v("注意：\n1.在设定火墙策略时，可以加"),e("code",[t._v("--permanent")]),t._v("参数永久设定；临时设定时则不加该参数\n2.永久设定后，火墙策略不会立即生效，需要进行重新加载，两种方式如下：")]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ firewall-cmd --reload \t\t\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#重新加载使其生效，但是不会断开已经连接的")]),t._v("\n$ firewall-cmd --complete-relode \t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#重新加载，并且断开所有的连接")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])])]),t._v(" "),e("h2",{attrs:{id:"设定火墙规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设定火墙规则"}},[t._v("#")]),t._v(" 设定火墙规则")]),t._v(" "),e("p",[t._v("指定主机访问指定端口")]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ firewall-cmd --direct --add-rule ipv4 filter INPUT "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" -s  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".254.1  -p  tcp --dport  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -j ACCEPT\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加只有主机172.25.254.1可以ssh访问本机")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("注释：\nfilter\t\t\t（规则表） \nINPUT\t\t\t（链） \n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\t\t\t\t（写在第一条） \n-s\t\t\t\t（源ip） "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".254.1  \n-p\t\t\t\t（协议类型） tcp \n--dport\t\t\t（目的端口） "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" \n-j\t\t\t\t（动作） ACCEPT\n\n动作：\naccept \t接受客户端的请求\nreject \t拒绝请求，但是给客户端有回应，客户端不再访问\ndrop \t丢弃，没有回应，客户端会一直发数据包，加大负载\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ firewall-cmd --direct --get-all-rules\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看规则")]),t._v("\n$ firewall-cmd --direct --remove-rule ipv4 filter INPUT "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" -s "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".254.1 -p tcp --dport "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -j ACCEPT"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除规则")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("blockquote",[e("p",[t._v("注意：除了指定主机外的主机访问指定端口：")]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ firewall-cmd --direct --add-rule ipv4 filter INPUT "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" -s "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.25")]),t._v(".254.1 -p tcp --dport "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -i ACCEPT\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#除了指定ip地址的主机不使用此策略，其他主机都使用此策略（指定的使用默认策略）")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);