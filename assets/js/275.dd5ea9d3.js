(window.webpackJsonp=window.webpackJsonp||[]).push([[275],{755:function(s,a,t){"use strict";t.r(a);var e=t(19),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"zabbix监控openstack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#zabbix监控openstack"}},[s._v("#")]),s._v(" Zabbix监控OpenStack")]),s._v(" "),t("h2",{attrs:{id:"环境准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境准备"}},[s._v("#")]),s._v(" 环境准备")]),s._v(" "),t("h3",{attrs:{id:"_1-节点规划"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-节点规划"}},[s._v("#")]),s._v(" 1. 节点规划")]),s._v(" "),t("p",[s._v("安装单节点Linux操作系统，节点规划见表1。")]),s._v(" "),t("p",[s._v("表1 节点规划")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[s._v("IP")])]),s._v(" "),t("th",[t("strong",[s._v("主机名")])]),s._v(" "),t("th",[t("strong",[s._v("节点")])])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("10.24.195.48")]),s._v(" "),t("td",[s._v("zabbix-server")]),s._v(" "),t("td",[s._v("监控节点")])]),s._v(" "),t("tr",[t("td",[s._v("10.24.200.80")]),s._v(" "),t("td",[s._v("openstack")]),s._v(" "),t("td",[s._v("云平台控制节点")])]),s._v(" "),t("tr",[t("td",[s._v("10.24.196.82")]),s._v(" "),t("td",[s._v("Web访问节点")]),s._v(" "),t("td",[s._v("Web访问节点")])])])]),s._v(" "),t("h3",{attrs:{id:"_2-基础环境配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-基础环境配置"}},[s._v("#")]),s._v(" 2. 基础环境配置")]),s._v(" "),t("p",[s._v("使用线上平台分配主机，分别为zabbix-server节点使用centos7.5操作系统，openstack节点为已搭建完成的单节点OpenStack Allinone主机，地址根据实际地址进行配置。")]),s._v(" "),t("h2",{attrs:{id:"模块内容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#模块内容"}},[s._v("#")]),s._v(" 模块内容")]),s._v(" "),t("h3",{attrs:{id:"_1-环境配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-环境配置"}},[s._v("#")]),s._v(" 1.环境配置")]),s._v(" "),t("p",[s._v("修改主机名")]),s._v(" "),t("p",[s._v("修改节点的主机名为zabbix-server，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hostnamectl set-hostname zabbix-server")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("配置本地Yum源")]),s._v(" "),t("p",[s._v("从文件服务器拉取软件包下载至/root目录并配置本地yum源，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl -O http://mirrors.douxuedu.com/newcloud/zabbix.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -zxvf zabbix.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nzabbix zabbix.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("将默认Yum源移至/media/目录，并创建本地Yum源文件，命令及文件内容如下。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv /etc/yum.repos.d/* /media/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat >> /etc/yum.repos.d/zabbix.repo << EOF")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zabbix"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zabbix\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("file:///root/zabbix\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nEOF\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum repolist")]),s._v("\nrepo "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("      repo name     status\nzabbix      zabbix          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h3",{attrs:{id:"_2-安装mariadb数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装mariadb数据库"}},[s._v("#")]),s._v(" 2.安装MariaDB数据库")]),s._v(" "),t("p",[s._v("安装MariaDB数据库，启动并设置开机自启，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install mariadb-server mariadb -y")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start mariadb")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable mariadb --now")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("初始化数据库，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql_secure_installation")]),s._v("\nEnter current password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" root "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("enter "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" none"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":  //按Enter键\nSet root password? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" y            //输入y并按Enter键\nNew password:       //设置root登录数据库密码（000000）并按Enter键\nRe-enter new password:       //重复密码（000000）并按Enter键\nPassword updated successfully"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nReloading privilege tables"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". Success"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nRemove anonymous users? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" y        //输入y并按Enter键\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". Success"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nDisallow root login remotely? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" n     //输入n并按Enter键\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". skipping.\nRemove "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" database and access to it? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" y //输入y并按Entre键\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". Success"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nReload privilege tables now? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" y       //输入y并按Enter键\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". Success"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nThanks "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" using MariaDB"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("创建zabbix数据库及用户zabbix，并赋予用户远程访问数据库权限，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# mysql -uroot -p000000 -e "create database zabbix character set utf8 collate utf8_bin;"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -p000000 -e \"create user zabbix@localhost identified by '000000';\"")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# mysql -uroot -p000000 -e "grant all privileges on zabbix.* to zabbix@localhost;"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"_3-zabbix服务安装及配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-zabbix服务安装及配置"}},[s._v("#")]),s._v(" 3.Zabbix服务安装及配置")]),s._v(" "),t("p",[s._v("安装Zabbix主服务和Agent服务，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install zabbix-server-mysql zabbix-agent -y")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("安装SCL组件并导入Zabbix初始数据，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install centos-release-scl zabbix-web-mysql-scl zabbix-apache-conf-scl -y")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zcat /usr/share/doc/zabbix-server-mysql*/create.sql.gz | mysql -uzabbix -p000000 zabbix")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("修改Zabbix Server主配置文件，设置数据库密码，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "DBPassword=000000" >> /etc/zabbix/zabbix_server.conf')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("修改Zabbix的前端页面配置文件，设置PHP时区，并启动服务，设置服务开机自启，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "php_value[date.timezone] = Asia/Shanghai" >> /etc/opt/rh/rh-php72/php-fpm.d/zabbix.conf')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable zabbix-server zabbix-agent httpd rh-php72-php-fpm --now")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("验证Zabbix是否启动成功，查询服务端口(10050以及10051)，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zabbix-server ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -ntlup |grep zabbix")]),s._v("\nTcp   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:10050   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:* LISTEN "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2038")]),s._v("/zabbix_agentd \nTcp   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:10051  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*  LISTEN "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2045")]),s._v("/zabbix_server \ntcp6   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    :::10050   :::*     LISTEN "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2038")]),s._v("/zabbix_agentd \ntcp6   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    :::10051      :::*      LISTEN "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2045")]),s._v("/zabbix_server\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_4-初始化zabbix"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-初始化zabbix"}},[s._v("#")]),s._v(" 4.初始化Zabbix")]),s._v(" "),t("p",[s._v("切换至web节点（图形化界面），打开浏览器访问http://10.24.195.48/zabbix，单击“Next step”按钮，如图1-1所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082336153.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图1-1 Zabbix初始化")]),s._v(" "),t("p",[s._v("检查Zabbix环境是否都为OK，然后单击"),t("code",[s._v("“Next step”")]),s._v("按钮，如图1-2所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082337391.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图2 Zabbix环境检查")]),s._v(" "),t("p",[s._v("设置连接地址（根据实际地址）及数据库连接密码为"),t("code",[s._v("000000")]),s._v("，单击"),t("code",[s._v("“Next step”")]),s._v("按钮，如图1-3所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082337463.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图1-3 配置数据库连接")]),s._v(" "),t("p",[s._v("设置Zabbix Server标题名字为“"),t("code",[s._v("云监控平台")]),s._v("”，单击"),t("code",[s._v("“Next step”")]),s._v("按钮，如图1-4所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082337102.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图1-4 设置标题名称")]),s._v(" "),t("p",[s._v("查看配置概况，单击"),t("code",[s._v("“Next step”")]),s._v("按钮，如图1-5所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082337527.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图1-5 查看配置概况")]),s._v(" "),t("p",[s._v("完成安装，单击"),t("code",[s._v("“Finish”")]),s._v("按钮，如图1-6所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082337679.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图1-6 完成初始化")]),s._v(" "),t("p",[s._v("登录Zabbix云监控平台，输入用户名和密码"),t("code",[s._v("（Admin/zabbix）")]),s._v("，单击"),t("code",[s._v("“Sign in”")]),s._v("按钮进行登录，如图1-7所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082337134.png",alt:"img"}})]),s._v(" "),t("p",[s._v("图1-7 登录")]),s._v(" "),t("p",[s._v("登陆后单击左下角"),t("code",[s._v("“User settings”")]),s._v("，设置中文语言，Language设置为"),t("code",[s._v("“Chinese(zh_CN)”")]),s._v("，单击"),t("code",[s._v("“update”")]),s._v("按钮更新设置，如图1-8所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082337190.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图1-8 设置中文语言")]),s._v(" "),t("p",[s._v("至此，Zabbix服务安装完毕，下面可以将需要监控的主机添加到Zabbix的监控列表，进行实时监控。")]),s._v(" "),t("h3",{attrs:{id:"_5-zabbix-agent配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-zabbix-agent配置"}},[s._v("#")]),s._v(" 5.Zabbix Agent配置")]),s._v(" "),t("p",[s._v("被监控主机agent节点需安装Zabbix Agent服务，将数据采集提供给server节点。下面将在云管理平台openstack节点安装Zabbix Agent服务。")]),s._v(" "),t("p",[s._v("1.Zabbix Agent服务的安装与配置")]),s._v(" "),t("p",[s._v("安装zabbix-agent服务，并修改配置文件，启动Agent服务，命令及文件内容如下。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@openstack ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install zabbix-agent -y")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@openstack ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/zabbix/zabbix_agentd.conf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Server")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.24")]),s._v(".195.48             //修改为server节点IP\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ServerActive")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.24")]),s._v(".195"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v("     //修改为server节点IP\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Hostname")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("openstack           //主机名即可\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@openstack ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable zabbix-agent.service --now")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("查询Agent服务端口（10050）是否启动成功，命令如下：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@openstack ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -ntlup |grep zabbix")]),s._v("\ntcp   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:10050  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:* LISTEN "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24217")]),s._v("/zabbix_agentd \ntcp6   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::10050         :::*       LISTEN "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24217")]),s._v("/zabbix_agentd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("2.server节点添加监控主机")]),s._v(" "),t("p",[s._v("切换至Web节点，打开Zabbix Server的Web页面，选择左侧导航栏"),t("code",[s._v("“配置→主机群组”")]),s._v("菜单命令，单击右上角"),t("code",[s._v("“创建主机群组”")]),s._v("按钮，定义主机群组名称为"),t("code",[s._v("“云计算集群主机”")]),s._v("，单击"),t("code",[s._v("“添加”")]),s._v("按钮，如图2-1所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082341766.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图2-1 定义主机群组名称")]),s._v(" "),t("p",[s._v("创建主机。选择左侧导航栏“配置→主机”菜单命令，单击右上角“创建主机”按钮，设置主机名称为"),t("code",[s._v("“openstack”")]),s._v("，选择群组“云计算集群主机”，客户端IP地址为openstack节点地址"),t("code",[s._v("（10.24.200.80）")]),s._v("，注意不需要单击"),t("code",[s._v("“添加”")]),s._v("按钮，如图2-2所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082341682.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图2-2 定义主机信息")]),s._v(" "),t("p",[s._v("选择模板。定义模板选择"),t("code",[s._v("“Templates/Operating systems→Template OS Linux by Zabbix agent”")]),s._v("，单击“添加”按钮，如图2-3所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082341095.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图2-3 定义模板信息")]),s._v(" "),t("p",[s._v("查看主机。选择左侧导航栏"),t("code",[s._v("“监测→主机”")]),s._v("菜单命令，单击名称"),t("code",[s._v("“openstack”")]),s._v("，选择“图形”菜单命令，如图2-4所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082341981.jpeg",alt:"img"}})]),s._v(" "),t("p",[s._v("图2-4 查看主机")]),s._v(" "),t("p",[s._v("在跳转页面可以查看资源使用情况，如图2-5所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/isicman/image/main/img/202205082342185.jpg",alt:"img"}})]),s._v(" "),t("p",[s._v("图2-5 查看监控状态")]),s._v(" "),t("p",[s._v("至此，添加被监控主机操作完成，如果监控的是多台主机，只需按照上述方法，在被监控主机上安装Agent服务并做配置即可。")])])}),[],!1,null,null,null);a.default=n.exports}}]);